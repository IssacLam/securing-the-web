.TH "s2n/libcrypto-build/openssl/ssl/t1_lib.c" 3 "Thu Jun 30 2016" "s2n-openssl-doxygen" \" -*- nroff -*-
.ad l
.nh
.SH NAME
s2n/libcrypto-build/openssl/ssl/t1_lib.c \- 
.SH SYNOPSIS
.br
.PP
\fC#include <stdio\&.h>\fP
.br
\fC#include <openssl/objects\&.h>\fP
.br
\fC#include <openssl/evp\&.h>\fP
.br
\fC#include <openssl/hmac\&.h>\fP
.br
\fC#include <openssl/ocsp\&.h>\fP
.br
\fC#include <openssl/rand\&.h>\fP
.br
\fC#include 'ssl_locl\&.h'\fP
.br

.SS "Data Structures"

.in +1c
.ti -1c
.RI "struct \fBnid_cb_st\fP"
.br
.ti -1c
.RI "struct \fBtls12_lookup\fP"
.br
.ti -1c
.RI "struct \fBsig_cb_st\fP"
.br
.in -1c
.SS "Macros"

.in +1c
.ti -1c
.RI "#define \fBMAX_CURVELIST\fP   28"
.br
.ti -1c
.RI "#define \fBtlsext_sigalg_rsa\fP(md)   md, \fBTLSEXT_signature_rsa\fP,"
.br
.ti -1c
.RI "#define \fBtlsext_sigalg_dsa\fP(md)   md, \fBTLSEXT_signature_dsa\fP,"
.br
.ti -1c
.RI "#define \fBtlsext_sigalg_ecdsa\fP(md)   md, \fBTLSEXT_signature_ecdsa\fP,"
.br
.ti -1c
.RI "#define \fBtlsext_sigalg\fP(md)"
.br
.ti -1c
.RI "#define \fBMAX_SIGALGLEN\fP   (\fBTLSEXT_hash_num\fP * \fBTLSEXT_signature_num\fP * 2)"
.br
.ti -1c
.RI "#define \fBCERT_PKEY_VALID_FLAGS\fP   (\fBCERT_PKEY_EE_SIGNATURE\fP|\fBCERT_PKEY_EE_PARAM\fP)"
.br
.ti -1c
.RI "#define \fBCERT_PKEY_STRICT_FLAGS\fP"
.br
.in -1c
.SS "Functions"

.in +1c
.ti -1c
.RI "int \fBssl_check_serverhello_tlsext\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "long \fBtls1_default_timeout\fP (\fBvoid\fP)"
.br
.ti -1c
.RI "int \fBtls1_new\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "\fBvoid\fP \fBtls1_free\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "\fBvoid\fP \fBtls1_clear\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "int \fBtls1_ec_curve_id2nid\fP (int curve_id)"
.br
.ti -1c
.RI "int \fBtls1_ec_nid2curve_id\fP (int \fBnid\fP)"
.br
.ti -1c
.RI "int \fBtls1_check_curve\fP (\fBSSL\fP *s, const unsigned char *\fBp\fP, size_t \fBlen\fP)"
.br
.ti -1c
.RI "int \fBtls1_shared_curve\fP (\fBSSL\fP *s, int nmatch)"
.br
.ti -1c
.RI "int \fBtls1_set_curves\fP (unsigned char **pext, size_t *pextlen, int *curves, size_t ncurves)"
.br
.ti -1c
.RI "int \fBtls1_set_curves_list\fP (unsigned char **pext, size_t *pextlen, const char *str)"
.br
.ti -1c
.RI "int \fBtls1_check_ec_tmp_key\fP (\fBSSL\fP *s, unsigned long cid)"
.br
.ti -1c
.RI "size_t \fBtls12_get_psigalgs\fP (\fBSSL\fP *s, const unsigned char **psigs)"
.br
.ti -1c
.RI "int \fBtls12_check_peer_sigalg\fP (const \fBEVP_MD\fP **pmd, \fBSSL\fP *s, const unsigned char *sig, \fBEVP_PKEY\fP *pkey)"
.br
.ti -1c
.RI "\fBvoid\fP \fBssl_set_client_disabled\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "unsigned char * \fBssl_add_clienthello_tlsext\fP (\fBSSL\fP *s, unsigned char *buf, unsigned char *limit, int *al)"
.br
.ti -1c
.RI "unsigned char * \fBssl_add_serverhello_tlsext\fP (\fBSSL\fP *s, unsigned char *buf, unsigned char *limit, int *al)"
.br
.ti -1c
.RI "int \fBssl_parse_clienthello_tlsext\fP (\fBSSL\fP *s, unsigned char **\fBp\fP, unsigned char *limit)"
.br
.ti -1c
.RI "int \fBssl_prepare_clienthello_tlsext\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "int \fBssl_prepare_serverhello_tlsext\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "int \fBtls1_set_server_sigalgs\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "int \fBssl_check_clienthello_tlsext_late\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "int \fBssl_parse_serverhello_tlsext\fP (\fBSSL\fP *s, unsigned char **\fBp\fP, unsigned char *d, int n)"
.br
.ti -1c
.RI "int \fBtls1_process_ticket\fP (\fBSSL\fP *s, unsigned char *session_id, int \fBlen\fP, const unsigned char *limit, \fBSSL_SESSION\fP **ret)"
.br
.ti -1c
.RI "int \fBtls12_get_sigandhash\fP (unsigned char *\fBp\fP, const \fBEVP_PKEY\fP *pk, const \fBEVP_MD\fP *md)"
.br
.ti -1c
.RI "int \fBtls12_get_sigid\fP (const \fBEVP_PKEY\fP *pk)"
.br
.ti -1c
.RI "const \fBEVP_MD\fP * \fBtls12_get_hash\fP (unsigned char hash_alg)"
.br
.ti -1c
.RI "int \fBtls1_save_sigalgs\fP (\fBSSL\fP *s, const unsigned char *\fBdata\fP, int dsize)"
.br
.ti -1c
.RI "int \fBtls1_process_sigalgs\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "int \fBSSL_get_sigalgs\fP (\fBSSL\fP *s, int idx, int *psign, int *phash, int *psignhash, unsigned char *rsig, unsigned char *rhash)"
.br
.ti -1c
.RI "int \fBSSL_get_shared_sigalgs\fP (\fBSSL\fP *s, int idx, int *psign, int *phash, int *psignhash, unsigned char *rsig, unsigned char *rhash)"
.br
.ti -1c
.RI "int \fBtls1_process_heartbeat\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "int \fBtls1_heartbeat\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "int \fBtls1_set_sigalgs_list\fP (\fBCERT\fP *\fBc\fP, const char *str, int client)"
.br
.ti -1c
.RI "int \fBtls1_set_sigalgs\fP (\fBCERT\fP *\fBc\fP, const int *psig_nids, size_t salglen, int client)"
.br
.ti -1c
.RI "int \fBtls1_check_chain\fP (\fBSSL\fP *s, \fBX509\fP *\fBx\fP, \fBEVP_PKEY\fP *pk, \fBSTACK_OF\fP(\fBX509\fP)*chain, int idx)"
.br
.ti -1c
.RI "\fBvoid\fP \fBtls1_set_cert_validity\fP (\fBSSL\fP *s)"
.br
.ti -1c
.RI "int \fBSSL_check_chain\fP (\fBSSL\fP *s, \fBX509\fP *\fBx\fP, \fBEVP_PKEY\fP *pk, \fBSTACK_OF\fP(\fBX509\fP)*chain)"
.br
.in -1c
.SS "Variables"

.in +1c
.ti -1c
.RI "const char \fBtls1_version_str\fP [] = 'TLSv1' OPENSSL_VERSION_PTEXT"
.br
.ti -1c
.RI "\fBSSL3_ENC_METHOD\fP \fBTLSv1_enc_data\fP"
.br
.ti -1c
.RI "\fBSSL3_ENC_METHOD\fP \fBTLSv1_1_enc_data\fP"
.br
.ti -1c
.RI "\fBSSL3_ENC_METHOD\fP \fBTLSv1_2_enc_data\fP"
.br
.in -1c
.SH "Macro Definition Documentation"
.PP 
.SS "#define CERT_PKEY_STRICT_FLAGS"
\fBValue:\fP
.PP
.nf
(CERT_PKEY_VALID_FLAGS|CERT_PKEY_CA_SIGNATURE|CERT_PKEY_CA_PARAM \
         | CERT_PKEY_ISSUER_NAME|CERT_PKEY_CERT_TYPE)
.fi
.PP
Definition at line 4173 of file t1_lib\&.c\&.
.SS "#define CERT_PKEY_VALID_FLAGS   (\fBCERT_PKEY_EE_SIGNATURE\fP|\fBCERT_PKEY_EE_PARAM\fP)"

.PP
Definition at line 4170 of file t1_lib\&.c\&.
.SS "#define MAX_CURVELIST   28"

.PP
Definition at line 683 of file t1_lib\&.c\&.
.SS "#define MAX_SIGALGLEN   (\fBTLSEXT_hash_num\fP * \fBTLSEXT_signature_num\fP * 2)"

.PP
Definition at line 4023 of file t1_lib\&.c\&.
.SS "#define tlsext_sigalg(md)"
\fBValue:\fP
.PP
.nf
tlsext_sigalg_rsa(md) \
                tlsext_sigalg_dsa(md) \
                tlsext_sigalg_ecdsa(md)
.fi
.PP
Definition at line 1010 of file t1_lib\&.c\&.
.SS "#define tlsext_sigalg_dsa(md)   md, \fBTLSEXT_signature_dsa\fP,"

.PP
Definition at line 1000 of file t1_lib\&.c\&.
.SS "#define tlsext_sigalg_ecdsa(md)   md, \fBTLSEXT_signature_ecdsa\fP,"

.PP
Definition at line 1007 of file t1_lib\&.c\&.
.SS "#define tlsext_sigalg_rsa(md)   md, \fBTLSEXT_signature_rsa\fP,"

.PP
Definition at line 994 of file t1_lib\&.c\&.
.SH "Function Documentation"
.PP 
.SS "unsigned char* ssl_add_clienthello_tlsext (\fBSSL\fP * s, unsigned char * buf, unsigned char * limit, int * al)"

.PP
Definition at line 1227 of file t1_lib\&.c\&.
.SS "unsigned char* ssl_add_serverhello_tlsext (\fBSSL\fP * s, unsigned char * buf, unsigned char * limit, int * al)"

.PP
Definition at line 1604 of file t1_lib\&.c\&.
.SS "int SSL_check_chain (\fBSSL\fP * s, \fBX509\fP * x, \fBEVP_PKEY\fP * pk, \fBSTACK_OF\fP(\fBX509\fP)* chain)"

.PP
Definition at line 4438 of file t1_lib\&.c\&.
.SS "int ssl_check_clienthello_tlsext_late (\fBSSL\fP * s)"

.PP
Definition at line 3052 of file t1_lib\&.c\&.
.SS "int ssl_check_serverhello_tlsext (\fBSSL\fP * s)"

.PP
Definition at line 3118 of file t1_lib\&.c\&.
.SS "int SSL_get_shared_sigalgs (\fBSSL\fP * s, int idx, int * psign, int * phash, int * psignhash, unsigned char * rsig, unsigned char * rhash)"

.PP
Definition at line 3847 of file t1_lib\&.c\&.
.SS "int SSL_get_sigalgs (\fBSSL\fP * s, int idx, int * psign, int * phash, int * psignhash, unsigned char * rsig, unsigned char * rhash)"

.PP
Definition at line 3826 of file t1_lib\&.c\&.
.SS "int ssl_parse_clienthello_tlsext (\fBSSL\fP * s, unsigned char ** p, unsigned char * limit)"

.PP
Definition at line 2497 of file t1_lib\&.c\&.
.SS "int ssl_parse_serverhello_tlsext (\fBSSL\fP * s, unsigned char ** p, unsigned char * d, int n)"

.PP
Definition at line 3235 of file t1_lib\&.c\&.
.SS "int ssl_prepare_clienthello_tlsext (\fBSSL\fP * s)"

.PP
Definition at line 2847 of file t1_lib\&.c\&.
.SS "int ssl_prepare_serverhello_tlsext (\fBSSL\fP * s)"

.PP
Definition at line 2899 of file t1_lib\&.c\&.
.SS "\fBvoid\fP ssl_set_client_disabled (\fBSSL\fP * s)"

.PP
Definition at line 1152 of file t1_lib\&.c\&.
.SS "int tls12_check_peer_sigalg (const \fBEVP_MD\fP ** pmd, \fBSSL\fP * s, const unsigned char * sig, \fBEVP_PKEY\fP * pkey)"

.PP
Definition at line 1073 of file t1_lib\&.c\&.
.SS "const \fBEVP_MD\fP* tls12_get_hash (unsigned char hash_alg)"

.PP
Definition at line 3566 of file t1_lib\&.c\&.
.SS "size_t tls12_get_psigalgs (\fBSSL\fP * s, const unsigned char ** psigs)"

.PP
Definition at line 1035 of file t1_lib\&.c\&.
.SS "int tls12_get_sigandhash (unsigned char * p, const \fBEVP_PKEY\fP * pk, const \fBEVP_MD\fP * md)"

.PP
Definition at line 3542 of file t1_lib\&.c\&.
.SS "int tls12_get_sigid (const \fBEVP_PKEY\fP * pk)"

.PP
Definition at line 3560 of file t1_lib\&.c\&.
.SS "int tls1_check_chain (\fBSSL\fP * s, \fBX509\fP * x, \fBEVP_PKEY\fP * pk, \fBSTACK_OF\fP(\fBX509\fP)* chain, int idx)"

.PP
Definition at line 4177 of file t1_lib\&.c\&.
.SS "int tls1_check_curve (\fBSSL\fP * s, const unsigned char * p, size_t len)"

.PP
Definition at line 522 of file t1_lib\&.c\&.
.SS "int tls1_check_ec_tmp_key (\fBSSL\fP * s, unsigned long cid)"

.PP
Definition at line 910 of file t1_lib\&.c\&.
.SS "\fBvoid\fP tls1_clear (\fBSSL\fP * s)"

.PP
Definition at line 220 of file t1_lib\&.c\&.
.SS "long tls1_default_timeout (\fBvoid\fP)"

.PP
Definition at line 193 of file t1_lib\&.c\&.
.SS "int tls1_ec_curve_id2nid (int curve_id)"

.PP
Definition at line 377 of file t1_lib\&.c\&.
.SS "int tls1_ec_nid2curve_id (int nid)"

.PP
Definition at line 386 of file t1_lib\&.c\&.
.SS "\fBvoid\fP tls1_free (\fBSSL\fP * s)"

.PP
Definition at line 210 of file t1_lib\&.c\&.
.SS "int tls1_heartbeat (\fBSSL\fP * s)"

.PP
Definition at line 3944 of file t1_lib\&.c\&.
.SS "int tls1_new (\fBSSL\fP * s)"

.PP
Definition at line 202 of file t1_lib\&.c\&.
.SS "int tls1_process_heartbeat (\fBSSL\fP * s)"

.PP
Definition at line 3869 of file t1_lib\&.c\&.
.SS "int tls1_process_sigalgs (\fBSSL\fP * s)"

.PP
Definition at line 3749 of file t1_lib\&.c\&.
.SS "int tls1_process_ticket (\fBSSL\fP * s, unsigned char * session_id, int len, const unsigned char * limit, \fBSSL_SESSION\fP ** ret)"

.PP
Definition at line 3287 of file t1_lib\&.c\&.
.SS "int tls1_save_sigalgs (\fBSSL\fP * s, const unsigned char * data, int dsize)"

.PP
Definition at line 3729 of file t1_lib\&.c\&.
.SS "\fBvoid\fP tls1_set_cert_validity (\fBSSL\fP * s)"

.PP
Definition at line 4427 of file t1_lib\&.c\&.
.SS "int tls1_set_curves (unsigned char ** pext, size_t * pextlen, int * curves, size_t ncurves)"

.PP
Definition at line 629 of file t1_lib\&.c\&.
.SS "int tls1_set_curves_list (unsigned char ** pext, size_t * pextlen, const char * str)"

.PP
Definition at line 719 of file t1_lib\&.c\&.
.SS "int tls1_set_server_sigalgs (\fBSSL\fP * s)"

.PP
Definition at line 3014 of file t1_lib\&.c\&.
.SS "int tls1_set_sigalgs (\fBCERT\fP * c, const int * psig_nids, size_t salglen, int client)"

.PP
Definition at line 4091 of file t1_lib\&.c\&.
.SS "int tls1_set_sigalgs_list (\fBCERT\fP * c, const char * str, int client)"

.PP
Definition at line 4080 of file t1_lib\&.c\&.
.SS "int tls1_shared_curve (\fBSSL\fP * s, int nmatch)"

.PP
Definition at line 558 of file t1_lib\&.c\&.
.SH "Variable Documentation"
.PP 
.SS "const char tls1_version_str[] = 'TLSv1' OPENSSL_VERSION_PTEXT"

.PP
Definition at line 125 of file t1_lib\&.c\&.
.SS "\fBSSL3_ENC_METHOD\fP TLSv1_1_enc_data"
\fBInitial value:\fP
.PP
.nf
= {
    tls1_enc,
    tls1_mac,
    tls1_setup_key_block,
    tls1_generate_master_secret,
    tls1_change_cipher_state,
    tls1_final_finish_mac,
    TLS1_FINISH_MAC_LENGTH,
    tls1_cert_verify_mac,
    TLS_MD_CLIENT_FINISH_CONST, TLS_MD_CLIENT_FINISH_CONST_SIZE,
    TLS_MD_SERVER_FINISH_CONST, TLS_MD_SERVER_FINISH_CONST_SIZE,
    tls1_alert_code,
    tls1_export_keying_material,
    SSL_ENC_FLAG_EXPLICIT_IV,
    SSL3_HM_HEADER_LENGTH,
    ssl3_set_handshake_header,
    ssl3_handshake_write
}
.fi
.PP
Definition at line 154 of file t1_lib\&.c\&.
.SS "\fBSSL3_ENC_METHOD\fP TLSv1_2_enc_data"
\fBInitial value:\fP
.PP
.nf
= {
    tls1_enc,
    tls1_mac,
    tls1_setup_key_block,
    tls1_generate_master_secret,
    tls1_change_cipher_state,
    tls1_final_finish_mac,
    TLS1_FINISH_MAC_LENGTH,
    tls1_cert_verify_mac,
    TLS_MD_CLIENT_FINISH_CONST, TLS_MD_CLIENT_FINISH_CONST_SIZE,
    TLS_MD_SERVER_FINISH_CONST, TLS_MD_SERVER_FINISH_CONST_SIZE,
    tls1_alert_code,
    tls1_export_keying_material,
    SSL_ENC_FLAG_EXPLICIT_IV | SSL_ENC_FLAG_SIGALGS | SSL_ENC_FLAG_SHA256_PRF
        | SSL_ENC_FLAG_TLS1_2_CIPHERS,
    SSL3_HM_HEADER_LENGTH,
    ssl3_set_handshake_header,
    ssl3_handshake_write
}
.fi
.PP
Definition at line 173 of file t1_lib\&.c\&.
.SS "\fBSSL3_ENC_METHOD\fP TLSv1_enc_data"
\fBInitial value:\fP
.PP
.nf
= {
    tls1_enc,
    tls1_mac,
    tls1_setup_key_block,
    tls1_generate_master_secret,
    tls1_change_cipher_state,
    tls1_final_finish_mac,
    TLS1_FINISH_MAC_LENGTH,
    tls1_cert_verify_mac,
    TLS_MD_CLIENT_FINISH_CONST, TLS_MD_CLIENT_FINISH_CONST_SIZE,
    TLS_MD_SERVER_FINISH_CONST, TLS_MD_SERVER_FINISH_CONST_SIZE,
    tls1_alert_code,
    tls1_export_keying_material,
    0,
    SSL3_HM_HEADER_LENGTH,
    ssl3_set_handshake_header,
    ssl3_handshake_write
}
.fi
.PP
Definition at line 135 of file t1_lib\&.c\&.
.SH "Author"
.PP 
Generated automatically by Doxygen for s2n-openssl-doxygen from the source code\&.
