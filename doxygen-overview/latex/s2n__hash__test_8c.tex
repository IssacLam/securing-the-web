\hypertarget{s2n__hash__test_8c}{}\section{s2n-\/master/tests/unit/s2n\+\_\+hash\+\_\+test.c File Reference}
\label{s2n__hash__test_8c}\index{s2n-\/master/tests/unit/s2n\+\_\+hash\+\_\+test.\+c@{s2n-\/master/tests/unit/s2n\+\_\+hash\+\_\+test.\+c}}
{\ttfamily \#include \char`\"{}s2n\+\_\+test.\+h\char`\"{}}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include \char`\"{}testlib/s2n\+\_\+testlib.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stuffer/s2n\+\_\+stuffer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}crypto/s2n\+\_\+hash.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+blob.\+h\char`\"{}}\\*
Include dependency graph for s2n\+\_\+hash\+\_\+test.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__hash__test_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{s2n__hash__test_8c_a3c04138a5bfe5d72780bb7e82a18e627}{main} (int argc, char $\ast$$\ast$argv)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{s2n\+\_\+hash\+\_\+test.\+c@{s2n\+\_\+hash\+\_\+test.\+c}!main@{main}}
\index{main@{main}!s2n\+\_\+hash\+\_\+test.\+c@{s2n\+\_\+hash\+\_\+test.\+c}}
\subsubsection[{\texorpdfstring{main(int argc, char $\ast$$\ast$argv)}{main(int argc, char **argv)}}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$$\ast$}]{argv}
\end{DoxyParamCaption}
)}\hypertarget{s2n__hash__test_8c_a3c04138a5bfe5d72780bb7e82a18e627}{}\label{s2n__hash__test_8c_a3c04138a5bfe5d72780bb7e82a18e627}


Definition at line 25 of file s2n\+\_\+hash\+\_\+test.\+c.


\begin{DoxyCode}
26 \{
27     uint8\_t digest\_pad[64];
28     uint8\_t output\_pad[96];
29     uint8\_t hello[] = \textcolor{stringliteral}{"Hello world!\(\backslash\)n"};
30     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} output;
31     \textcolor{keyword}{struct }\hyperlink{structs2n__hash__state}{s2n\_hash\_state} \hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, copy;
32     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} out = \{.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = output\_pad,.size = \textcolor{keyword}{sizeof}(output\_pad) \};
33 
34     \hyperlink{s2n__test_8h_abef58b8851265310b43e5b6d8c1d2ff5}{BEGIN\_TEST}();
35 
36     \textcolor{comment}{/* Initialise our output stuffers */}
37     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__stuffer_8c_af556836db8ed75fdb89af3d418fab2ee}{s2n\_stuffer\_init}(&output, &out));
38 
39     \hyperlink{s2n__test_8h_aea4dfdd3a9d6afc7bbb40248a8437774}{EXPECT\_EQUAL}(\hyperlink{s2n__hash_8c_aced4a438c67e79b78d41edfbb8b3e07a}{s2n\_hash\_digest\_size}(
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5ade536a917150a394c402086ce5ceb853}{S2N\_HASH\_MD5}), 16);
40     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_a684a3779eebad8329d41443454dd6fa2}{s2n\_hash\_init}(&\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, 
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5ade536a917150a394c402086ce5ceb853}{S2N\_HASH\_MD5}));
41     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_a0f3c4efbf552f607071e552dc0548ee6}{s2n\_hash\_update}(&\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, hello, strlen((\textcolor{keywordtype}{char} *)hello)));
42     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_a8b39db9e0a5456a10a5d790474f09818}{s2n\_hash\_copy}(&copy, &\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}));
43     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_ac0a5e6f9f981a0e473bfb9dba9c3d7c9}{s2n\_hash\_digest}(&\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, digest\_pad, 
      \hyperlink{crypto_2md5_2md5_8h_a09a4f4b2f28cbe522d9b80153666029c}{MD5\_DIGEST\_LENGTH}));
44 
45     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 16; i++) \{
46         \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__stuffer__hex_8c_afa09f772b334ba411a27ba2d52747b7d}{s2n\_stuffer\_write\_uint8\_hex}(&output, 
      digest\_pad[i]));
47     \}
48 
49     \textcolor{comment}{/* Reference value from command line md5sum */}
50     \hyperlink{s2n__test_8h_aea4dfdd3a9d6afc7bbb40248a8437774}{EXPECT\_EQUAL}(memcmp(output\_pad, \textcolor{stringliteral}{"59ca0efa9f5633cb0371bbc0355478d8"}, 16 * 2), 0);
51 
52     \textcolor{comment}{/* Check the copy */}
53     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_ac0a5e6f9f981a0e473bfb9dba9c3d7c9}{s2n\_hash\_digest}(&copy, digest\_pad, 
      \hyperlink{crypto_2md5_2md5_8h_a09a4f4b2f28cbe522d9b80153666029c}{MD5\_DIGEST\_LENGTH}));
54 
55     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 16; i++) \{
56         \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__stuffer__hex_8c_afa09f772b334ba411a27ba2d52747b7d}{s2n\_stuffer\_write\_uint8\_hex}(&output, 
      digest\_pad[i]));
57     \}
58 
59     \textcolor{comment}{/* Reference value from command line md5sum */}
60     \hyperlink{s2n__test_8h_aea4dfdd3a9d6afc7bbb40248a8437774}{EXPECT\_EQUAL}(memcmp(output\_pad, \textcolor{stringliteral}{"59ca0efa9f5633cb0371bbc0355478d8"}, 16 * 2), 0);
61 
62     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__stuffer_8c_af556836db8ed75fdb89af3d418fab2ee}{s2n\_stuffer\_init}(&output, &out));
63     \hyperlink{s2n__test_8h_aea4dfdd3a9d6afc7bbb40248a8437774}{EXPECT\_EQUAL}(\hyperlink{s2n__hash_8c_aced4a438c67e79b78d41edfbb8b3e07a}{s2n\_hash\_digest\_size}(
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627}{S2N\_HASH\_SHA1}), 20);
64     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_a684a3779eebad8329d41443454dd6fa2}{s2n\_hash\_init}(&\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, 
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627}{S2N\_HASH\_SHA1}));
65     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_a0f3c4efbf552f607071e552dc0548ee6}{s2n\_hash\_update}(&\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, hello, strlen((\textcolor{keywordtype}{char} *)hello)));
66     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_ac0a5e6f9f981a0e473bfb9dba9c3d7c9}{s2n\_hash\_digest}(&\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, digest\_pad, 
      \hyperlink{crypto_2sha_2sha_8h_a1a715db7b4403fe6c165e49a32f5fe3d}{SHA\_DIGEST\_LENGTH}));
67 
68     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 20; i++) \{
69         \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__stuffer__hex_8c_afa09f772b334ba411a27ba2d52747b7d}{s2n\_stuffer\_write\_uint8\_hex}(&output, 
      digest\_pad[i]));
70     \}
71 
72     \textcolor{comment}{/* Reference value from command line sha1sum */}
73     \hyperlink{s2n__test_8h_aea4dfdd3a9d6afc7bbb40248a8437774}{EXPECT\_EQUAL}(memcmp(output\_pad, \textcolor{stringliteral}{"47a013e660d408619d894b20806b1d5086aab03b"}, 20 * 2), 0);
74 
75     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__stuffer_8c_af556836db8ed75fdb89af3d418fab2ee}{s2n\_stuffer\_init}(&output, &out));
76     \hyperlink{s2n__test_8h_aea4dfdd3a9d6afc7bbb40248a8437774}{EXPECT\_EQUAL}(\hyperlink{s2n__hash_8c_aced4a438c67e79b78d41edfbb8b3e07a}{s2n\_hash\_digest\_size}(
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5a80895804a25873b25a474b3440ba55c9}{S2N\_HASH\_SHA256}), 32);
77     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_a684a3779eebad8329d41443454dd6fa2}{s2n\_hash\_init}(&\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, 
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5a80895804a25873b25a474b3440ba55c9}{S2N\_HASH\_SHA256}));
78     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_a0f3c4efbf552f607071e552dc0548ee6}{s2n\_hash\_update}(&\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, hello, strlen((\textcolor{keywordtype}{char} *)hello)));
79     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_ac0a5e6f9f981a0e473bfb9dba9c3d7c9}{s2n\_hash\_digest}(&\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, digest\_pad, 
      \hyperlink{crypto_2sha_2sha_8h_aa9cf0abf87b30c4c63e9c7e89c590579}{SHA256\_DIGEST\_LENGTH}));
80 
81     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 32; i++) \{
82         \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__stuffer__hex_8c_afa09f772b334ba411a27ba2d52747b7d}{s2n\_stuffer\_write\_uint8\_hex}(&output, 
      digest\_pad[i]));
83     \}
84 
85     \textcolor{comment}{/* Reference value from command line sha256sum */}
86     \hyperlink{s2n__test_8h_aea4dfdd3a9d6afc7bbb40248a8437774}{EXPECT\_EQUAL}(memcmp(output\_pad, \textcolor{stringliteral}{"
      0ba904eae8773b70c75333db4de2f3ac45a8ad4ddba1b242f0b3cfc199391dd8"}, 32 * 2), 0);
87 
88     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__stuffer_8c_af556836db8ed75fdb89af3d418fab2ee}{s2n\_stuffer\_init}(&output, &out));
89     \hyperlink{s2n__test_8h_aea4dfdd3a9d6afc7bbb40248a8437774}{EXPECT\_EQUAL}(\hyperlink{s2n__hash_8c_aced4a438c67e79b78d41edfbb8b3e07a}{s2n\_hash\_digest\_size}(
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5a89bbfcefd1e166b1e852d6ba96a9878d}{S2N\_HASH\_SHA384}), 48);
90     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_a684a3779eebad8329d41443454dd6fa2}{s2n\_hash\_init}(&\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, 
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5a89bbfcefd1e166b1e852d6ba96a9878d}{S2N\_HASH\_SHA384}));
91     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_a0f3c4efbf552f607071e552dc0548ee6}{s2n\_hash\_update}(&\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, hello, strlen((\textcolor{keywordtype}{char} *)hello)));
92     \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hash_8c_ac0a5e6f9f981a0e473bfb9dba9c3d7c9}{s2n\_hash\_digest}(&\hyperlink{hw__4758__cca_8h_a67c4cb9b5b64373de2156e95fc6f68a2}{hash}, digest\_pad, 
      \hyperlink{crypto_2sha_2sha_8h_a5f90d25a54e963a3ae3d800fffddaa31}{SHA384\_DIGEST\_LENGTH}));
93 
94     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 48; i++) \{
95         \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__stuffer__hex_8c_afa09f772b334ba411a27ba2d52747b7d}{s2n\_stuffer\_write\_uint8\_hex}(&output, 
      digest\_pad[i]));
96     \}
97 
98     \textcolor{comment}{/* Reference value from command line sha512sum */}
99     \hyperlink{s2n__test_8h_aea4dfdd3a9d6afc7bbb40248a8437774}{EXPECT\_EQUAL}(memcmp(output\_pad, \textcolor{stringliteral}{"
      f7f8f1b9d5a9a61742eeda26c20990282ac08dabda14e70376fcb4c8b46198a9959ea9d7d194b38520eed5397ffe6d8e"}, 48 * 2), 0);
100 
101     \hyperlink{s2n__test_8h_a45a83f30c32ca6265c28a1bef6dbe046}{END\_TEST}();
102 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{s2n__hash__test_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph}
\end{center}
\end{figure}


