\hypertarget{s2n__tls_8h}{}\section{s2n-\/master/tls/s2n\+\_\+tls.h File Reference}
\label{s2n__tls_8h}\index{s2n-\/master/tls/s2n\+\_\+tls.\+h@{s2n-\/master/tls/s2n\+\_\+tls.\+h}}
{\ttfamily \#include $<$stdint.\+h$>$}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+connection.\+h\char`\"{}}\\*
Include dependency graph for s2n\+\_\+tls.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{s2n__tls_8h_a20bacac680b48d51f2623a1d95e85ca8}{s2n\+\_\+server\+\_\+can\+\_\+send\+\_\+ocsp}(conn)
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5}{s2n\+\_\+flush} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn, \hyperlink{s2n_8h_af70ca0b089daa98cd79a424d3f6af15d}{s2n\+\_\+blocked\+\_\+status} $\ast$more)
\item 
int \hyperlink{s2n__tls_8h_a4b86117a2a4f018991a01ff788272441}{s2n\+\_\+client\+\_\+hello\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_abfb7d01ea645110aea3c808de4d86f1d}{s2n\+\_\+client\+\_\+hello\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1}{s2n\+\_\+sslv2\+\_\+client\+\_\+hello\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a8e32b708f98ecbfa1148c5393f8b9dba}{s2n\+\_\+server\+\_\+hello\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a2139f810755eb8cf27ebea179e81ac81}{s2n\+\_\+server\+\_\+hello\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_ab1bb9b2e08cb682e4bb9b156b49a0afa}{s2n\+\_\+server\+\_\+cert\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_aea75ffb292cac5d71183fee7c14b7496}{s2n\+\_\+server\+\_\+cert\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_af4c440c5d4b149bdc7b42a1fdf06b334}{s2n\+\_\+server\+\_\+status\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a6688277e6e5d779a28d99ec6d023a949}{s2n\+\_\+server\+\_\+status\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a940aed548236e016710e5ef69dc98df8}{s2n\+\_\+server\+\_\+key\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a933dc8cdaebb70f8a7364e390d9deeaf}{s2n\+\_\+server\+\_\+key\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a944852f699b2815f6a37b602113e26f7}{s2n\+\_\+server\+\_\+done\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a55414ad2a6f07ebbae51cbd0bf6f5974}{s2n\+\_\+server\+\_\+done\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a59294a875b6596b8dd5ad02a58e77c94}{s2n\+\_\+client\+\_\+key\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a5d0b0b0a8964b40aff5e3562bf65a9e1}{s2n\+\_\+client\+\_\+key\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a9be1791dfd4b0af9525be21fb52ec4eb}{s2n\+\_\+client\+\_\+ccs\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_aab9d53a394720e55e7648730f94bb176}{s2n\+\_\+client\+\_\+ccs\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_ad4c716e8d39e6bb93acba86ccda02554}{s2n\+\_\+server\+\_\+ccs\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_ae06266c2514a2576c570f3f01d9f9ecf}{s2n\+\_\+server\+\_\+ccs\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_ac384b39fb82314ba9d3d4aebbae8f0e3}{s2n\+\_\+client\+\_\+finished\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a1e5af2e3c7ad308eb7a32333210875f5}{s2n\+\_\+client\+\_\+finished\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a1faebdea4c42a7b27ce347885b9bd9ee}{s2n\+\_\+server\+\_\+finished\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_adae4d52456ffeb3a606ed1fb545539e4}{s2n\+\_\+server\+\_\+finished\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97}{s2n\+\_\+handshake\+\_\+write\+\_\+header} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn, uint8\+\_\+t message\+\_\+type)
\item 
int \hyperlink{s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a}{s2n\+\_\+handshake\+\_\+finish\+\_\+header} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42}{s2n\+\_\+handshake\+\_\+parse\+\_\+header} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn, uint8\+\_\+t $\ast$message\+\_\+type, uint32\+\_\+t $\ast$\hyperlink{include_2openssl_2asn1_8h_a5a2d57a92488e64c730cabc247c9d5b5}{length})
\item 
int \hyperlink{s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113}{s2n\+\_\+read\+\_\+full\+\_\+record} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn, uint8\+\_\+t $\ast$record\+\_\+type, int $\ast$is\+S\+S\+Lv2)
\item 
int \hyperlink{s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8}{s2n\+\_\+recv\+\_\+close\+\_\+notify} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn, \hyperlink{s2n_8h_af70ca0b089daa98cd79a424d3f6af15d}{s2n\+\_\+blocked\+\_\+status} $\ast$blocked)
\item 
int \hyperlink{s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8}{s2n\+\_\+client\+\_\+extensions\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn, struct \hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer} $\ast$out)
\item 
int \hyperlink{s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63}{s2n\+\_\+client\+\_\+extensions\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn, struct \hyperlink{structs2n__blob}{s2n\+\_\+blob} $\ast$extensions)
\item 
int \hyperlink{s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab}{s2n\+\_\+server\+\_\+extensions\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn, struct \hyperlink{structs2n__stuffer}{s2n\+\_\+stuffer} $\ast$out)
\item 
int \hyperlink{s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9}{s2n\+\_\+server\+\_\+extensions\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn, struct \hyperlink{structs2n__blob}{s2n\+\_\+blob} $\ast$extensions)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t \hyperlink{s2n__tls_8h_a0cb08e556504a133390d419bf05db470}{s2n\+\_\+highest\+\_\+protocol\+\_\+version}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+can\+\_\+send\+\_\+ocsp@{s2n\+\_\+server\+\_\+can\+\_\+send\+\_\+ocsp}}
\index{s2n\+\_\+server\+\_\+can\+\_\+send\+\_\+ocsp@{s2n\+\_\+server\+\_\+can\+\_\+send\+\_\+ocsp}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+can\+\_\+send\+\_\+ocsp}{s2n_server_can_send_ocsp}}]{\setlength{\rightskip}{0pt plus 5cm}\#define s2n\+\_\+server\+\_\+can\+\_\+send\+\_\+ocsp(
\begin{DoxyParamCaption}
\item[{}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a20bacac680b48d51f2623a1d95e85ca8}{}\label{s2n__tls_8h_a20bacac680b48d51f2623a1d95e85ca8}
{\bfseries Value\+:}
\begin{DoxyCode}
((conn)->status\_type == \hyperlink{s2n_8h_a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8}{S2N\_STATUS\_REQUEST\_OCSP} && \(\backslash\)
        (conn)->config->cert\_and\_key\_pairs && \(\backslash\)
        (conn)->\hyperlink{apps_8h_a67aa6ff0076e9d4fb2b5ad9e6fcb4d89}{config}->cert\_and\_key\_pairs->ocsp\_status.size > 0)
\end{DoxyCode}


Definition at line 58 of file s2n\+\_\+tls.\+h.



\subsection{Function Documentation}
\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+flush@{s2n\+\_\+flush}}
\index{s2n\+\_\+flush@{s2n\+\_\+flush}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+flush(struct s2n\+\_\+connection $\ast$conn, s2n\+\_\+blocked\+\_\+status $\ast$more)}{s2n_flush(struct s2n_connection *conn, s2n_blocked_status *more)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+flush (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn, }
\item[{{\bf s2n\+\_\+blocked\+\_\+status} $\ast$}]{more}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5}{}\label{s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5}


Definition at line 34 of file s2n\+\_\+send.\+c.


\begin{DoxyCode}
35 \{
36     \textcolor{keywordtype}{int} w;
37 
38     *blocked = \hyperlink{s2n_8h_af70ca0b089daa98cd79a424d3f6af15daefb6db9aaec431d69fc4c1249bc432e3}{S2N\_BLOCKED\_ON\_WRITE};
39 
40     \textcolor{comment}{/* Write any data that's already pending */}
41   WRITE:
42     \textcolor{keywordflow}{while} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->\hyperlink{structs2n__connection_aa4edd9e7ae7d0068c43a8c3d54073da0}{out})) \{
43         w = \hyperlink{s2n__stuffer_8h_a40bf61bc8745a2d894dd558a2885a66b}{s2n\_stuffer\_send\_to\_fd}(&conn->\hyperlink{structs2n__connection_aa4edd9e7ae7d0068c43a8c3d54073da0}{out}, conn->
      \hyperlink{structs2n__connection_abb118879baad1066df4d078fdb2da908}{writefd}, \hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->\hyperlink{structs2n__connection_aa4edd9e7ae7d0068c43a8c3d54073da0}{out}));
44         \textcolor{keywordflow}{if} (w < 0) \{
45             \textcolor{keywordflow}{if} (\hyperlink{_mac_socket_8cpp_ad65a8842cc674e3ddf69355898c0ecbf}{errno} == EWOULDBLOCK) \{
46                 \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374a440a0e3a40ff1c680a455803a9dd9dfc}{S2N\_ERR\_BLOCKED});
47             \}
48             \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ae8ab0b843d6f8172ea5f923aaf083374}{S2N\_ERR\_IO});
49         \}
50         conn->\hyperlink{structs2n__connection_ad34101c7be957b19718d9e9047e1af39}{wire\_bytes\_out} += w;
51     \}
52     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_afaf913ae0bd2fe2866608f51060791a2}{closing}) \{
53         conn->\hyperlink{structs2n__connection_a9e746c5b2dde4a77b710780924853c2f}{closed} = 1;
54         \textcolor{comment}{/* Delay wiping for close\_notify. s2n\_shutdown() needs to wait for peer's close\_notify */}
55         \textcolor{keywordflow}{if} (!conn->\hyperlink{structs2n__connection_a1ba9fe08a4f37494def44e02d95a2ffa}{close\_notify\_queued}) \{
56             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n_8h_aa869211ca9b49f497cdb5579935203de}{s2n\_connection\_wipe}(conn));
57         \}
58     \}
59     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ae1b97eb16ae517a82ec90a0e2b8c48e7}{s2n\_stuffer\_rewrite}(&conn->\hyperlink{structs2n__connection_aa4edd9e7ae7d0068c43a8c3d54073da0}{out}));
60 
61     \textcolor{comment}{/* If there's an alert pending out, send that */}
62     \textcolor{keywordflow}{if} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->
      \hyperlink{structs2n__connection_a00dd2a749a85d247561da67ec248d3e1}{reader\_alert\_out}) == 2) \{
63         \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} alert;
64         alert.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_a00dd2a749a85d247561da67ec248d3e1}{reader\_alert\_out}.\hyperlink{structs2n__stuffer_ab95f00f583f1cb41ae00918e9ea180c9}{blob}.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data};
65         alert.size = 2;
66         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__record_8h_a345384c81da35d41574e7a2c8319c7e3}{s2n\_record\_write}(conn, \hyperlink{s2n__fragmentation__coalescing__test_8c_afe02a145f0d3a71b14d61e2774987f9d}{TLS\_ALERT}, &alert));
67         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ae1b97eb16ae517a82ec90a0e2b8c48e7}{s2n\_stuffer\_rewrite}(&conn->
      \hyperlink{structs2n__connection_a00dd2a749a85d247561da67ec248d3e1}{reader\_alert\_out}));
68         conn->\hyperlink{structs2n__connection_afaf913ae0bd2fe2866608f51060791a2}{closing} = 1;
69 
70         \textcolor{comment}{/* Actually write it ... */}
71         \textcolor{keywordflow}{goto} WRITE;
72     \}
73 
74     \textcolor{comment}{/* Do the same for writer driven alerts */}
75     \textcolor{keywordflow}{if} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->
      \hyperlink{structs2n__connection_a6168f6d8f8b3d65bc1d566091149ddf4}{writer\_alert\_out}) == 2) \{
76         \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} alert;
77         alert.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_a6168f6d8f8b3d65bc1d566091149ddf4}{writer\_alert\_out}.\hyperlink{structs2n__stuffer_ab95f00f583f1cb41ae00918e9ea180c9}{blob}.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data};
78         alert.size = 2;
79         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__record_8h_a345384c81da35d41574e7a2c8319c7e3}{s2n\_record\_write}(conn, \hyperlink{s2n__fragmentation__coalescing__test_8c_afe02a145f0d3a71b14d61e2774987f9d}{TLS\_ALERT}, &alert));
80         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ae1b97eb16ae517a82ec90a0e2b8c48e7}{s2n\_stuffer\_rewrite}(&conn->
      \hyperlink{structs2n__connection_a6168f6d8f8b3d65bc1d566091149ddf4}{writer\_alert\_out}));
81         conn->\hyperlink{structs2n__connection_afaf913ae0bd2fe2866608f51060791a2}{closing} = 1;
82 
83         \textcolor{comment}{/* Actually write it ... */}
84         \textcolor{keywordflow}{goto} WRITE;
85     \}
86 
87     *blocked = \hyperlink{s2n_8h_af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd}{S2N\_NOT\_BLOCKED};
88 
89     \textcolor{keywordflow}{return} 0;
90 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5_icgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+client\+\_\+hello\+\_\+send@{s2n\+\_\+client\+\_\+hello\+\_\+send}}
\index{s2n\+\_\+client\+\_\+hello\+\_\+send@{s2n\+\_\+client\+\_\+hello\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+hello\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_client_hello_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+hello\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a4b86117a2a4f018991a01ff788272441}{}\label{s2n__tls_8h_a4b86117a2a4f018991a01ff788272441}


Definition at line 106 of file s2n\+\_\+client\+\_\+hello.\+c.


\begin{DoxyCode}
107 \{
108     uint32\_t gmt\_unix\_time = \hyperlink{s2n__server__fuzz__test__overrides_8c_a840ddd268669df5b1e15c04cebbd6210}{time}(NULL);
109     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} *out = &conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io};
110     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} client\_random;
111     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} b, r;
112     uint8\_t session\_id\_len = 0;
113     uint8\_t client\_protocol\_version[\hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2N\_TLS\_PROTOCOL\_VERSION\_LEN}];
114 
115     b.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a782eb75227ef443a21bfa5f2eb9d4b7a}{client\_random};
116     b.size = \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN};
117 
118     \textcolor{comment}{/* Create the client random data */}
119     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_af556836db8ed75fdb89af3d418fab2ee}{s2n\_stuffer\_init}(&client\_random, &b));
120     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a958a82fb4dfe3517bcfd95f46807f715}{s2n\_stuffer\_write\_uint32}(&client\_random, gmt\_unix\_time));
121 
122     r.data = \hyperlink{s2n__stuffer_8c_afdc941db81df32f38b7800210f3f2d11}{s2n\_stuffer\_raw\_write}(&client\_random, 
      \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN} - 4);
123     r.size = \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN} - 4;
124     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(r.data);
125     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__random_8c_a5cfef84444cc08086a4098569c9f1fc8}{s2n\_get\_public\_random\_data}(&r));
126 
127     client\_protocol\_version[0] = conn->\hyperlink{structs2n__connection_a29289057caf9ad21e99bd972da14acc3}{client\_protocol\_version} / 10;
128     client\_protocol\_version[1] = conn->\hyperlink{structs2n__connection_a29289057caf9ad21e99bd972da14acc3}{client\_protocol\_version} % 10;
129     conn->\hyperlink{structs2n__connection_a6055b7733f7282857a29ef763a4aed62}{client\_hello\_version} = conn->
      \hyperlink{structs2n__connection_a29289057caf9ad21e99bd972da14acc3}{client\_protocol\_version};
130 
131     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(out, client\_protocol\_version, 
      \hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2N\_TLS\_PROTOCOL\_VERSION\_LEN}));
132     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aff9283fe7b7a90e13c6c90014719354d}{s2n\_stuffer\_copy}(&client\_random, out, 
      \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN}));
133     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, session\_id\_len));
134     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, conn->
      \hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->\hyperlink{structs2n__config_a2cdf2a56849d48a020a71d6e8d03d9cf}{cipher\_preferences}->\hyperlink{structs2n__cipher__preferences_a20302e2c99a60d3f612dba57e3f6333b}{count} * 
      \hyperlink{tls_2s2n__crypto_8h_aad5e2a880d4b55cf5450393843a17cf8}{S2N\_TLS\_CIPHER\_SUITE\_LEN}));
135     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(out, conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->
      \hyperlink{structs2n__config_a2cdf2a56849d48a020a71d6e8d03d9cf}{cipher\_preferences}->\hyperlink{structs2n__cipher__preferences_acc56b427760b185ee09b05e370850623}{wire\_format}, conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->
      \hyperlink{structs2n__config_a2cdf2a56849d48a020a71d6e8d03d9cf}{cipher\_preferences}->\hyperlink{structs2n__cipher__preferences_a20302e2c99a60d3f612dba57e3f6333b}{count} * \hyperlink{tls_2s2n__crypto_8h_aad5e2a880d4b55cf5450393843a17cf8}{S2N\_TLS\_CIPHER\_SUITE\_LEN}));
136 
137     \textcolor{comment}{/* Zero compression methods */}
138     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, 1));
139     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, 0));
140 
141     \textcolor{comment}{/* Write the extensions */}
142     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__client__extensions_8c_a5693cff7b0838d6d62b5b9e70a1e17f8}{s2n\_client\_extensions\_send}(conn, out));
143 
144     \textcolor{keywordflow}{return} 0;
145 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a4b86117a2a4f018991a01ff788272441_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+client\+\_\+hello\+\_\+recv@{s2n\+\_\+client\+\_\+hello\+\_\+recv}}
\index{s2n\+\_\+client\+\_\+hello\+\_\+recv@{s2n\+\_\+client\+\_\+hello\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+hello\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_client_hello_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+hello\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_abfb7d01ea645110aea3c808de4d86f1d}{}\label{s2n__tls_8h_abfb7d01ea645110aea3c808de4d86f1d}


Definition at line 39 of file s2n\+\_\+client\+\_\+hello.\+c.


\begin{DoxyCode}
40 \{
41     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} *in = &conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io};
42     uint8\_t compression\_methods;
43     uint16\_t extensions\_size;
44     uint16\_t cipher\_suites\_length;
45     uint8\_t *cipher\_suites;
46     uint8\_t client\_protocol\_version[\hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2N\_TLS\_PROTOCOL\_VERSION\_LEN}];
47 
48     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ab84cff8edd5b5f264afe261f093f894b}{s2n\_stuffer\_read\_bytes}(in, client\_protocol\_version, 
      \hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2N\_TLS\_PROTOCOL\_VERSION\_LEN}));
49     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ab84cff8edd5b5f264afe261f093f894b}{s2n\_stuffer\_read\_bytes}(in, conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_a782eb75227ef443a21bfa5f2eb9d4b7a}{client\_random}, \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN}));
50     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}(in, &conn->
      \hyperlink{structs2n__connection_a76a9703b780cc6c577acbe9ed651a79d}{session\_id\_len}));
51 
52     conn->\hyperlink{structs2n__connection_a29289057caf9ad21e99bd972da14acc3}{client\_protocol\_version} = (client\_protocol\_version[0] * 10) + 
      client\_protocol\_version[1];
53     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a29289057caf9ad21e99bd972da14acc3}{client\_protocol\_version} < conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->
      \hyperlink{structs2n__config_a2cdf2a56849d48a020a71d6e8d03d9cf}{cipher\_preferences}->\hyperlink{structs2n__cipher__preferences_a98d8055e86b9652d5448a1a82a9f9407}{minimum\_protocol\_version} || conn->
      \hyperlink{structs2n__connection_a29289057caf9ad21e99bd972da14acc3}{client\_protocol\_version} > \hyperlink{s2n_8h_ab17e84046986d49ffd31571b8d32d24e}{S2N\_TLS12}) \{
54         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__alerts_8c_aaab45cd713be8d161a114cf078b52635}{s2n\_queue\_reader\_unsupported\_protocol\_version\_alert}
      (conn));
55         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
56     \}
57     conn->\hyperlink{structs2n__connection_a6055b7733f7282857a29ef763a4aed62}{client\_hello\_version} = conn->
      \hyperlink{structs2n__connection_a29289057caf9ad21e99bd972da14acc3}{client\_protocol\_version};
58     conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} = MIN(conn->
      \hyperlink{structs2n__connection_a29289057caf9ad21e99bd972da14acc3}{client\_protocol\_version}, conn->\hyperlink{structs2n__connection_ae48c8e6d0ef10e7b815dd500562a47e7}{server\_protocol\_version});
59 
60     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a76a9703b780cc6c577acbe9ed651a79d}{session\_id\_len} > \hyperlink{tls_2s2n__crypto_8h_a29125d7c5bb81700b27164fbc9c92746}{S2N\_TLS\_SESSION\_ID\_MAX\_LEN} || conn->
      \hyperlink{structs2n__connection_a76a9703b780cc6c577acbe9ed651a79d}{session\_id\_len} > \hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(in)) \{
61         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
62     \}
63 
64     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ab84cff8edd5b5f264afe261f093f894b}{s2n\_stuffer\_read\_bytes}(in, conn->\hyperlink{structs2n__connection_ad009472eb0ee35fef5b49e42599a84a1}{session\_id}, conn->
      \hyperlink{structs2n__connection_a76a9703b780cc6c577acbe9ed651a79d}{session\_id\_len}));
65 
66     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a788c22abe22da96107393257193632c5}{s2n\_stuffer\_read\_uint16}(in, &cipher\_suites\_length));
67     \textcolor{keywordflow}{if} (cipher\_suites\_length % \hyperlink{tls_2s2n__crypto_8h_aad5e2a880d4b55cf5450393843a17cf8}{S2N\_TLS\_CIPHER\_SUITE\_LEN}) \{
68         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
69     \}
70     cipher\_suites = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(in, cipher\_suites\_length);
71     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(cipher\_suites);
72     \textcolor{comment}{/* Don't choose the cipher yet, read the extensions first */}
73 
74     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}(in, &compression\_methods));
75     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a0d643b31c896c7f6f2c058977cf46c3b}{s2n\_stuffer\_skip\_read}(in, compression\_methods));
76 
77     \textcolor{comment}{/* This is going to be our default if the client has no preference. */}
78     conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a1a6eac074b87a6fa3440ed9d4724d07d}{server\_ecc\_params}.\hyperlink{structs2n__ecc__params_a1e0c49e3a87b8db6332443fcf0462468}{negotiated\_curve} = &
      \hyperlink{s2n__ecc_8c_a27f438af5123167d9e831390707be2a0}{s2n\_ecc\_supported\_curves}[0];
79 
80     \textcolor{keywordflow}{if} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(in) >= 2) \{
81         \textcolor{comment}{/* Read extensions if they are present */}
82         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a788c22abe22da96107393257193632c5}{s2n\_stuffer\_read\_uint16}(in, &extensions\_size));
83 
84         \textcolor{keywordflow}{if} (extensions\_size > \hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(in)) \{
85             \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
86         \}
87 
88         \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} extensions;
89         extensions.\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size} = extensions\_size;
90         extensions.data = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(in, extensions.size);
91         \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(extensions.data);
92 
93         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__client__extensions_8c_a53cfe69398f5503ced5ba7745c562e63}{s2n\_client\_extensions\_recv}(conn, &extensions));
94     \}
95 
96     \textcolor{comment}{/* Now choose the ciphers and the cert chain. */}
97     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__cipher__suites_8c_a786e7c2f58d929af6012129893c03e63}{s2n\_set\_cipher\_as\_tls\_server}(conn, cipher\_suites, 
      cipher\_suites\_length / 2));
98     conn->\hyperlink{structs2n__connection_abfab1f3796089e3576e73286c0b6889c}{server}->\hyperlink{structs2n__crypto__parameters_a20dd75e38ae2f99535e509425e4dface}{chosen\_cert\_chain} = conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->
      \hyperlink{structs2n__config_acd0d45f80129861144d237591eee6c5f}{cert\_and\_key\_pairs};
99 
100     \textcolor{comment}{/* Set the handshake type */}
101     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__handshake_8h_a4406f29de6d52b587003368d656dab20}{s2n\_conn\_set\_handshake\_type}(conn));
102 
103     \textcolor{keywordflow}{return} 0;
104 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_abfb7d01ea645110aea3c808de4d86f1d_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+sslv2\+\_\+client\+\_\+hello\+\_\+recv@{s2n\+\_\+sslv2\+\_\+client\+\_\+hello\+\_\+recv}}
\index{s2n\+\_\+sslv2\+\_\+client\+\_\+hello\+\_\+recv@{s2n\+\_\+sslv2\+\_\+client\+\_\+hello\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+sslv2\+\_\+client\+\_\+hello\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_sslv2_client_hello_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+sslv2\+\_\+client\+\_\+hello\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1}{}\label{s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1}


Definition at line 148 of file s2n\+\_\+client\+\_\+hello.\+c.


\begin{DoxyCode}
149 \{
150     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} *in = &conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io};
151     uint16\_t session\_id\_length;
152     uint16\_t cipher\_suites\_length;
153     uint16\_t challenge\_length;
154     uint8\_t *cipher\_suites;
155 
156     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a29289057caf9ad21e99bd972da14acc3}{client\_protocol\_version} < conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->
      \hyperlink{structs2n__config_a2cdf2a56849d48a020a71d6e8d03d9cf}{cipher\_preferences}->\hyperlink{structs2n__cipher__preferences_a98d8055e86b9652d5448a1a82a9f9407}{minimum\_protocol\_version} || conn->
      \hyperlink{structs2n__connection_a29289057caf9ad21e99bd972da14acc3}{client\_protocol\_version} > \hyperlink{s2n_8h_ab17e84046986d49ffd31571b8d32d24e}{S2N\_TLS12}) \{
157         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__alerts_8c_aaab45cd713be8d161a114cf078b52635}{s2n\_queue\_reader\_unsupported\_protocol\_version\_alert}
      (conn));
158         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
159     \}
160     conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} = MIN(conn->
      \hyperlink{structs2n__connection_a29289057caf9ad21e99bd972da14acc3}{client\_protocol\_version}, conn->\hyperlink{structs2n__connection_ae48c8e6d0ef10e7b815dd500562a47e7}{server\_protocol\_version});
161     conn->\hyperlink{structs2n__connection_a6055b7733f7282857a29ef763a4aed62}{client\_hello\_version} = \hyperlink{s2n_8h_a495735277344c9c306668f6027e3f077}{S2N\_SSLv2};
162 
163     \textcolor{comment}{/* We start 5 bytes into the record */}
164     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a788c22abe22da96107393257193632c5}{s2n\_stuffer\_read\_uint16}(in, &cipher\_suites\_length));
165 
166     \textcolor{keywordflow}{if} (cipher\_suites\_length % \hyperlink{tls_2s2n__crypto_8h_a3949cc93dd4131fe3bcc6d11d2d43da4}{S2N\_SSLv2\_CIPHER\_SUITE\_LEN}) \{
167         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
168     \}
169 
170     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a788c22abe22da96107393257193632c5}{s2n\_stuffer\_read\_uint16}(in, &session\_id\_length));
171 
172     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a788c22abe22da96107393257193632c5}{s2n\_stuffer\_read\_uint16}(in, &challenge\_length));
173 
174     \textcolor{keywordflow}{if} (challenge\_length > \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN}) \{
175         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
176     \}
177 
178     cipher\_suites = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(in, cipher\_suites\_length);
179     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(cipher\_suites);
180     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__cipher__suites_8c_a93d49c8f6f3f8a5f4b7e703a61421b7b}{s2n\_set\_cipher\_as\_sslv2\_server}(conn, cipher\_suites, 
      cipher\_suites\_length / S2N\_SSLv2\_CIPHER\_SUITE\_LEN));
181 
182     \textcolor{keywordflow}{if} (session\_id\_length > \hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(in)) \{
183         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
184     \}
185     \textcolor{keywordflow}{if} (session\_id\_length > 0 && session\_id\_length <= \hyperlink{tls_2s2n__crypto_8h_a29125d7c5bb81700b27164fbc9c92746}{S2N\_TLS\_SESSION\_ID\_MAX\_LEN})
       \{
186         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ab84cff8edd5b5f264afe261f093f894b}{s2n\_stuffer\_read\_bytes}(in, conn->
      \hyperlink{structs2n__connection_ad009472eb0ee35fef5b49e42599a84a1}{session\_id}, session\_id\_length));
187         conn->\hyperlink{structs2n__connection_a76a9703b780cc6c577acbe9ed651a79d}{session\_id\_len} = (uint8\_t) session\_id\_length;
188     \} \textcolor{keywordflow}{else} \{
189         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a0d643b31c896c7f6f2c058977cf46c3b}{s2n\_stuffer\_skip\_read}(in, session\_id\_length));
190     \}
191 
192     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} b;
193     b.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a782eb75227ef443a21bfa5f2eb9d4b7a}{client\_random};
194     b.size = \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN};
195 
196     b.data += \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN} - challenge\_length;
197     b.size -= \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN} - challenge\_length;
198 
199     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a49bb9749c055c6fb6f713cebeaa14cb5}{s2n\_stuffer\_read}(in, &b));
200 
201     conn->\hyperlink{structs2n__connection_abfab1f3796089e3576e73286c0b6889c}{server}->\hyperlink{structs2n__crypto__parameters_a20dd75e38ae2f99535e509425e4dface}{chosen\_cert\_chain} = conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->
      \hyperlink{structs2n__config_acd0d45f80129861144d237591eee6c5f}{cert\_and\_key\_pairs};
202     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__handshake_8h_a4406f29de6d52b587003368d656dab20}{s2n\_conn\_set\_handshake\_type}(conn));
203 
204     \textcolor{keywordflow}{return} 0;
205 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1_icgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+hello\+\_\+send@{s2n\+\_\+server\+\_\+hello\+\_\+send}}
\index{s2n\+\_\+server\+\_\+hello\+\_\+send@{s2n\+\_\+server\+\_\+hello\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+hello\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_hello_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+hello\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a8e32b708f98ecbfa1148c5393f8b9dba}{}\label{s2n__tls_8h_a8e32b708f98ecbfa1148c5393f8b9dba}


Definition at line 111 of file s2n\+\_\+server\+\_\+hello.\+c.


\begin{DoxyCode}
112 \{
113     uint32\_t gmt\_unix\_time = \hyperlink{s2n__server__fuzz__test__overrides_8c_a840ddd268669df5b1e15c04cebbd6210}{time}(NULL);
114     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} *out = &conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io};
115     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} server\_random;
116     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} b, r;
117     uint8\_t protocol\_version[\hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2N\_TLS\_PROTOCOL\_VERSION\_LEN}];
118 
119     b.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_ae6ef2eba6c9afbd8345314a05422a2e4}{server\_random};
120     b.size = \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN};
121 
122     \textcolor{comment}{/* Create the server random data */}
123     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_af556836db8ed75fdb89af3d418fab2ee}{s2n\_stuffer\_init}(&server\_random, &b));
124     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a958a82fb4dfe3517bcfd95f46807f715}{s2n\_stuffer\_write\_uint32}(&server\_random, gmt\_unix\_time));
125 
126     r.data = \hyperlink{s2n__stuffer_8c_afdc941db81df32f38b7800210f3f2d11}{s2n\_stuffer\_raw\_write}(&server\_random, 
      \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN} - 4);
127     r.size = \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN} - 4;
128     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(r.data);
129     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__random_8c_a5cfef84444cc08086a4098569c9f1fc8}{s2n\_get\_public\_random\_data}(&r));
130 
131     protocol\_version[0] = conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} / 10;
132     protocol\_version[1] = conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} % 10;
133 
134     conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a76195ad1b96e7ecdec22ee893d81c6c7}{signature\_digest\_alg} = 
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5ac0f7f343aebed483dfa89ad357fa6419}{S2N\_HASH\_MD5\_SHA1};
135     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} == \hyperlink{s2n_8h_ab17e84046986d49ffd31571b8d32d24e}{S2N\_TLS12}) \{
136         conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a76195ad1b96e7ecdec22ee893d81c6c7}{signature\_digest\_alg} = 
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627}{S2N\_HASH\_SHA1};
137     \}
138 
139     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(out, protocol\_version, 
      \hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2N\_TLS\_PROTOCOL\_VERSION\_LEN}));
140     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(out, conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_ae6ef2eba6c9afbd8345314a05422a2e4}{server\_random}, \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN}));
141     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, conn->
      \hyperlink{structs2n__connection_a76a9703b780cc6c577acbe9ed651a79d}{session\_id\_len}));
142     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(out, conn->
      \hyperlink{structs2n__connection_ad009472eb0ee35fef5b49e42599a84a1}{session\_id}, conn->\hyperlink{structs2n__connection_a76a9703b780cc6c577acbe9ed651a79d}{session\_id\_len}));
143     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(out, conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_a5446cce0337d14b74b38f2a81ea19670}{cipher\_suite}->\hyperlink{structs2n__cipher__suite_a9b3a865c19b6bc5b1d68ff63ed97b6c5}{value}, \hyperlink{tls_2s2n__crypto_8h_aad5e2a880d4b55cf5450393843a17cf8}{S2N\_TLS\_CIPHER\_SUITE\_LEN}));
144     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, 
      \hyperlink{s2n__server__hello_8c_a2cb71a349ceab5a3a4a46d133306bf81}{S2N\_TLS\_COMPRESSION\_METHOD\_NULL}));
145 
146     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__server__extensions_8c_a72b3e9fb3b4cb76a22e8d236609029ab}{s2n\_server\_extensions\_send}(conn, out));
147 
148     conn->\hyperlink{structs2n__connection_ab54a0b4ad8370fee08f0c47917684e65}{actual\_protocol\_version\_established} = 1;
149 
150     \textcolor{keywordflow}{return} 0;
151 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a8e32b708f98ecbfa1148c5393f8b9dba_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+hello\+\_\+recv@{s2n\+\_\+server\+\_\+hello\+\_\+recv}}
\index{s2n\+\_\+server\+\_\+hello\+\_\+recv@{s2n\+\_\+server\+\_\+hello\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+hello\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_hello_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+hello\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a2139f810755eb8cf27ebea179e81ac81}{}\label{s2n__tls_8h_a2139f810755eb8cf27ebea179e81ac81}


Definition at line 36 of file s2n\+\_\+server\+\_\+hello.\+c.


\begin{DoxyCode}
37 \{
38     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} *in = &conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io};
39     uint8\_t compression\_method;
40     uint8\_t session\_id[\hyperlink{tls_2s2n__crypto_8h_a29125d7c5bb81700b27164fbc9c92746}{S2N\_TLS\_SESSION\_ID\_MAX\_LEN}];
41     uint8\_t session\_id\_len;
42     uint16\_t extensions\_size;
43     uint8\_t protocol\_version[\hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2N\_TLS\_PROTOCOL\_VERSION\_LEN}];
44 
45     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ab84cff8edd5b5f264afe261f093f894b}{s2n\_stuffer\_read\_bytes}(in, protocol\_version, 
      \hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2N\_TLS\_PROTOCOL\_VERSION\_LEN}));
46 
47     conn->\hyperlink{structs2n__connection_ae48c8e6d0ef10e7b815dd500562a47e7}{server\_protocol\_version} = (protocol\_version[0] * 10) + protocol\_version[1]
      ;
48 
49     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_ae48c8e6d0ef10e7b815dd500562a47e7}{server\_protocol\_version} > conn->
      \hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version}) \{
50         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__alerts_8c_aaab45cd713be8d161a114cf078b52635}{s2n\_queue\_reader\_unsupported\_protocol\_version\_alert}
      (conn));
51         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
52     \}
53     conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} = conn->
      \hyperlink{structs2n__connection_ae48c8e6d0ef10e7b815dd500562a47e7}{server\_protocol\_version};
54     conn->\hyperlink{structs2n__connection_ab54a0b4ad8370fee08f0c47917684e65}{actual\_protocol\_version\_established} = 1;
55 
56     \textcolor{comment}{/* Verify that the protocol version is sane */}
57     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} < \hyperlink{s2n_8h_a457805749bd152786e9e344a5b22ab67}{S2N\_SSLv3} || conn->
      \hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} > \hyperlink{s2n_8h_ab17e84046986d49ffd31571b8d32d24e}{S2N\_TLS12}) \{
58         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
59     \}
60 
61     conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a76195ad1b96e7ecdec22ee893d81c6c7}{signature\_digest\_alg} = 
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5ac0f7f343aebed483dfa89ad357fa6419}{S2N\_HASH\_MD5\_SHA1};
62     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} == \hyperlink{s2n_8h_ab17e84046986d49ffd31571b8d32d24e}{S2N\_TLS12}) \{
63         conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a76195ad1b96e7ecdec22ee893d81c6c7}{signature\_digest\_alg} = 
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627}{S2N\_HASH\_SHA1};
64     \}
65 
66     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ab84cff8edd5b5f264afe261f093f894b}{s2n\_stuffer\_read\_bytes}(in, conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_ae6ef2eba6c9afbd8345314a05422a2e4}{server\_random}, \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN}));
67     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}(in, &session\_id\_len));
68 
69     \textcolor{keywordflow}{if} (session\_id\_len > \hyperlink{tls_2s2n__crypto_8h_a29125d7c5bb81700b27164fbc9c92746}{S2N\_TLS\_SESSION\_ID\_MAX\_LEN}) \{
70         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
71     \}
72 
73     conn->\hyperlink{structs2n__connection_a76a9703b780cc6c577acbe9ed651a79d}{session\_id\_len} = session\_id\_len;
74     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ab84cff8edd5b5f264afe261f093f894b}{s2n\_stuffer\_read\_bytes}(in, session\_id, session\_id\_len));
75     uint8\_t *cipher\_suite\_wire = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(in, 
      \hyperlink{tls_2s2n__crypto_8h_aad5e2a880d4b55cf5450393843a17cf8}{S2N\_TLS\_CIPHER\_SUITE\_LEN});
76     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(cipher\_suite\_wire);
77     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__cipher__suites_8c_a1fde427e44c9343e87af779ca1666b9e}{s2n\_set\_cipher\_as\_client}(conn, cipher\_suite\_wire));
78     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}(in, &compression\_method));
79 
80     \textcolor{keywordflow}{if} (compression\_method != \hyperlink{s2n__server__hello_8c_a2cb71a349ceab5a3a4a46d133306bf81}{S2N\_TLS\_COMPRESSION\_METHOD\_NULL}) \{
81         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
82     \}
83 
84     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__handshake_8h_a4406f29de6d52b587003368d656dab20}{s2n\_conn\_set\_handshake\_type}(conn));
85 
86     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a8b8974068a8f2c38a061ffb495a5ca1c}{handshake\_type} == RESUME) \{
87         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a1425bb608ed69a0cc582af0a57955e1f}{s2n\_prf\_key\_expansion}(conn));
88     \}
89 
90     \textcolor{keywordflow}{if} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(in) < 2) \{
91         \textcolor{comment}{/* No extensions */}
92         \textcolor{keywordflow}{return} 0;
93     \}
94 
95     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a788c22abe22da96107393257193632c5}{s2n\_stuffer\_read\_uint16}(in, &extensions\_size));
96 
97     \textcolor{keywordflow}{if} (extensions\_size > \hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(in)) \{
98         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
99     \}
100 
101     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} extensions;
102     extensions.\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size} = extensions\_size;
103     extensions.data = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(in, extensions.size);
104     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(extensions.data);
105 
106     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__server__extensions_8c_aa5973260f0a72187b1331e5633795fe9}{s2n\_server\_extensions\_recv}(conn, &extensions));
107 
108     \textcolor{keywordflow}{return} 0;
109 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a2139f810755eb8cf27ebea179e81ac81_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+cert\+\_\+send@{s2n\+\_\+server\+\_\+cert\+\_\+send}}
\index{s2n\+\_\+server\+\_\+cert\+\_\+send@{s2n\+\_\+server\+\_\+cert\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+cert\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_cert_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+cert\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_ab1bb9b2e08cb682e4bb9b156b49a0afa}{}\label{s2n__tls_8h_ab1bb9b2e08cb682e4bb9b156b49a0afa}


Definition at line 70 of file s2n\+\_\+server\+\_\+cert.\+c.


\begin{DoxyCode}
71 \{
72     \textcolor{keyword}{struct }\hyperlink{structs2n__cert__chain}{s2n\_cert\_chain} *head = conn->\hyperlink{structs2n__connection_abfab1f3796089e3576e73286c0b6889c}{server}->
      \hyperlink{structs2n__crypto__parameters_a20dd75e38ae2f99535e509425e4dface}{chosen\_cert\_chain}->\hyperlink{structs2n__cert__chain__and__key_a006e23cea0adf1733edba58ea15cd7ed}{head};
73 
74     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aa78701a9bb01def1efcbfa30ba0bdfc9}{s2n\_stuffer\_write\_uint24}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, conn->\hyperlink{structs2n__connection_abfab1f3796089e3576e73286c0b6889c}{server}->\hyperlink{structs2n__crypto__parameters_a20dd75e38ae2f99535e509425e4dface}{chosen\_cert\_chain}->\hyperlink{structs2n__cert__chain__and__key_af6903d14cb3f4627a8cfe70d368b1413}{chain\_size}));
75 
76     \textcolor{keywordflow}{while} (head) \{
77         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aa78701a9bb01def1efcbfa30ba0bdfc9}{s2n\_stuffer\_write\_uint24}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, head->\hyperlink{structs2n__cert__chain_a875a2920fc4ec101b865d6006baa3b75}{cert}.\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size}));
78         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, head->\hyperlink{structs2n__cert__chain_a875a2920fc4ec101b865d6006baa3b75}{cert}.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}, head->\hyperlink{structs2n__cert__chain_a875a2920fc4ec101b865d6006baa3b75}{cert}.\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size}));
79         head = head->\hyperlink{structs2n__cert__chain_ae78fa31ff74363e3d7351dd25f5a0745}{next};
80     \}
81 
82     \textcolor{keywordflow}{return} 0;
83 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_ab1bb9b2e08cb682e4bb9b156b49a0afa_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+cert\+\_\+recv@{s2n\+\_\+server\+\_\+cert\+\_\+recv}}
\index{s2n\+\_\+server\+\_\+cert\+\_\+recv@{s2n\+\_\+server\+\_\+cert\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+cert\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_cert_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+cert\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_aea75ffb292cac5d71183fee7c14b7496}{}\label{s2n__tls_8h_aea75ffb292cac5d71183fee7c14b7496}


Definition at line 29 of file s2n\+\_\+server\+\_\+cert.\+c.


\begin{DoxyCode}
30 \{
31     uint32\_t size\_of\_all\_certificates;
32 
33     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a71787bb6eeba3413137cde42d32a0f6c}{s2n\_stuffer\_read\_uint24}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, &size\_of\_all\_certificates));
34 
35     \textcolor{keywordflow}{if} (size\_of\_all\_certificates > \hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}) || size\_of\_all\_certificates < 3) \{
36         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
37     \}
38 
39     \textcolor{keywordtype}{int} certificate\_count = 0;
40     \textcolor{keywordflow}{while} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io})) \{
41         uint32\_t certificate\_size;
42 
43         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a71787bb6eeba3413137cde42d32a0f6c}{s2n\_stuffer\_read\_uint24}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, &certificate\_size));
44 
45         \textcolor{keywordflow}{if} (certificate\_size > \hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}) || certificate\_size == 0) \{
46             \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
47         \}
48 
49         \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} asn1cert;
50         asn1cert.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, certificate\_size);
51         asn1cert.size = certificate\_size;
52         \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(asn1cert.data);
53 
54         \textcolor{comment}{/* TODO: certificate validation goes here */}
55         \hyperlink{s2n__safety_8h_a83da623ffe1132fa8ff86945161d4ed7}{gt\_check}(certificate\_size, 0);
56 
57         \textcolor{comment}{/* Pull the public key from the first certificate */}
58         \textcolor{keywordflow}{if} (certificate\_count == 0) \{
59             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__rsa_8c_a4cd1d9d3c5bb5e42c5301366b38b361a}{s2n\_asn1der\_to\_rsa\_public\_key}(&conn->
      \hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_ac66524c1ba7864aa76ef5774384e7579}{server\_rsa\_public\_key}, &asn1cert));
60         \}
61 
62         certificate\_count++;
63     \}
64 
65     \hyperlink{s2n__safety_8h_a033f3870a2832a9972eadb4700f725b9}{gte\_check}(certificate\_count, 1);
66 
67     \textcolor{keywordflow}{return} 0;
68 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_aea75ffb292cac5d71183fee7c14b7496_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+status\+\_\+send@{s2n\+\_\+server\+\_\+status\+\_\+send}}
\index{s2n\+\_\+server\+\_\+status\+\_\+send@{s2n\+\_\+server\+\_\+status\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+status\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_status_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+status\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_af4c440c5d4b149bdc7b42a1fdf06b334}{}\label{s2n__tls_8h_af4c440c5d4b149bdc7b42a1fdf06b334}


Definition at line 27 of file s2n\+\_\+ocsp\+\_\+stapling.\+c.


\begin{DoxyCode}
28 \{
29     uint32\_t \hyperlink{crypto_2asn1_2asn1_8h_a5a2d57a92488e64c730cabc247c9d5b5}{length} = conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->\hyperlink{structs2n__config_acd0d45f80129861144d237591eee6c5f}{cert\_and\_key\_pairs}->
      \hyperlink{structs2n__cert__chain__and__key_a4baf31cc326e006017c66fe41b4194d6}{ocsp\_status}.\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size} + 4;
30     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aa78701a9bb01def1efcbfa30ba0bdfc9}{s2n\_stuffer\_write\_uint24}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, length));
31 
32     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, (uint8\_t) \hyperlink{s2n_8h_a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8}{S2N\_STATUS\_REQUEST\_OCSP}));
33     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aa78701a9bb01def1efcbfa30ba0bdfc9}{s2n\_stuffer\_write\_uint24}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->\hyperlink{structs2n__config_acd0d45f80129861144d237591eee6c5f}{cert\_and\_key\_pairs}->\hyperlink{structs2n__cert__chain__and__key_a4baf31cc326e006017c66fe41b4194d6}{ocsp\_status}.
      \hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size}));
34     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ad77ea23089bbeb19b897a73bf6ca3fde}{s2n\_stuffer\_write}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, &conn->
      \hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->\hyperlink{structs2n__config_acd0d45f80129861144d237591eee6c5f}{cert\_and\_key\_pairs}->\hyperlink{structs2n__cert__chain__and__key_a4baf31cc326e006017c66fe41b4194d6}{ocsp\_status}));
35 
36     \textcolor{keywordflow}{return} 0;
37 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_af4c440c5d4b149bdc7b42a1fdf06b334_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+status\+\_\+recv@{s2n\+\_\+server\+\_\+status\+\_\+recv}}
\index{s2n\+\_\+server\+\_\+status\+\_\+recv@{s2n\+\_\+server\+\_\+status\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+status\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_status_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+status\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a6688277e6e5d779a28d99ec6d023a949}{}\label{s2n__tls_8h_a6688277e6e5d779a28d99ec6d023a949}


Definition at line 39 of file s2n\+\_\+ocsp\+\_\+stapling.\+c.


\begin{DoxyCode}
40 \{
41     uint8\_t \hyperlink{crypto_2x509_2x509_8h_ab512b8f495325c7ea0f5a5a5d3f938eb}{type};
42     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} status = \{.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = NULL,.size = 0 \};
43 
44     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, &type));
45     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a71787bb6eeba3413137cde42d32a0f6c}{s2n\_stuffer\_read\_uint24}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, &status.\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size}));
46     status.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, status.\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size});
47     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(status.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data});
48 
49     \textcolor{keywordflow}{if} (type == \hyperlink{s2n_8h_a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8}{S2N\_STATUS\_REQUEST\_OCSP}) \{
50         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__mem_8c_a6fb5d30c5bbbc73694b21821ff2da82f}{s2n\_alloc}(&conn->\hyperlink{structs2n__connection_ab3cd78ec62aea98bf900913bb379d523}{status\_response}, status.
      \hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size}));
51         \hyperlink{s2n__safety_8h_ad77a50a47d8de0b8e6c8d4beffed95b2}{memcpy\_check}(conn->\hyperlink{structs2n__connection_ab3cd78ec62aea98bf900913bb379d523}{status\_response}.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}, status.
      \hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}, status.\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size});
52         conn->\hyperlink{structs2n__connection_ab3cd78ec62aea98bf900913bb379d523}{status\_response}.\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size} = status.\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size};
53     \}
54 
55     \textcolor{keywordflow}{return} 0;
56 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a6688277e6e5d779a28d99ec6d023a949_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+key\+\_\+send@{s2n\+\_\+server\+\_\+key\+\_\+send}}
\index{s2n\+\_\+server\+\_\+key\+\_\+send@{s2n\+\_\+server\+\_\+key\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+key\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_key_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+key\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a940aed548236e016710e5ef69dc98df8}{}\label{s2n__tls_8h_a940aed548236e016710e5ef69dc98df8}


Definition at line 210 of file s2n\+\_\+server\+\_\+key\+\_\+exchange.\+c.


\begin{DoxyCode}
211 \{
212     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a5446cce0337d14b74b38f2a81ea19670}{cipher\_suite}->\hyperlink{structs2n__cipher__suite_aaf88ce0be23d983d21bbbecfce1c293d}{key\_exchange\_alg}->
      \hyperlink{structs2n__key__exchange__algorithm_a1e87af3c18a2fd36c61faf89949bdc3f}{flags} & \hyperlink{s2n__cipher__suites_8h_a12019f7e03ca6cbe2075ef675d5e5dec}{S2N\_KEY\_EXCHANGE\_ECC}) \{
213         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_ecdhe\_server\_key\_send(conn));
214     \} \textcolor{keywordflow}{else} \{
215         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_dhe\_server\_key\_send(conn));
216     \}
217 
218     \textcolor{keywordflow}{return} 0;
219 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a940aed548236e016710e5ef69dc98df8_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+key\+\_\+recv@{s2n\+\_\+server\+\_\+key\+\_\+recv}}
\index{s2n\+\_\+server\+\_\+key\+\_\+recv@{s2n\+\_\+server\+\_\+key\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+key\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_key_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+key\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a933dc8cdaebb70f8a7364e390d9deeaf}{}\label{s2n__tls_8h_a933dc8cdaebb70f8a7364e390d9deeaf}


Definition at line 35 of file s2n\+\_\+server\+\_\+key\+\_\+exchange.\+c.


\begin{DoxyCode}
36 \{
37     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a5446cce0337d14b74b38f2a81ea19670}{cipher\_suite}->\hyperlink{structs2n__cipher__suite_aaf88ce0be23d983d21bbbecfce1c293d}{key\_exchange\_alg}->
      \hyperlink{structs2n__key__exchange__algorithm_a1e87af3c18a2fd36c61faf89949bdc3f}{flags} & \hyperlink{s2n__cipher__suites_8h_a12019f7e03ca6cbe2075ef675d5e5dec}{S2N\_KEY\_EXCHANGE\_ECC}) \{
38         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_ecdhe\_server\_key\_recv(conn));
39     \} \textcolor{keywordflow}{else} \{
40         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_dhe\_server\_key\_recv(conn));
41     \}
42 
43     \textcolor{keywordflow}{return} 0;
44 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a933dc8cdaebb70f8a7364e390d9deeaf_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+done\+\_\+send@{s2n\+\_\+server\+\_\+done\+\_\+send}}
\index{s2n\+\_\+server\+\_\+done\+\_\+send@{s2n\+\_\+server\+\_\+done\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+done\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_done_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+done\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a944852f699b2815f6a37b602113e26f7}{}\label{s2n__tls_8h_a944852f699b2815f6a37b602113e26f7}


Definition at line 34 of file s2n\+\_\+server\+\_\+done.\+c.


\begin{DoxyCode}
35 \{
36     \textcolor{keywordflow}{return} 0;
37 \}
\end{DoxyCode}
\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+done\+\_\+recv@{s2n\+\_\+server\+\_\+done\+\_\+recv}}
\index{s2n\+\_\+server\+\_\+done\+\_\+recv@{s2n\+\_\+server\+\_\+done\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+done\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_done_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+done\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a55414ad2a6f07ebbae51cbd0bf6f5974}{}\label{s2n__tls_8h_a55414ad2a6f07ebbae51cbd0bf6f5974}


Definition at line 25 of file s2n\+\_\+server\+\_\+done.\+c.


\begin{DoxyCode}
26 \{
27     \textcolor{keywordflow}{if} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io})) \{
28         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
29     \}
30 
31     \textcolor{keywordflow}{return} 0;
32 \}
\end{DoxyCode}
\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+client\+\_\+key\+\_\+send@{s2n\+\_\+client\+\_\+key\+\_\+send}}
\index{s2n\+\_\+client\+\_\+key\+\_\+send@{s2n\+\_\+client\+\_\+key\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+key\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_client_key_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+key\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a59294a875b6596b8dd5ad02a58e77c94}{}\label{s2n__tls_8h_a59294a875b6596b8dd5ad02a58e77c94}


Definition at line 224 of file s2n\+\_\+client\+\_\+key\+\_\+exchange.\+c.


\begin{DoxyCode}
225 \{
226     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a5446cce0337d14b74b38f2a81ea19670}{cipher\_suite}->\hyperlink{structs2n__cipher__suite_aaf88ce0be23d983d21bbbecfce1c293d}{key\_exchange\_alg}->
      \hyperlink{structs2n__key__exchange__algorithm_a1e87af3c18a2fd36c61faf89949bdc3f}{flags} & \hyperlink{s2n__cipher__suites_8h_af4ba4603e445c3767469486093d99598}{S2N\_KEY\_EXCHANGE\_DH}) \{
227         \textcolor{keywordflow}{return} s2n\_dhe\_client\_key\_send(conn);
228     \} \textcolor{keywordflow}{else} \{
229         \textcolor{keywordflow}{return} s2n\_rsa\_client\_key\_send(conn);
230     \}
231 \}
\end{DoxyCode}
\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+client\+\_\+key\+\_\+recv@{s2n\+\_\+client\+\_\+key\+\_\+recv}}
\index{s2n\+\_\+client\+\_\+key\+\_\+recv@{s2n\+\_\+client\+\_\+key\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+key\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_client_key_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+key\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a5d0b0b0a8964b40aff5e3562bf65a9e1}{}\label{s2n__tls_8h_a5d0b0b0a8964b40aff5e3562bf65a9e1}


Definition at line 127 of file s2n\+\_\+client\+\_\+key\+\_\+exchange.\+c.


\begin{DoxyCode}
128 \{
129     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a5446cce0337d14b74b38f2a81ea19670}{cipher\_suite}->\hyperlink{structs2n__cipher__suite_aaf88ce0be23d983d21bbbecfce1c293d}{key\_exchange\_alg}->
      \hyperlink{structs2n__key__exchange__algorithm_a1e87af3c18a2fd36c61faf89949bdc3f}{flags} & \hyperlink{s2n__cipher__suites_8h_af4ba4603e445c3767469486093d99598}{S2N\_KEY\_EXCHANGE\_DH}) \{
130         \textcolor{keywordflow}{return} s2n\_dhe\_client\_key\_recv(conn);
131     \} \textcolor{keywordflow}{else} \{
132         \textcolor{keywordflow}{return} \hyperlink{s2n__server__fuzz__test__overrides_8c_a4894ba367df6cc84ab8907adde93178c}{s2n\_rsa\_client\_key\_recv}(conn);
133     \}
134 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a5d0b0b0a8964b40aff5e3562bf65a9e1_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+client\+\_\+ccs\+\_\+send@{s2n\+\_\+client\+\_\+ccs\+\_\+send}}
\index{s2n\+\_\+client\+\_\+ccs\+\_\+send@{s2n\+\_\+client\+\_\+ccs\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+ccs\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_client_ccs_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+ccs\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a9be1791dfd4b0af9525be21fb52ec4eb}{}\label{s2n__tls_8h_a9be1791dfd4b0af9525be21fb52ec4eb}


Definition at line 54 of file s2n\+\_\+client\+\_\+ccs.\+c.


\begin{DoxyCode}
55 \{
56     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, \hyperlink{s2n__client__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}{CHANGE\_CIPHER\_SPEC\_TYPE}));
57 
58     \textcolor{keywordflow}{return} 0;
59 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a9be1791dfd4b0af9525be21fb52ec4eb_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+client\+\_\+ccs\+\_\+recv@{s2n\+\_\+client\+\_\+ccs\+\_\+recv}}
\index{s2n\+\_\+client\+\_\+ccs\+\_\+recv@{s2n\+\_\+client\+\_\+ccs\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+ccs\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_client_ccs_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+ccs\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_aab9d53a394720e55e7648730f94bb176}{}\label{s2n__tls_8h_aab9d53a394720e55e7648730f94bb176}


Definition at line 31 of file s2n\+\_\+client\+\_\+ccs.\+c.


\begin{DoxyCode}
32 \{
33     uint8\_t \hyperlink{crypto_2x509_2x509_8h_ab512b8f495325c7ea0f5a5a5d3f938eb}{type};
34 
35     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a809931120983e64ed6602dbac2b9b1fc}{s2n\_prf\_client\_finished}(conn));
36 
37     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} seq = \{.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_ab7767b5b58441b15ac1028ac18b06ef1}{client\_sequence\_number},.size = \textcolor{keyword}{sizeof}(conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_ab7767b5b58441b15ac1028ac18b06ef1}{client\_sequence\_number}) \};
38     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__blob_8c_a241c17ca2593704ff88734d13659a877}{s2n\_blob\_zero}(&seq));
39 
40     \textcolor{comment}{/* Update the client to use the cipher-suite */}
41     conn->\hyperlink{structs2n__connection_a052f81d7dc7e2612341fe0da1e749ebd}{client} = &conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure};
42 
43     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, &type));
44     \textcolor{keywordflow}{if} (type != \hyperlink{s2n__client__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}{CHANGE\_CIPHER\_SPEC\_TYPE}) \{
45         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
46     \}
47 
48     \textcolor{comment}{/* Flush any partial alert messages that were pending */}
49     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a2b6b54f7856d92f06f823bc26d10f4ba}{s2n\_stuffer\_wipe}(&conn->\hyperlink{structs2n__connection_a628dd7fe79c7cfd5f7bc02da8a270752}{alert\_in}));
50 
51     \textcolor{keywordflow}{return} 0;
52 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_aab9d53a394720e55e7648730f94bb176_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+ccs\+\_\+send@{s2n\+\_\+server\+\_\+ccs\+\_\+send}}
\index{s2n\+\_\+server\+\_\+ccs\+\_\+send@{s2n\+\_\+server\+\_\+ccs\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+ccs\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_ccs_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+ccs\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_ad4c716e8d39e6bb93acba86ccda02554}{}\label{s2n__tls_8h_ad4c716e8d39e6bb93acba86ccda02554}


Definition at line 59 of file s2n\+\_\+server\+\_\+ccs.\+c.


\begin{DoxyCode}
60 \{
61     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, \hyperlink{s2n__server__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}{CHANGE\_CIPHER\_SPEC\_TYPE}));
62 
63     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a8b8974068a8f2c38a061ffb495a5ca1c}{handshake\_type} == RESUME) \{
64         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a1425bb608ed69a0cc582af0a57955e1f}{s2n\_prf\_key\_expansion}(conn));
65     \}
66 
67     \textcolor{keywordflow}{return} 0;
68 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_ad4c716e8d39e6bb93acba86ccda02554_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+ccs\+\_\+recv@{s2n\+\_\+server\+\_\+ccs\+\_\+recv}}
\index{s2n\+\_\+server\+\_\+ccs\+\_\+recv@{s2n\+\_\+server\+\_\+ccs\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+ccs\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_ccs_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+ccs\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_ae06266c2514a2576c570f3f01d9f9ecf}{}\label{s2n__tls_8h_ae06266c2514a2576c570f3f01d9f9ecf}


Definition at line 30 of file s2n\+\_\+server\+\_\+ccs.\+c.


\begin{DoxyCode}
31 \{
32     uint8\_t \hyperlink{crypto_2x509_2x509_8h_ab512b8f495325c7ea0f5a5a5d3f938eb}{type};
33 
34     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, &type));
35     \textcolor{keywordflow}{if} (type != \hyperlink{s2n__server__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}{CHANGE\_CIPHER\_SPEC\_TYPE}) \{
36         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
37     \}
38 
39     \textcolor{comment}{/* Zero the sequence number */}
40     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} seq = \{.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_a286710aff413808336b2f294554c7e55}{server\_sequence\_number},.size = \hyperlink{tls_2s2n__crypto_8h_ab6af529d3a237c0d8d2f67edcf831c25}{S2N\_TLS\_SEQUENCE\_NUM\_LEN} \};
41     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__blob_8c_a241c17ca2593704ff88734d13659a877}{s2n\_blob\_zero}(&seq));
42 
43     \textcolor{comment}{/* Compute the finished message */}
44     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a4d977ca107f8b2ac76823eb6281ca69b}{s2n\_prf\_server\_finished}(conn));
45 
46     \textcolor{comment}{/* Update the secure state to active, and point the client at the active state */}
47     conn->\hyperlink{structs2n__connection_abfab1f3796089e3576e73286c0b6889c}{server} = &conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure};
48 
49     \textcolor{comment}{/* Flush any partial alert messages that were pending */}
50     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a2b6b54f7856d92f06f823bc26d10f4ba}{s2n\_stuffer\_wipe}(&conn->\hyperlink{structs2n__connection_a628dd7fe79c7cfd5f7bc02da8a270752}{alert\_in}));
51 
52     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a8b8974068a8f2c38a061ffb495a5ca1c}{handshake\_type} == RESUME) \{
53         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a1425bb608ed69a0cc582af0a57955e1f}{s2n\_prf\_key\_expansion}(conn));
54     \}
55 
56     \textcolor{keywordflow}{return} 0;
57 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_ae06266c2514a2576c570f3f01d9f9ecf_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+client\+\_\+finished\+\_\+send@{s2n\+\_\+client\+\_\+finished\+\_\+send}}
\index{s2n\+\_\+client\+\_\+finished\+\_\+send@{s2n\+\_\+client\+\_\+finished\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+finished\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_client_finished_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+finished\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_ac384b39fb82314ba9d3d4aebbae8f0e3}{}\label{s2n__tls_8h_ac384b39fb82314ba9d3d4aebbae8f0e3}


Definition at line 42 of file s2n\+\_\+client\+\_\+finished.\+c.


\begin{DoxyCode}
43 \{
44     uint8\_t *our\_version;
45 
46     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a809931120983e64ed6602dbac2b9b1fc}{s2n\_prf\_client\_finished}(conn));
47 
48     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} seq = \{.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_ab7767b5b58441b15ac1028ac18b06ef1}{client\_sequence\_number},.size = \textcolor{keyword}{sizeof}(conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_ab7767b5b58441b15ac1028ac18b06ef1}{client\_sequence\_number}) \};
49     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__blob_8c_a241c17ca2593704ff88734d13659a877}{s2n\_blob\_zero}(&seq));
50     our\_version = conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a2855df54edee8fcbca0272bfa74784ca}{client\_finished};
51 
52     \textcolor{comment}{/* Update the server to use the cipher suite */}
53     conn->\hyperlink{structs2n__connection_a052f81d7dc7e2612341fe0da1e749ebd}{client} = &conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure};
54 
55     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} == \hyperlink{s2n_8h_a457805749bd152786e9e344a5b22ab67}{S2N\_SSLv3}) \{
56         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, our\_version, \hyperlink{tls_2s2n__crypto_8h_a687b2e6f366133714257fc7e9d6537bd}{S2N\_SSL\_FINISHED\_LEN}));
57     \} \textcolor{keywordflow}{else} \{
58         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, our\_version, \hyperlink{tls_2s2n__crypto_8h_a325fdff46d03553d7962ab1a878bcec1}{S2N\_TLS\_FINISHED\_LEN}));
59     \}
60 
61     \textcolor{keywordflow}{return} 0;
62 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_ac384b39fb82314ba9d3d4aebbae8f0e3_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+client\+\_\+finished\+\_\+recv@{s2n\+\_\+client\+\_\+finished\+\_\+recv}}
\index{s2n\+\_\+client\+\_\+finished\+\_\+recv@{s2n\+\_\+client\+\_\+finished\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+finished\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_client_finished_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+finished\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a1e5af2e3c7ad308eb7a32333210875f5}{}\label{s2n__tls_8h_a1e5af2e3c7ad308eb7a32333210875f5}


Definition at line 27 of file s2n\+\_\+client\+\_\+finished.\+c.


\begin{DoxyCode}
28 \{
29     uint8\_t *our\_version;
30 
31     our\_version = conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a2855df54edee8fcbca0272bfa74784ca}{client\_finished};
32     uint8\_t *their\_version = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, \hyperlink{tls_2s2n__crypto_8h_a325fdff46d03553d7962ab1a878bcec1}{S2N\_TLS\_FINISHED\_LEN});
33     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(their\_version);
34 
35     \textcolor{keywordflow}{if} (!\hyperlink{s2n__server__fuzz__test__overrides_8c_a407f3056ab784369c0ccb3359532669a}{s2n\_constant\_time\_equals}(our\_version, their\_version, 
      \hyperlink{tls_2s2n__crypto_8h_a325fdff46d03553d7962ab1a878bcec1}{S2N\_TLS\_FINISHED\_LEN}) || conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a65e2d8c6247963b90c9c2e3d574b0319}{rsa\_failed}) \{
36         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
37     \}
38 
39     \textcolor{keywordflow}{return} 0;
40 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a1e5af2e3c7ad308eb7a32333210875f5_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+finished\+\_\+send@{s2n\+\_\+server\+\_\+finished\+\_\+send}}
\index{s2n\+\_\+server\+\_\+finished\+\_\+send@{s2n\+\_\+server\+\_\+finished\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+finished\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_finished_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+finished\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a1faebdea4c42a7b27ce347885b9bd9ee}{}\label{s2n__tls_8h_a1faebdea4c42a7b27ce347885b9bd9ee}


Definition at line 48 of file s2n\+\_\+server\+\_\+finished.\+c.


\begin{DoxyCode}
49 \{
50     uint8\_t *our\_version;
51     \textcolor{keywordtype}{int} \hyperlink{crypto_2asn1_2asn1_8h_a5a2d57a92488e64c730cabc247c9d5b5}{length} = \hyperlink{tls_2s2n__crypto_8h_a325fdff46d03553d7962ab1a878bcec1}{S2N\_TLS\_FINISHED\_LEN};
52 
53     \textcolor{comment}{/* Compute the finished message */}
54     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a4d977ca107f8b2ac76823eb6281ca69b}{s2n\_prf\_server\_finished}(conn));
55 
56     our\_version = conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a93637661124329bd2a8b9110e00c6766}{server\_finished};
57 
58     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} == \hyperlink{s2n_8h_a457805749bd152786e9e344a5b22ab67}{S2N\_SSLv3}) \{
59         length = \hyperlink{tls_2s2n__crypto_8h_a687b2e6f366133714257fc7e9d6537bd}{S2N\_SSL\_FINISHED\_LEN};
60     \}
61 
62     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, our\_version, length));
63 
64     \textcolor{comment}{/* Zero the sequence number */}
65     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} seq = \{.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_a286710aff413808336b2f294554c7e55}{server\_sequence\_number},.size = \hyperlink{tls_2s2n__crypto_8h_ab6af529d3a237c0d8d2f67edcf831c25}{S2N\_TLS\_SEQUENCE\_NUM\_LEN} \};
66     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__blob_8c_a241c17ca2593704ff88734d13659a877}{s2n\_blob\_zero}(&seq));
67 
68     \textcolor{comment}{/* Update the secure state to active, and point the client at the active state */}
69     conn->\hyperlink{structs2n__connection_abfab1f3796089e3576e73286c0b6889c}{server} = &conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure};
70 
71     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a8b8974068a8f2c38a061ffb495a5ca1c}{handshake\_type} == RESUME) \{
72         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a1425bb608ed69a0cc582af0a57955e1f}{s2n\_prf\_key\_expansion}(conn));
73     \}
74 
75     \textcolor{keywordflow}{return} 0;
76 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a1faebdea4c42a7b27ce347885b9bd9ee_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+finished\+\_\+recv@{s2n\+\_\+server\+\_\+finished\+\_\+recv}}
\index{s2n\+\_\+server\+\_\+finished\+\_\+recv@{s2n\+\_\+server\+\_\+finished\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+finished\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_finished_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+finished\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_adae4d52456ffeb3a606ed1fb545539e4}{}\label{s2n__tls_8h_adae4d52456ffeb3a606ed1fb545539e4}


Definition at line 28 of file s2n\+\_\+server\+\_\+finished.\+c.


\begin{DoxyCode}
29 \{
30     uint8\_t *our\_version;
31     \textcolor{keywordtype}{int} \hyperlink{crypto_2asn1_2asn1_8h_a5a2d57a92488e64c730cabc247c9d5b5}{length} = \hyperlink{tls_2s2n__crypto_8h_a325fdff46d03553d7962ab1a878bcec1}{S2N\_TLS\_FINISHED\_LEN};
32     our\_version = conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a93637661124329bd2a8b9110e00c6766}{server\_finished};
33 
34     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} == \hyperlink{s2n_8h_a457805749bd152786e9e344a5b22ab67}{S2N\_SSLv3}) \{
35         length = \hyperlink{tls_2s2n__crypto_8h_a687b2e6f366133714257fc7e9d6537bd}{S2N\_SSL\_FINISHED\_LEN};
36     \}
37 
38     uint8\_t *their\_version = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, length);
39     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(their\_version);
40 
41     \textcolor{keywordflow}{if} (!\hyperlink{s2n__server__fuzz__test__overrides_8c_a407f3056ab784369c0ccb3359532669a}{s2n\_constant\_time\_equals}(our\_version, their\_version, length)) \{
42         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
43     \}
44 
45     \textcolor{keywordflow}{return} 0;
46 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_adae4d52456ffeb3a606ed1fb545539e4_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+handshake\+\_\+write\+\_\+header@{s2n\+\_\+handshake\+\_\+write\+\_\+header}}
\index{s2n\+\_\+handshake\+\_\+write\+\_\+header@{s2n\+\_\+handshake\+\_\+write\+\_\+header}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+handshake\+\_\+write\+\_\+header(struct s2n\+\_\+connection $\ast$conn, uint8\+\_\+t message\+\_\+type)}{s2n_handshake_write_header(struct s2n_connection *conn, uint8_t message_type)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+handshake\+\_\+write\+\_\+header (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn, }
\item[{uint8\+\_\+t}]{message\+\_\+type}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97}{}\label{s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97}


Definition at line 27 of file s2n\+\_\+handshake.\+c.


\begin{DoxyCode}
28 \{
29     \textcolor{keywordflow}{if} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io})) \{
30         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ae948d942ad6d03abc85d9f90cfae3d45}{S2N\_ERR\_HANDSHAKE\_STATE});
31     \}
32 
33     \textcolor{comment}{/* Write the message header */}
34     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, message\_type));
35 
36     \textcolor{comment}{/* Leave the length blank for now */}
37     uint16\_t \hyperlink{crypto_2asn1_2asn1_8h_a5a2d57a92488e64c730cabc247c9d5b5}{length} = 0;
38     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aa78701a9bb01def1efcbfa30ba0bdfc9}{s2n\_stuffer\_write\_uint24}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, length));
39 
40     \textcolor{keywordflow}{return} 0;
41 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97_icgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+handshake\+\_\+finish\+\_\+header@{s2n\+\_\+handshake\+\_\+finish\+\_\+header}}
\index{s2n\+\_\+handshake\+\_\+finish\+\_\+header@{s2n\+\_\+handshake\+\_\+finish\+\_\+header}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+handshake\+\_\+finish\+\_\+header(struct s2n\+\_\+connection $\ast$conn)}{s2n_handshake_finish_header(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+handshake\+\_\+finish\+\_\+header (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a}{}\label{s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a}


Definition at line 43 of file s2n\+\_\+handshake.\+c.


\begin{DoxyCode}
44 \{
45     uint16\_t \hyperlink{crypto_2asn1_2asn1_8h_a5a2d57a92488e64c730cabc247c9d5b5}{length} = \hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io});
46     \textcolor{keywordflow}{if} (length < \hyperlink{s2n__tls__parameters_8h_a13c46676240c1573c5304f8038d30279}{TLS\_HANDSHAKE\_HEADER\_LENGTH}) \{
47         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374a602cb5165e354dd39c49af50bbbc1cb9}{S2N\_ERR\_SIZE\_MISMATCH});
48     \}
49 
50     uint16\_t payload = length - \hyperlink{s2n__tls__parameters_8h_a13c46676240c1573c5304f8038d30279}{TLS\_HANDSHAKE\_HEADER\_LENGTH};
51 
52     \textcolor{comment}{/* Write the message header */}
53     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ae1b97eb16ae517a82ec90a0e2b8c48e7}{s2n\_stuffer\_rewrite}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}));
54     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a7ef8f252a4b5b3d0bb793e1906d1b876}{s2n\_stuffer\_skip\_write}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, 1));
55     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aa78701a9bb01def1efcbfa30ba0bdfc9}{s2n\_stuffer\_write\_uint24}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, payload));
56     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a7ef8f252a4b5b3d0bb793e1906d1b876}{s2n\_stuffer\_skip\_write}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, payload));
57 
58     \textcolor{keywordflow}{return} 0;
59 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a_icgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+handshake\+\_\+parse\+\_\+header@{s2n\+\_\+handshake\+\_\+parse\+\_\+header}}
\index{s2n\+\_\+handshake\+\_\+parse\+\_\+header@{s2n\+\_\+handshake\+\_\+parse\+\_\+header}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+handshake\+\_\+parse\+\_\+header(struct s2n\+\_\+connection $\ast$conn, uint8\+\_\+t $\ast$message\+\_\+type, uint32\+\_\+t $\ast$length)}{s2n_handshake_parse_header(struct s2n_connection *conn, uint8_t *message_type, uint32_t *length)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+handshake\+\_\+parse\+\_\+header (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn, }
\item[{uint8\+\_\+t $\ast$}]{message\+\_\+type, }
\item[{uint32\+\_\+t $\ast$}]{length}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42}{}\label{s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42}


Definition at line 61 of file s2n\+\_\+handshake.\+c.


\begin{DoxyCode}
62 \{
63     \textcolor{keywordflow}{if} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}) < \hyperlink{s2n__tls__parameters_8h_a13c46676240c1573c5304f8038d30279}{TLS\_HANDSHAKE\_HEADER\_LENGTH}) \{
64         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374a602cb5165e354dd39c49af50bbbc1cb9}{S2N\_ERR\_SIZE\_MISMATCH});
65     \}
66 
67     \textcolor{comment}{/* read the message header */}
68     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, message\_type));
69     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a71787bb6eeba3413137cde42d32a0f6c}{s2n\_stuffer\_read\_uint24}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, \hyperlink{crypto_2asn1_2asn1_8h_a5a2d57a92488e64c730cabc247c9d5b5}{length}));
70 
71     \textcolor{keywordflow}{return} 0;
72 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42_icgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+read\+\_\+full\+\_\+record@{s2n\+\_\+read\+\_\+full\+\_\+record}}
\index{s2n\+\_\+read\+\_\+full\+\_\+record@{s2n\+\_\+read\+\_\+full\+\_\+record}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+read\+\_\+full\+\_\+record(struct s2n\+\_\+connection $\ast$conn, uint8\+\_\+t $\ast$record\+\_\+type, int $\ast$is\+S\+S\+Lv2)}{s2n_read_full_record(struct s2n_connection *conn, uint8_t *record_type, int *isSSLv2)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+read\+\_\+full\+\_\+record (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn, }
\item[{uint8\+\_\+t $\ast$}]{record\+\_\+type, }
\item[{int $\ast$}]{is\+S\+S\+Lv2}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113}{}\label{s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113}


Definition at line 39 of file s2n\+\_\+recv.\+c.


\begin{DoxyCode}
40 \{
41     \textcolor{keywordtype}{int} r;
42 
43     *isSSLv2 = 0;
44 
45     \textcolor{comment}{/* If the record has already been decrypted, then leave it alone */}
46     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_ad63a0cc0cc12429207575e5d093f59d2}{in\_status} == PLAINTEXT) \{
47         \textcolor{comment}{/* Only application data packets count as plaintext */}
48         *record\_type = \hyperlink{s2n__tls__parameters_8h_a5104f80ba38ebfd2266b1ec313f0aeb2}{TLS\_APPLICATION\_DATA};
49         \textcolor{keywordflow}{return} 0;
50     \}
51 
52     \textcolor{comment}{/* Read the record until we at least have a header */}
53     \textcolor{keywordflow}{while} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->\hyperlink{structs2n__connection_a005c1df7387f2c53061e9c9432f70aca}{header\_in}) < 
      \hyperlink{s2n__tls__parameters_8h_a7cc7782f30cb9ee302929d979826c557}{S2N\_TLS\_RECORD\_HEADER\_LENGTH}) \{
54         r = \hyperlink{s2n__stuffer_8h_a19fe623439e89aeadbac10e98b7a8896}{s2n\_stuffer\_recv\_from\_fd}(&conn->\hyperlink{structs2n__connection_a005c1df7387f2c53061e9c9432f70aca}{header\_in}, conn->
      \hyperlink{structs2n__connection_ab8b1e66f9a7b17fa4541b1733b87e011}{readfd}, \hyperlink{s2n__tls__parameters_8h_a7cc7782f30cb9ee302929d979826c557}{S2N\_TLS\_RECORD\_HEADER\_LENGTH} - 
      \hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->\hyperlink{structs2n__connection_a005c1df7387f2c53061e9c9432f70aca}{header\_in}));
55         \textcolor{keywordflow}{if} (r == 0) \{
56             conn->\hyperlink{structs2n__connection_a9e746c5b2dde4a77b710780924853c2f}{closed} = 1;
57             \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ab2b3c63db9e35ed79c3191161b6c9ccc}{S2N\_ERR\_CLOSED});
58         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (r < 0) \{
59             \textcolor{keywordflow}{if} (\hyperlink{_mac_socket_8cpp_ad65a8842cc674e3ddf69355898c0ecbf}{errno} == EWOULDBLOCK) \{
60                 \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374a440a0e3a40ff1c680a455803a9dd9dfc}{S2N\_ERR\_BLOCKED});
61             \}
62             \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ae8ab0b843d6f8172ea5f923aaf083374}{S2N\_ERR\_IO});
63         \}
64         conn->\hyperlink{structs2n__connection_ae40976768561ff646c1b9badadcd4f4e}{wire\_bytes\_in} += r;
65     \}
66     uint16\_t fragment\_length;
67 
68     \textcolor{comment}{/* If the first bit is set then this is an SSLv2 record */}
69     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a005c1df7387f2c53061e9c9432f70aca}{header\_in}.\hyperlink{structs2n__stuffer_ab95f00f583f1cb41ae00918e9ea180c9}{blob}.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}[0] & 0x80) \{
70         conn->\hyperlink{structs2n__connection_a005c1df7387f2c53061e9c9432f70aca}{header\_in}.\hyperlink{structs2n__stuffer_ab95f00f583f1cb41ae00918e9ea180c9}{blob}.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}[0] &= 0x7f;
71         *isSSLv2 = 1;
72 
73         \textcolor{keywordflow}{if} (\hyperlink{s2n__record_8h_ada746040b578344a72196d5dd1d356fd}{s2n\_sslv2\_record\_header\_parse}(conn, record\_type, &conn->
      \hyperlink{structs2n__connection_a29289057caf9ad21e99bd972da14acc3}{client\_protocol\_version}, &fragment\_length) < 0) \{
74             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__connection_8c_a746324b4543d50af7ebedc3ed91fbc57}{s2n\_connection\_kill}(conn));
75             \textcolor{keywordflow}{return} -1;
76         \}
77     \} \textcolor{keywordflow}{else} \{
78         \textcolor{keywordflow}{if} (\hyperlink{s2n__record_8h_af0794788139e3e2975022dd47f983eda}{s2n\_record\_header\_parse}(conn, record\_type, &fragment\_length) < 0) \{
79             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__connection_8c_a746324b4543d50af7ebedc3ed91fbc57}{s2n\_connection\_kill}(conn));
80             \textcolor{keywordflow}{return} -1;
81         \}
82     \}
83 
84     \textcolor{comment}{/* Read enough to have the whole record */}
85     \textcolor{keywordflow}{while} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->\hyperlink{structs2n__connection_a556c2665a42d6fd91dd28fc73d50d21e}{in}) < fragment\_length) \{
86         r = \hyperlink{s2n__stuffer_8h_a19fe623439e89aeadbac10e98b7a8896}{s2n\_stuffer\_recv\_from\_fd}(&conn->\hyperlink{structs2n__connection_a556c2665a42d6fd91dd28fc73d50d21e}{in}, conn->
      \hyperlink{structs2n__connection_ab8b1e66f9a7b17fa4541b1733b87e011}{readfd}, fragment\_length - \hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&conn->
      \hyperlink{structs2n__connection_a556c2665a42d6fd91dd28fc73d50d21e}{in}));
87         \textcolor{keywordflow}{if} (r == 0) \{
88             conn->\hyperlink{structs2n__connection_a9e746c5b2dde4a77b710780924853c2f}{closed} = 1;
89             \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ab2b3c63db9e35ed79c3191161b6c9ccc}{S2N\_ERR\_CLOSED});
90         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (r < 0) \{
91             \textcolor{keywordflow}{if} (\hyperlink{_mac_socket_8cpp_ad65a8842cc674e3ddf69355898c0ecbf}{errno} == EWOULDBLOCK) \{
92                 \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374a440a0e3a40ff1c680a455803a9dd9dfc}{S2N\_ERR\_BLOCKED});
93             \}
94             \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ae8ab0b843d6f8172ea5f923aaf083374}{S2N\_ERR\_IO});
95         \}
96         conn->\hyperlink{structs2n__connection_ae40976768561ff646c1b9badadcd4f4e}{wire\_bytes\_in} += r;
97     \}
98 
99     \textcolor{keywordflow}{if} (*isSSLv2) \{
100         \textcolor{keywordflow}{return} 0;
101     \}
102 
103     \textcolor{comment}{/* Decrypt and parse the record */}
104     \textcolor{keywordflow}{if} (\hyperlink{s2n__record_8h_a26b47800a66fc8e167d92b302e0b7079}{s2n\_record\_parse}(conn) < 0) \{
105         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__connection_8c_a746324b4543d50af7ebedc3ed91fbc57}{s2n\_connection\_kill}(conn));
106 
107         \textcolor{keywordflow}{return} -1;
108     \}
109 
110     \textcolor{keywordflow}{return} 0;
111 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113_icgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+recv\+\_\+close\+\_\+notify@{s2n\+\_\+recv\+\_\+close\+\_\+notify}}
\index{s2n\+\_\+recv\+\_\+close\+\_\+notify@{s2n\+\_\+recv\+\_\+close\+\_\+notify}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+recv\+\_\+close\+\_\+notify(struct s2n\+\_\+connection $\ast$conn, s2n\+\_\+blocked\+\_\+status $\ast$blocked)}{s2n_recv_close_notify(struct s2n_connection *conn, s2n_blocked_status *blocked)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+recv\+\_\+close\+\_\+notify (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn, }
\item[{{\bf s2n\+\_\+blocked\+\_\+status} $\ast$}]{blocked}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8}{}\label{s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8}


Definition at line 198 of file s2n\+\_\+recv.\+c.


\begin{DoxyCode}
199 \{
200     uint8\_t record\_type;
201     \textcolor{keywordtype}{int} isSSLv2;
202     *blocked = \hyperlink{s2n_8h_af70ca0b089daa98cd79a424d3f6af15daf76a7c83e9548139b7b8d50bdd5ff323}{S2N\_BLOCKED\_ON\_READ};
203 
204     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__recv_8c_a807adeb1baad4849f782cfd4de10d113}{s2n\_read\_full\_record}(conn, &record\_type, &isSSLv2));
205 
206     \textcolor{keywordflow}{if} (isSSLv2) \{
207         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
208     \}
209 
210     \textcolor{keywordflow}{if} (record\_type != \hyperlink{s2n__fragmentation__coalescing__test_8c_afe02a145f0d3a71b14d61e2774987f9d}{TLS\_ALERT}) \{
211         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374aecb2193808a40bc03ee82cbb232caa68}{S2N\_ERR\_SHUTDOWN\_RECORD\_TYPE});
212     \}
213 
214     \textcolor{comment}{/* Only succeds for an incoming close\_notify alert */}
215     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__alerts_8c_a45bdea2fd7faa208c0272f56bfb8c656}{s2n\_process\_alert\_fragment}(conn));
216 
217     *blocked = \hyperlink{s2n_8h_af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd}{S2N\_NOT\_BLOCKED};
218     \textcolor{keywordflow}{return} 0;
219 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8_icgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+client\+\_\+extensions\+\_\+send@{s2n\+\_\+client\+\_\+extensions\+\_\+send}}
\index{s2n\+\_\+client\+\_\+extensions\+\_\+send@{s2n\+\_\+client\+\_\+extensions\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+extensions\+\_\+send(struct s2n\+\_\+connection $\ast$conn, struct s2n\+\_\+stuffer $\ast$out)}{s2n_client_extensions_send(struct s2n_connection *conn, struct s2n_stuffer *out)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+extensions\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn, }
\item[{struct {\bf s2n\+\_\+stuffer} $\ast$}]{out}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8}{}\label{s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8}


Definition at line 37 of file s2n\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
38 \{
39     uint16\_t total\_size = 0;
40 
41     \textcolor{comment}{/* Signature algorithms */}
42     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} == \hyperlink{s2n_8h_ab17e84046986d49ffd31571b8d32d24e}{S2N\_TLS12}) \{
43         total\_size += 8;
44     \}
45 
46     uint16\_t application\_protocols\_len = conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->
      \hyperlink{structs2n__config_a45182f90f146494a0f2dc4c962bbba0e}{application\_protocols}.\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size};
47     uint16\_t server\_name\_len = strlen(conn->\hyperlink{structs2n__connection_aaeec7205ccf6834a5eaf18d9a5eb8936}{server\_name});
48 
49     \textcolor{keywordflow}{if} (server\_name\_len) \{
50         total\_size += 9 + server\_name\_len;
51     \}
52     \textcolor{keywordflow}{if} (application\_protocols\_len) \{
53         total\_size += 6 + application\_protocols\_len;
54     \}
55     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->\hyperlink{structs2n__config_aa6c7e4f4cf13d4d133b66760cf0d09fa}{status\_request\_type} != 
      \hyperlink{s2n_8h_a7d38e45340d223d0100a2d4bc0526635aea0f05b257857adc1282f77c5414e35a}{S2N\_STATUS\_REQUEST\_NONE}) \{
56         total\_size += 9;
57     \}
58 
59     \textcolor{comment}{/* Write ECC extensions: Supported Curves and Supported Point Formats */}
60     \textcolor{keywordtype}{int} ec\_curves\_count = \textcolor{keyword}{sizeof}(\hyperlink{s2n__ecc_8c_a27f438af5123167d9e831390707be2a0}{s2n\_ecc\_supported\_curves}) / \textcolor{keyword}{sizeof}(
      \hyperlink{s2n__ecc_8c_a27f438af5123167d9e831390707be2a0}{s2n\_ecc\_supported\_curves}[0]);
61     total\_size += 12 + ec\_curves\_count * 2;
62 
63     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, total\_size));
64 
65     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} == \hyperlink{s2n_8h_ab17e84046986d49ffd31571b8d32d24e}{S2N\_TLS12}) \{
66         \textcolor{comment}{/* The extension header */}
67         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 
      \hyperlink{s2n__tls__parameters_8h_a2df8cf476badc3a52f44d65caad71734}{TLS\_EXTENSION\_SIGNATURE\_ALGORITHMS}));
68         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 4));
69 
70         \textcolor{comment}{/* Just one signature/hash pair, so 2 bytes */}
71         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 2));
72         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, 
      \hyperlink{s2n__tls__parameters_8h_ab079d73832dc62bda962af8b28f13a1b}{TLS\_HASH\_ALGORITHM\_SHA1}));
73         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, 
      \hyperlink{s2n__tls__parameters_8h_a28638d3ef91538f8a4ba9ba4c3d7cdca}{TLS\_SIGNATURE\_ALGORITHM\_RSA}));
74     \}
75 
76     \textcolor{keywordflow}{if} (server\_name\_len) \{
77         \textcolor{comment}{/* Write the server name */}
78         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 
      \hyperlink{s2n__tls__parameters_8h_ac5af336fe762b24789dde11d13a74035}{TLS\_EXTENSION\_SERVER\_NAME}));
79         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, server\_name\_len + 5));
80 
81         \textcolor{comment}{/* Size of all of the server names */}
82         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, server\_name\_len + 3));
83 
84         \textcolor{comment}{/* Name type - host name, RFC3546 */}
85         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, 0));
86 
87         \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} server\_name;
88         server\_name.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = (uint8\_t *) conn->\hyperlink{structs2n__connection_aaeec7205ccf6834a5eaf18d9a5eb8936}{server\_name};
89         server\_name.size = server\_name\_len;
90         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, server\_name\_len));
91         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ad77ea23089bbeb19b897a73bf6ca3fde}{s2n\_stuffer\_write}(out, &server\_name));
92     \}
93 
94     \textcolor{comment}{/* Write ALPN extension */}
95     \textcolor{keywordflow}{if} (application\_protocols\_len) \{
96         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 
      \hyperlink{s2n__tls__parameters_8h_a753973f1e9b19bde89de02430b355128}{TLS\_EXTENSION\_ALPN}));
97         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, application\_protocols\_len + 2));
98         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, application\_protocols\_len));
99         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ad77ea23089bbeb19b897a73bf6ca3fde}{s2n\_stuffer\_write}(out, &conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->
      \hyperlink{structs2n__config_a45182f90f146494a0f2dc4c962bbba0e}{application\_protocols}));
100     \}
101 
102     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->\hyperlink{structs2n__config_aa6c7e4f4cf13d4d133b66760cf0d09fa}{status\_request\_type} != 
      \hyperlink{s2n_8h_a7d38e45340d223d0100a2d4bc0526635aea0f05b257857adc1282f77c5414e35a}{S2N\_STATUS\_REQUEST\_NONE}) \{
103         \textcolor{comment}{/* We only support OCSP */}
104         \hyperlink{s2n__safety_8h_a286ad9b0d46f4af176671cda1ed6f58a}{eq\_check}(conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->\hyperlink{structs2n__config_aa6c7e4f4cf13d4d133b66760cf0d09fa}{status\_request\_type}, 
      \hyperlink{s2n_8h_a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8}{S2N\_STATUS\_REQUEST\_OCSP});
105         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 
      \hyperlink{s2n__tls__parameters_8h_acf3d575671ffd01a1400417f16520421}{TLS\_EXTENSION\_STATUS\_REQUEST}));
106         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 5));
107         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, (uint8\_t) conn->
      \hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}->\hyperlink{structs2n__config_aa6c7e4f4cf13d4d133b66760cf0d09fa}{status\_request\_type}));
108         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 0));
109         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 0));
110     \}
111 
112     \textcolor{comment}{/*}
113 \textcolor{comment}{     * RFC 4492: Clients SHOULD send both the Supported Elliptic Curves Extension}
114 \textcolor{comment}{     * and the Supported Point Formats Extension.}
115 \textcolor{comment}{     */}
116     \{
117         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 
      \hyperlink{s2n__tls__parameters_8h_a0b8dde07daa13a017697a6218c34b11c}{TLS\_EXTENSION\_ELLIPTIC\_CURVES}));
118         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 2 + ec\_curves\_count * 2));
119         \textcolor{comment}{/* Curve list len */}
120         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, ec\_curves\_count * 2));
121         \textcolor{comment}{/* Curve list */}
122         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < ec\_curves\_count; i++) \{
123             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 
      \hyperlink{s2n__ecc_8c_a27f438af5123167d9e831390707be2a0}{s2n\_ecc\_supported\_curves}[i].iana\_id));
124         \}
125 
126         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 
      \hyperlink{s2n__tls__parameters_8h_a350023b90c4e7b5de523b149308440d7}{TLS\_EXTENSION\_EC\_POINT\_FORMATS}));
127         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 2));
128         \textcolor{comment}{/* Point format list len */}
129         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, 1));
130         \textcolor{comment}{/* Only allow uncompressed format */}
131         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, 0));
132     \}
133 
134     \textcolor{keywordflow}{return} 0;
135 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8_icgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+client\+\_\+extensions\+\_\+recv@{s2n\+\_\+client\+\_\+extensions\+\_\+recv}}
\index{s2n\+\_\+client\+\_\+extensions\+\_\+recv@{s2n\+\_\+client\+\_\+extensions\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+extensions\+\_\+recv(struct s2n\+\_\+connection $\ast$conn, struct s2n\+\_\+blob $\ast$extensions)}{s2n_client_extensions_recv(struct s2n_connection *conn, struct s2n_blob *extensions)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+extensions\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn, }
\item[{struct {\bf s2n\+\_\+blob} $\ast$}]{extensions}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63}{}\label{s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63}


Definition at line 137 of file s2n\+\_\+client\+\_\+extensions.\+c.


\begin{DoxyCode}
138 \{
139     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} in;
140 
141     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_af556836db8ed75fdb89af3d418fab2ee}{s2n\_stuffer\_init}(&in, extensions));
142     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ad77ea23089bbeb19b897a73bf6ca3fde}{s2n\_stuffer\_write}(&in, extensions));
143 
144     \textcolor{keywordflow}{while} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&in)) \{
145         \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} \hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext};
146         uint16\_t extension\_type, extension\_size;
147         \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} extension;
148 
149         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a788c22abe22da96107393257193632c5}{s2n\_stuffer\_read\_uint16}(&in, &extension\_type));
150         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a788c22abe22da96107393257193632c5}{s2n\_stuffer\_read\_uint16}(&in, &extension\_size));
151 
152         \hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext}.size = extension\_size;
153         \hyperlink{s2n__safety_8h_ad35087e5d980b38035ca99fc5090775e}{lte\_check}(extension\_size, \hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&in));
154         \hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext}.data = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(&in, \hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext}.size);
155         \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(\hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext}.data);
156 
157         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_af556836db8ed75fdb89af3d418fab2ee}{s2n\_stuffer\_init}(&extension, &\hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext}));
158         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ad77ea23089bbeb19b897a73bf6ca3fde}{s2n\_stuffer\_write}(&extension, &\hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext}));
159 
160         \textcolor{keywordflow}{switch} (extension\_type) \{
161         \textcolor{keywordflow}{case} \hyperlink{s2n__tls__parameters_8h_ac5af336fe762b24789dde11d13a74035}{TLS\_EXTENSION\_SERVER\_NAME}:
162             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_recv\_client\_server\_name(conn, &extension));
163             \textcolor{keywordflow}{break};
164         \textcolor{keywordflow}{case} \hyperlink{s2n__tls__parameters_8h_a2df8cf476badc3a52f44d65caad71734}{TLS\_EXTENSION\_SIGNATURE\_ALGORITHMS}:
165             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_recv\_client\_signature\_algorithms(conn, &extension));
166             \textcolor{keywordflow}{break};
167         \textcolor{keywordflow}{case} \hyperlink{s2n__tls__parameters_8h_a753973f1e9b19bde89de02430b355128}{TLS\_EXTENSION\_ALPN}:
168             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_recv\_client\_alpn(conn, &extension));
169             \textcolor{keywordflow}{break};
170         \textcolor{keywordflow}{case} \hyperlink{s2n__tls__parameters_8h_acf3d575671ffd01a1400417f16520421}{TLS\_EXTENSION\_STATUS\_REQUEST}:
171             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_recv\_client\_status\_request(conn, &extension));
172             \textcolor{keywordflow}{break};
173         \textcolor{keywordflow}{case} \hyperlink{s2n__tls__parameters_8h_a0b8dde07daa13a017697a6218c34b11c}{TLS\_EXTENSION\_ELLIPTIC\_CURVES}:
174             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_recv\_client\_elliptic\_curves(conn, &extension));
175             \textcolor{keywordflow}{break};
176         \textcolor{keywordflow}{case} \hyperlink{s2n__tls__parameters_8h_a350023b90c4e7b5de523b149308440d7}{TLS\_EXTENSION\_EC\_POINT\_FORMATS}:
177             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_recv\_client\_ec\_point\_formats(conn, &extension));
178             \textcolor{keywordflow}{break};
179         \textcolor{keywordflow}{case} \hyperlink{s2n__tls__parameters_8h_a588964defd85ac156ea0941a1cc74279}{TLS\_EXTENSION\_RENEGOTIATION\_INFO}:
180             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_recv\_client\_renegotiation\_info(conn, &extension));
181             \textcolor{keywordflow}{break};
182         \}
183     \}
184 
185     \textcolor{keywordflow}{return} 0;
186 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63_icgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+extensions\+\_\+send@{s2n\+\_\+server\+\_\+extensions\+\_\+send}}
\index{s2n\+\_\+server\+\_\+extensions\+\_\+send@{s2n\+\_\+server\+\_\+extensions\+\_\+send}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+extensions\+\_\+send(struct s2n\+\_\+connection $\ast$conn, struct s2n\+\_\+stuffer $\ast$out)}{s2n_server_extensions_send(struct s2n_connection *conn, struct s2n_stuffer *out)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+extensions\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn, }
\item[{struct {\bf s2n\+\_\+stuffer} $\ast$}]{out}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab}{}\label{s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab}


Definition at line 33 of file s2n\+\_\+server\+\_\+extensions.\+c.


\begin{DoxyCode}
34 \{
35     uint16\_t total\_size = 0;
36 
37     uint8\_t application\_protocol\_len = strlen(conn->\hyperlink{structs2n__connection_a826afa0c257cdb351d45ca87c734ec3c}{application\_protocol});
38 
39     \textcolor{keywordflow}{if} (application\_protocol\_len) \{
40         total\_size += 7 + application\_protocol\_len;
41     \}
42     \textcolor{keywordflow}{if} (\hyperlink{s2n__tls_8h_a20bacac680b48d51f2623a1d95e85ca8}{s2n\_server\_can\_send\_ocsp}(conn)) \{
43         total\_size += 4;
44     \}
45     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a579beb899db6aa0c25366672938b2216}{secure\_renegotiation}) \{
46         total\_size += 5;
47     \}
48 
49     \textcolor{keywordflow}{if} (total\_size == 0) \{
50         \textcolor{keywordflow}{return} 0;
51     \}
52 
53     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, total\_size));
54 
55     \textcolor{comment}{/* Write the renegotiation\_info extension */}
56     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a579beb899db6aa0c25366672938b2216}{secure\_renegotiation}) \{
57         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 
      \hyperlink{s2n__tls__parameters_8h_a588964defd85ac156ea0941a1cc74279}{TLS\_EXTENSION\_RENEGOTIATION\_INFO}));
58         \textcolor{comment}{/* renegotiation\_info length */}
59         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 1));
60         \textcolor{comment}{/* renegotiated\_connection length */}
61         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, 0));
62     \}
63 
64     \textcolor{comment}{/* Write ALPN extension */}
65     \textcolor{keywordflow}{if} (application\_protocol\_len) \{
66         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 
      \hyperlink{s2n__tls__parameters_8h_a753973f1e9b19bde89de02430b355128}{TLS\_EXTENSION\_ALPN}));
67         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, application\_protocol\_len + 3));
68         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, application\_protocol\_len + 1));
69         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, application\_protocol\_len));
70         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(out, (uint8\_t *) conn->
      \hyperlink{structs2n__connection_a826afa0c257cdb351d45ca87c734ec3c}{application\_protocol}, application\_protocol\_len));
71     \}
72 
73     \textcolor{comment}{/* Write OCSP extension */}
74     \textcolor{keywordflow}{if} (\hyperlink{s2n__tls_8h_a20bacac680b48d51f2623a1d95e85ca8}{s2n\_server\_can\_send\_ocsp}(conn)) \{
75         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 
      \hyperlink{s2n__tls__parameters_8h_acf3d575671ffd01a1400417f16520421}{TLS\_EXTENSION\_STATUS\_REQUEST}));
76         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a9d9c55b0847a8ae81b6379971a13f27f}{s2n\_stuffer\_write\_uint16}(out, 0));
77     \}
78 
79     \textcolor{keywordflow}{return} 0;
80 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab_icgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+server\+\_\+extensions\+\_\+recv@{s2n\+\_\+server\+\_\+extensions\+\_\+recv}}
\index{s2n\+\_\+server\+\_\+extensions\+\_\+recv@{s2n\+\_\+server\+\_\+extensions\+\_\+recv}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+extensions\+\_\+recv(struct s2n\+\_\+connection $\ast$conn, struct s2n\+\_\+blob $\ast$extensions)}{s2n_server_extensions_recv(struct s2n_connection *conn, struct s2n_blob *extensions)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+extensions\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn, }
\item[{struct {\bf s2n\+\_\+blob} $\ast$}]{extensions}
\end{DoxyParamCaption}
)}\hypertarget{s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9}{}\label{s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9}


Definition at line 82 of file s2n\+\_\+server\+\_\+extensions.\+c.


\begin{DoxyCode}
83 \{
84     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} in;
85 
86     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_af556836db8ed75fdb89af3d418fab2ee}{s2n\_stuffer\_init}(&in, extensions));
87     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ad77ea23089bbeb19b897a73bf6ca3fde}{s2n\_stuffer\_write}(&in, extensions));
88 
89     \textcolor{keywordflow}{while} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(&in)) \{
90         \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} \hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext};
91         uint16\_t extension\_type, extension\_size;
92         \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} extension;
93 
94         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a788c22abe22da96107393257193632c5}{s2n\_stuffer\_read\_uint16}(&in, &extension\_type));
95         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a788c22abe22da96107393257193632c5}{s2n\_stuffer\_read\_uint16}(&in, &extension\_size));
96 
97         \hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext}.size = extension\_size;
98         \hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext}.data = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(&in, \hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext}.size);
99         \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(\hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext}.data);
100 
101         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_af556836db8ed75fdb89af3d418fab2ee}{s2n\_stuffer\_init}(&extension, &\hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext}));
102         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ad77ea23089bbeb19b897a73bf6ca3fde}{s2n\_stuffer\_write}(&extension, &\hyperlink{crypto_2x509v3_2x509v3_8h_aeaf958163deb17ab0df0d1ce32ad3713}{ext}));
103 
104         \textcolor{keywordflow}{switch} (extension\_type) \{
105         \textcolor{keywordflow}{case} \hyperlink{s2n__tls__parameters_8h_a753973f1e9b19bde89de02430b355128}{TLS\_EXTENSION\_ALPN}:
106             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_recv\_server\_alpn(conn, &extension));
107             \textcolor{keywordflow}{break};
108         \textcolor{keywordflow}{case} \hyperlink{s2n__tls__parameters_8h_acf3d575671ffd01a1400417f16520421}{TLS\_EXTENSION\_STATUS\_REQUEST}:
109             \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(s2n\_recv\_server\_status\_request(conn, &extension));
110             \textcolor{keywordflow}{break};
111         \}
112     \}
113 
114     \textcolor{keywordflow}{return} 0;
115 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}!s2n\+\_\+highest\+\_\+protocol\+\_\+version@{s2n\+\_\+highest\+\_\+protocol\+\_\+version}}
\index{s2n\+\_\+highest\+\_\+protocol\+\_\+version@{s2n\+\_\+highest\+\_\+protocol\+\_\+version}!s2n\+\_\+tls.\+h@{s2n\+\_\+tls.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+highest\+\_\+protocol\+\_\+version}{s2n_highest_protocol_version}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t s2n\+\_\+highest\+\_\+protocol\+\_\+version}\hypertarget{s2n__tls_8h_a0cb08e556504a133390d419bf05db470}{}\label{s2n__tls_8h_a0cb08e556504a133390d419bf05db470}


Definition at line 21 of file s2n\+\_\+tls.\+c.

