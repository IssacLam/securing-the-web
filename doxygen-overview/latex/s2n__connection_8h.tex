\hypertarget{s2n__connection_8h}{}\section{s2n-\/master/tls/s2n\+\_\+connection.h File Reference}
\label{s2n__connection_8h}\index{s2n-\/master/tls/s2n\+\_\+connection.\+h@{s2n-\/master/tls/s2n\+\_\+connection.\+h}}
{\ttfamily \#include $<$stdint.\+h$>$}\\*
{\ttfamily \#include $<$signal.\+h$>$}\\*
{\ttfamily \#include $<$errno.\+h$>$}\\*
{\ttfamily \#include $<$s2n.\+h$>$}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+tls\+\_\+parameters.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+handshake.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+crypto.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+config.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+prf.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stuffer/s2n\+\_\+stuffer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}crypto/s2n\+\_\+hash.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}crypto/s2n\+\_\+hmac.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+timer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+mem.\+h\char`\"{}}\\*
Include dependency graph for s2n\+\_\+connection.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__connection_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__connection_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structs2n__connection}{s2n\+\_\+connection}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2\+N\+\_\+\+T\+L\+S\+\_\+\+P\+R\+O\+T\+O\+C\+O\+L\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+L\+EN}~2
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{s2n__connection_8h_a746324b4543d50af7ebedc3ed91fbc57}{s2n\+\_\+connection\+\_\+kill} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{s2n\+\_\+connection.\+h@{s2n\+\_\+connection.\+h}!S2\+N\+\_\+\+T\+L\+S\+\_\+\+P\+R\+O\+T\+O\+C\+O\+L\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+L\+EN@{S2\+N\+\_\+\+T\+L\+S\+\_\+\+P\+R\+O\+T\+O\+C\+O\+L\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+L\+EN}}
\index{S2\+N\+\_\+\+T\+L\+S\+\_\+\+P\+R\+O\+T\+O\+C\+O\+L\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+L\+EN@{S2\+N\+\_\+\+T\+L\+S\+\_\+\+P\+R\+O\+T\+O\+C\+O\+L\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+L\+EN}!s2n\+\_\+connection.\+h@{s2n\+\_\+connection.\+h}}
\subsubsection[{\texorpdfstring{S2\+N\+\_\+\+T\+L\+S\+\_\+\+P\+R\+O\+T\+O\+C\+O\+L\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+L\+EN}{S2N_TLS_PROTOCOL_VERSION_LEN}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S2\+N\+\_\+\+T\+L\+S\+\_\+\+P\+R\+O\+T\+O\+C\+O\+L\+\_\+\+V\+E\+R\+S\+I\+O\+N\+\_\+\+L\+EN~2}\hypertarget{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{}\label{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}


Definition at line 37 of file s2n\+\_\+connection.\+h.



\subsection{Function Documentation}
\index{s2n\+\_\+connection.\+h@{s2n\+\_\+connection.\+h}!s2n\+\_\+connection\+\_\+kill@{s2n\+\_\+connection\+\_\+kill}}
\index{s2n\+\_\+connection\+\_\+kill@{s2n\+\_\+connection\+\_\+kill}!s2n\+\_\+connection.\+h@{s2n\+\_\+connection.\+h}}
\subsubsection[{\texorpdfstring{s2n\+\_\+connection\+\_\+kill(struct s2n\+\_\+connection $\ast$conn)}{s2n_connection_kill(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+connection\+\_\+kill (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__connection_8h_a746324b4543d50af7ebedc3ed91fbc57}{}\label{s2n__connection_8h_a746324b4543d50af7ebedc3ed91fbc57}


Definition at line 365 of file s2n\+\_\+connection.\+c.


\begin{DoxyCode}
366 \{
367     conn->\hyperlink{structs2n__connection_a9e746c5b2dde4a77b710780924853c2f}{closed} = 1;
368 
369     \textcolor{comment}{/* Delay between 10 and 30 seconds in nanoseconds */}
370     int64\_t min = \hyperlink{s2n__connection_8c_a1ac39f3db66611dac49e2ba4c03cc4f0}{TEN\_S}, max = 3 * \hyperlink{s2n__connection_8c_a1ac39f3db66611dac49e2ba4c03cc4f0}{TEN\_S};
371 
372     \textcolor{comment}{/* Keep track of the delay so that it can be enforced */}
373     conn->\hyperlink{structs2n__connection_a8c0b95ab06c950bd9afd8444922d98a3}{delay} = min + \hyperlink{s2n__random_8c_a8aabcb071120a9849d4615358000a8a6}{s2n\_public\_random}(max - min);
374 
375     \textcolor{comment}{/* Restart the write timer */}
376     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__timer_8c_a78c722b16f52af289f500f2f6e471904}{s2n\_timer\_start}(conn->\hyperlink{structs2n__connection_a7d70bb7bed95daae1233293126bb9523}{config}, &conn->
      \hyperlink{structs2n__connection_a31018fa57bbc729b543d5d33a937748b}{write\_timer}));
377 
378     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a1bfa8f7b48f1d0d742fed4a18b4d3f40}{blinding} == \hyperlink{s2n_8h_a364ad496c9dd42fd3117a2f9d3289e62a090459f0733b199be908d881d7db871f}{S2N\_BUILT\_IN\_BLINDING}) \{
379         \textcolor{keyword}{struct }timespec sleep\_time = \{.tv\_sec = conn->\hyperlink{structs2n__connection_a8c0b95ab06c950bd9afd8444922d98a3}{delay} / \hyperlink{s2n__connection_8c_a6958505563e734e5db6fd839a3f840cf}{ONE\_S},.tv\_nsec = conn->
      \hyperlink{structs2n__connection_a8c0b95ab06c950bd9afd8444922d98a3}{delay} % \hyperlink{s2n__connection_8c_a6958505563e734e5db6fd839a3f840cf}{ONE\_S} \};
380         \textcolor{keywordtype}{int} r;
381 
382         \textcolor{keywordflow}{do} \{
383             r = nanosleep(&sleep\_time, &sleep\_time);
384         \}
385         \textcolor{keywordflow}{while} (r != 0);
386     \}
387 
388     \textcolor{keywordflow}{return} 0;
389 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__connection_8h_a746324b4543d50af7ebedc3ed91fbc57_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__connection_8h_a746324b4543d50af7ebedc3ed91fbc57_icgraph}
\end{center}
\end{figure}


