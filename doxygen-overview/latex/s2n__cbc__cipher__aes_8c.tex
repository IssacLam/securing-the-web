\hypertarget{s2n__cbc__cipher__aes_8c}{}\section{s2n-\/master/crypto/s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.c File Reference}
\label{s2n__cbc__cipher__aes_8c}\index{s2n-\/master/crypto/s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c@{s2n-\/master/crypto/s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c}}
{\ttfamily \#include $<$openssl/aes.\+h$>$}\\*
{\ttfamily \#include \char`\"{}error/s2n\+\_\+errno.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}crypto/s2n\+\_\+cipher.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+safety.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+blob.\+h\char`\"{}}\\*
Include dependency graph for s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__cbc__cipher__aes_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{s2n__cbc__cipher__aes_8c_a67d8664b0a086818cec7706376bc61bb}{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes\+\_\+decrypt} (struct \hyperlink{structs2n__session__key}{s2n\+\_\+session\+\_\+key} $\ast$key, struct \hyperlink{structs2n__blob}{s2n\+\_\+blob} $\ast$iv, struct \hyperlink{structs2n__blob}{s2n\+\_\+blob} $\ast$in, struct \hyperlink{structs2n__blob}{s2n\+\_\+blob} $\ast$out)
\item 
int \hyperlink{s2n__cbc__cipher__aes_8c_a2b9edea267b2a7b66551735e68390bf6}{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes128\+\_\+get\+\_\+decryption\+\_\+key} (struct \hyperlink{structs2n__session__key}{s2n\+\_\+session\+\_\+key} $\ast$key, struct \hyperlink{structs2n__blob}{s2n\+\_\+blob} $\ast$in)
\item 
int \hyperlink{s2n__cbc__cipher__aes_8c_a0afeaf245690ed7560dcc131b7a9cac9}{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes256\+\_\+get\+\_\+encryption\+\_\+key} (struct \hyperlink{structs2n__session__key}{s2n\+\_\+session\+\_\+key} $\ast$key, struct \hyperlink{structs2n__blob}{s2n\+\_\+blob} $\ast$in)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structs2n__cipher}{s2n\+\_\+cipher} \hyperlink{s2n__cbc__cipher__aes_8c_ad9157f5c26e895d54f5bcbf7b3d5fd12}{s2n\+\_\+aes128}
\item 
struct \hyperlink{structs2n__cipher}{s2n\+\_\+cipher} \hyperlink{s2n__cbc__cipher__aes_8c_a2cb8c88972784a1123f286a14d9bb5fc}{s2n\+\_\+aes256}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c}!s2n\+\_\+cbc\+\_\+cipher\+\_\+aes\+\_\+decrypt@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes\+\_\+decrypt}}
\index{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes\+\_\+decrypt@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes\+\_\+decrypt}!s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes\+\_\+decrypt(struct s2n\+\_\+session\+\_\+key $\ast$key, struct s2n\+\_\+blob $\ast$iv, struct s2n\+\_\+blob $\ast$in, struct s2n\+\_\+blob $\ast$out)}{s2n_cbc_cipher_aes_decrypt(struct s2n_session_key *key, struct s2n_blob *iv, struct s2n_blob *in, struct s2n_blob *out)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+cbc\+\_\+cipher\+\_\+aes\+\_\+decrypt (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+session\+\_\+key} $\ast$}]{key, }
\item[{struct {\bf s2n\+\_\+blob} $\ast$}]{iv, }
\item[{struct {\bf s2n\+\_\+blob} $\ast$}]{in, }
\item[{struct {\bf s2n\+\_\+blob} $\ast$}]{out}
\end{DoxyParamCaption}
)}\hypertarget{s2n__cbc__cipher__aes_8c_a67d8664b0a086818cec7706376bc61bb}{}\label{s2n__cbc__cipher__aes_8c_a67d8664b0a086818cec7706376bc61bb}


Definition at line 45 of file s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c.


\begin{DoxyCode}
46 \{
47     \hyperlink{s2n__safety_8h_a033f3870a2832a9972eadb4700f725b9}{gte\_check}(out->\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size}, in->\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size});
48 
49     \textcolor{keywordflow}{if} (\hyperlink{crypto_2evp_2evp_8h_a4c1567e98a0a84f8dbc1ff9d8920b288}{EVP\_DecryptInit\_ex}(&key->\hyperlink{structs2n__session__key_afe527615e6e7d852f53125597340db87}{native\_format}.
      \hyperlink{structs2n__session__key_af56d0d167801d35add7ff05bb974e3e1}{evp\_cipher\_ctx}, NULL, NULL, NULL, iv->\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}) == 0) \{
50         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374aa6552a4aadc6ae8612fe8a1913b07227}{S2N\_ERR\_KEY\_INIT});
51     \}
52 
53     \textcolor{keywordtype}{int} \hyperlink{crypto_2asn1_2asn1_8h_ad8c3db4434e9cb5cd772cc009f40e856}{len} = out->\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size};
54     \textcolor{keywordflow}{if} (\hyperlink{crypto_2evp_2evp_8h_a6a6a756b17f35f9e128cc6d658842a69}{EVP\_DecryptUpdate}(&key->\hyperlink{structs2n__session__key_afe527615e6e7d852f53125597340db87}{native\_format}.
      \hyperlink{structs2n__session__key_af56d0d167801d35add7ff05bb974e3e1}{evp\_cipher\_ctx}, out->\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}, &len, in->\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}, in->\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size}) == 0) \{
55         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374a2242cf397568c29bfa830fb9193f59b8}{S2N\_ERR\_DECRYPT});
56     \}
57 
58     \textcolor{keywordflow}{return} 0;
59 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=332pt]{s2n__cbc__cipher__aes_8c_a67d8664b0a086818cec7706376bc61bb_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c}!s2n\+\_\+cbc\+\_\+cipher\+\_\+aes128\+\_\+get\+\_\+decryption\+\_\+key@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes128\+\_\+get\+\_\+decryption\+\_\+key}}
\index{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes128\+\_\+get\+\_\+decryption\+\_\+key@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes128\+\_\+get\+\_\+decryption\+\_\+key}!s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes128\+\_\+get\+\_\+decryption\+\_\+key(struct s2n\+\_\+session\+\_\+key $\ast$key, struct s2n\+\_\+blob $\ast$in)}{s2n_cbc_cipher_aes128_get_decryption_key(struct s2n_session_key *key, struct s2n_blob *in)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+cbc\+\_\+cipher\+\_\+aes128\+\_\+get\+\_\+decryption\+\_\+key (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+session\+\_\+key} $\ast$}]{key, }
\item[{struct {\bf s2n\+\_\+blob} $\ast$}]{in}
\end{DoxyParamCaption}
)}\hypertarget{s2n__cbc__cipher__aes_8c_a2b9edea267b2a7b66551735e68390bf6}{}\label{s2n__cbc__cipher__aes_8c_a2b9edea267b2a7b66551735e68390bf6}


Definition at line 61 of file s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c.


\begin{DoxyCode}
62 \{
63     \hyperlink{s2n__safety_8h_a286ad9b0d46f4af176671cda1ed6f58a}{eq\_check}(in->\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size}, 128 / 8);
64     \hyperlink{crypto_2evp_2evp_8h_a171bd50b3014686da08759b1282d5a53}{EVP\_CIPHER\_CTX\_set\_padding}(&key->\hyperlink{structs2n__session__key_afe527615e6e7d852f53125597340db87}{native\_format}.
      \hyperlink{structs2n__session__key_af56d0d167801d35add7ff05bb974e3e1}{evp\_cipher\_ctx}, \hyperlink{crypto_2evp_2evp_8h_a0bd47bfb35aa5ed20d98c6f12383ff4f}{EVP\_CIPH\_NO\_PADDING});
65     \hyperlink{crypto_2evp_2evp_8h_a4c1567e98a0a84f8dbc1ff9d8920b288}{EVP\_DecryptInit\_ex}(&key->\hyperlink{structs2n__session__key_afe527615e6e7d852f53125597340db87}{native\_format}.
      \hyperlink{structs2n__session__key_af56d0d167801d35add7ff05bb974e3e1}{evp\_cipher\_ctx}, \hyperlink{crypto_2evp_2evp_8h_a2747bac943db15c97167ac37fdc2af43}{EVP\_aes\_128\_cbc}(), NULL, in->\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}, NULL);
66 
67     \textcolor{keywordflow}{return} 0;
68 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__cbc__cipher__aes_8c_a2b9edea267b2a7b66551735e68390bf6_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c}!s2n\+\_\+cbc\+\_\+cipher\+\_\+aes256\+\_\+get\+\_\+encryption\+\_\+key@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes256\+\_\+get\+\_\+encryption\+\_\+key}}
\index{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes256\+\_\+get\+\_\+encryption\+\_\+key@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes256\+\_\+get\+\_\+encryption\+\_\+key}!s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes256\+\_\+get\+\_\+encryption\+\_\+key(struct s2n\+\_\+session\+\_\+key $\ast$key, struct s2n\+\_\+blob $\ast$in)}{s2n_cbc_cipher_aes256_get_encryption_key(struct s2n_session_key *key, struct s2n_blob *in)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+cbc\+\_\+cipher\+\_\+aes256\+\_\+get\+\_\+encryption\+\_\+key (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+session\+\_\+key} $\ast$}]{key, }
\item[{struct {\bf s2n\+\_\+blob} $\ast$}]{in}
\end{DoxyParamCaption}
)}\hypertarget{s2n__cbc__cipher__aes_8c_a0afeaf245690ed7560dcc131b7a9cac9}{}\label{s2n__cbc__cipher__aes_8c_a0afeaf245690ed7560dcc131b7a9cac9}


Definition at line 88 of file s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c.


\begin{DoxyCode}
89 \{
90     \hyperlink{s2n__safety_8h_a286ad9b0d46f4af176671cda1ed6f58a}{eq\_check}(in->\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size}, 256 / 8);
91     \hyperlink{crypto_2evp_2evp_8h_ad32900fec7d9cb579e5d0bad7a4e1daa}{EVP\_CIPHER\_CTX\_init}(&key->\hyperlink{structs2n__session__key_afe527615e6e7d852f53125597340db87}{native\_format}.
      \hyperlink{structs2n__session__key_af56d0d167801d35add7ff05bb974e3e1}{evp\_cipher\_ctx});
92     \hyperlink{crypto_2evp_2evp_8h_a171bd50b3014686da08759b1282d5a53}{EVP\_CIPHER\_CTX\_set\_padding}(&key->\hyperlink{structs2n__session__key_afe527615e6e7d852f53125597340db87}{native\_format}.
      \hyperlink{structs2n__session__key_af56d0d167801d35add7ff05bb974e3e1}{evp\_cipher\_ctx}, \hyperlink{crypto_2evp_2evp_8h_a0bd47bfb35aa5ed20d98c6f12383ff4f}{EVP\_CIPH\_NO\_PADDING});
93     \hyperlink{crypto_2evp_2evp_8h_aa1ef7bdeb2a1f92e5f40a3fe1d87da65}{EVP\_EncryptInit\_ex}(&key->\hyperlink{structs2n__session__key_afe527615e6e7d852f53125597340db87}{native\_format}.
      \hyperlink{structs2n__session__key_af56d0d167801d35add7ff05bb974e3e1}{evp\_cipher\_ctx}, \hyperlink{crypto_2evp_2evp_8h_a597a638984cfe169f5b794a01076d289}{EVP\_aes\_256\_cbc}(), NULL, in->\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}, NULL);
94 
95     \textcolor{keywordflow}{return} 0;
96 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__cbc__cipher__aes_8c_a0afeaf245690ed7560dcc131b7a9cac9_cgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c}!s2n\+\_\+aes128@{s2n\+\_\+aes128}}
\index{s2n\+\_\+aes128@{s2n\+\_\+aes128}!s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+aes128}{s2n_aes128}}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf s2n\+\_\+cipher} s2n\+\_\+aes128}\hypertarget{s2n__cbc__cipher__aes_8c_ad9157f5c26e895d54f5bcbf7b3d5fd12}{}\label{s2n__cbc__cipher__aes_8c_ad9157f5c26e895d54f5bcbf7b3d5fd12}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{
    .key\_material\_size = 16,
    .type = S2N\_CBC,
    .io.cbc = \{
               .block\_size = 16,
               .record\_iv\_size = 16,
               .decrypt = \hyperlink{s2n__cbc__cipher__aes_8c_a67d8664b0a086818cec7706376bc61bb}{s2n\_cbc\_cipher\_aes\_decrypt},
               .encrypt = s2n\_cbc\_cipher\_aes\_encrypt\},
    .init = s2n\_cbc\_cipher\_aes\_init,
    .get\_decryption\_key = \hyperlink{s2n__cbc__cipher__aes_8c_a2b9edea267b2a7b66551735e68390bf6}{s2n\_cbc\_cipher\_aes128\_get\_decryption\_key},
    .get\_encryption\_key = s2n\_cbc\_cipher\_aes128\_get\_encryption\_key,
    .destroy\_key = s2n\_cbc\_cipher\_aes\_destroy\_key,
\}
\end{DoxyCode}


Definition at line 112 of file s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c.

\index{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c}!s2n\+\_\+aes256@{s2n\+\_\+aes256}}
\index{s2n\+\_\+aes256@{s2n\+\_\+aes256}!s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c@{s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+aes256}{s2n_aes256}}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf s2n\+\_\+cipher} s2n\+\_\+aes256}\hypertarget{s2n__cbc__cipher__aes_8c_a2cb8c88972784a1123f286a14d9bb5fc}{}\label{s2n__cbc__cipher__aes_8c_a2cb8c88972784a1123f286a14d9bb5fc}
{\bfseries Initial value\+:}
\begin{DoxyCode}
= \{
    .key\_material\_size = 32,
    .type = S2N\_CBC,
    .io.cbc = \{
               .block\_size = 16,
               .record\_iv\_size = 16,
               .decrypt = \hyperlink{s2n__cbc__cipher__aes_8c_a67d8664b0a086818cec7706376bc61bb}{s2n\_cbc\_cipher\_aes\_decrypt},
               .encrypt = s2n\_cbc\_cipher\_aes\_encrypt\},
    .init = s2n\_cbc\_cipher\_aes\_init,
    .get\_decryption\_key = s2n\_cbc\_cipher\_aes256\_get\_decryption\_key,
    .get\_encryption\_key = \hyperlink{s2n__cbc__cipher__aes_8c_a0afeaf245690ed7560dcc131b7a9cac9}{s2n\_cbc\_cipher\_aes256\_get\_encryption\_key},
    .destroy\_key = s2n\_cbc\_cipher\_aes\_destroy\_key,
\}
\end{DoxyCode}


Definition at line 126 of file s2n\+\_\+cbc\+\_\+cipher\+\_\+aes.\+c.

