\hypertarget{s2n__client__ccs_8c}{}\section{s2n-\/master/tls/s2n\+\_\+client\+\_\+ccs.c File Reference}
\label{s2n__client__ccs_8c}\index{s2n-\/master/tls/s2n\+\_\+client\+\_\+ccs.\+c@{s2n-\/master/tls/s2n\+\_\+client\+\_\+ccs.\+c}}
{\ttfamily \#include $<$stdint.\+h$>$}\\*
{\ttfamily \#include \char`\"{}error/s2n\+\_\+errno.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+cipher\+\_\+suites.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+connection.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+tls.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stuffer/s2n\+\_\+stuffer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+safety.\+h\char`\"{}}\\*
Include dependency graph for s2n\+\_\+client\+\_\+ccs.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__client__ccs_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{s2n__client__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}{C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE}~1
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{s2n__client__ccs_8c_aab9d53a394720e55e7648730f94bb176}{s2n\+\_\+client\+\_\+ccs\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__client__ccs_8c_a9be1791dfd4b0af9525be21fb52ec4eb}{s2n\+\_\+client\+\_\+ccs\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{s2n\+\_\+client\+\_\+ccs.\+c@{s2n\+\_\+client\+\_\+ccs.\+c}!C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE@{C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE}}
\index{C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE@{C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE}!s2n\+\_\+client\+\_\+ccs.\+c@{s2n\+\_\+client\+\_\+ccs.\+c}}
\subsubsection[{\texorpdfstring{C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE}{CHANGE_CIPHER_SPEC_TYPE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE~1}\hypertarget{s2n__client__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}{}\label{s2n__client__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}


Definition at line 29 of file s2n\+\_\+client\+\_\+ccs.\+c.



\subsection{Function Documentation}
\index{s2n\+\_\+client\+\_\+ccs.\+c@{s2n\+\_\+client\+\_\+ccs.\+c}!s2n\+\_\+client\+\_\+ccs\+\_\+recv@{s2n\+\_\+client\+\_\+ccs\+\_\+recv}}
\index{s2n\+\_\+client\+\_\+ccs\+\_\+recv@{s2n\+\_\+client\+\_\+ccs\+\_\+recv}!s2n\+\_\+client\+\_\+ccs.\+c@{s2n\+\_\+client\+\_\+ccs.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+ccs\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_client_ccs_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+ccs\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__client__ccs_8c_aab9d53a394720e55e7648730f94bb176}{}\label{s2n__client__ccs_8c_aab9d53a394720e55e7648730f94bb176}


Definition at line 31 of file s2n\+\_\+client\+\_\+ccs.\+c.


\begin{DoxyCode}
32 \{
33     uint8\_t \hyperlink{crypto_2x509_2x509_8h_ab512b8f495325c7ea0f5a5a5d3f938eb}{type};
34 
35     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a809931120983e64ed6602dbac2b9b1fc}{s2n\_prf\_client\_finished}(conn));
36 
37     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} seq = \{.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_ab7767b5b58441b15ac1028ac18b06ef1}{client\_sequence\_number},.size = \textcolor{keyword}{sizeof}(conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_ab7767b5b58441b15ac1028ac18b06ef1}{client\_sequence\_number}) \};
38     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__blob_8c_a241c17ca2593704ff88734d13659a877}{s2n\_blob\_zero}(&seq));
39 
40     \textcolor{comment}{/* Update the client to use the cipher-suite */}
41     conn->\hyperlink{structs2n__connection_a052f81d7dc7e2612341fe0da1e749ebd}{client} = &conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure};
42 
43     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, &type));
44     \textcolor{keywordflow}{if} (type != \hyperlink{s2n__client__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}{CHANGE\_CIPHER\_SPEC\_TYPE}) \{
45         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
46     \}
47 
48     \textcolor{comment}{/* Flush any partial alert messages that were pending */}
49     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a2b6b54f7856d92f06f823bc26d10f4ba}{s2n\_stuffer\_wipe}(&conn->\hyperlink{structs2n__connection_a628dd7fe79c7cfd5f7bc02da8a270752}{alert\_in}));
50 
51     \textcolor{keywordflow}{return} 0;
52 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__client__ccs_8c_aab9d53a394720e55e7648730f94bb176_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+client\+\_\+ccs.\+c@{s2n\+\_\+client\+\_\+ccs.\+c}!s2n\+\_\+client\+\_\+ccs\+\_\+send@{s2n\+\_\+client\+\_\+ccs\+\_\+send}}
\index{s2n\+\_\+client\+\_\+ccs\+\_\+send@{s2n\+\_\+client\+\_\+ccs\+\_\+send}!s2n\+\_\+client\+\_\+ccs.\+c@{s2n\+\_\+client\+\_\+ccs.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+ccs\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_client_ccs_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+ccs\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__client__ccs_8c_a9be1791dfd4b0af9525be21fb52ec4eb}{}\label{s2n__client__ccs_8c_a9be1791dfd4b0af9525be21fb52ec4eb}


Definition at line 54 of file s2n\+\_\+client\+\_\+ccs.\+c.


\begin{DoxyCode}
55 \{
56     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, \hyperlink{s2n__client__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}{CHANGE\_CIPHER\_SPEC\_TYPE}));
57 
58     \textcolor{keywordflow}{return} 0;
59 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__client__ccs_8c_a9be1791dfd4b0af9525be21fb52ec4eb_cgraph}
\end{center}
\end{figure}


