\hypertarget{s2n__server__hello_8c}{}\section{s2n-\/master/tls/s2n\+\_\+server\+\_\+hello.c File Reference}
\label{s2n__server__hello_8c}\index{s2n-\/master/tls/s2n\+\_\+server\+\_\+hello.\+c@{s2n-\/master/tls/s2n\+\_\+server\+\_\+hello.\+c}}
{\ttfamily \#include $<$sys/param.\+h$>$}\\*
{\ttfamily \#include $<$s2n.\+h$>$}\\*
{\ttfamily \#include $<$time.\+h$>$}\\*
{\ttfamily \#include \char`\"{}error/s2n\+\_\+errno.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+cipher\+\_\+suites.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+connection.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+alerts.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+tls.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stuffer/s2n\+\_\+stuffer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+safety.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+random.\+h\char`\"{}}\\*
Include dependency graph for s2n\+\_\+server\+\_\+hello.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__server__hello_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{s2n__server__hello_8c_a2cb71a349ceab5a3a4a46d133306bf81}{S2\+N\+\_\+\+T\+L\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+M\+E\+T\+H\+O\+D\+\_\+\+N\+U\+LL}~0
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{s2n__server__hello_8c_a2139f810755eb8cf27ebea179e81ac81}{s2n\+\_\+server\+\_\+hello\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__server__hello_8c_a8e32b708f98ecbfa1148c5393f8b9dba}{s2n\+\_\+server\+\_\+hello\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{s2n\+\_\+server\+\_\+hello.\+c@{s2n\+\_\+server\+\_\+hello.\+c}!S2\+N\+\_\+\+T\+L\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+M\+E\+T\+H\+O\+D\+\_\+\+N\+U\+LL@{S2\+N\+\_\+\+T\+L\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+M\+E\+T\+H\+O\+D\+\_\+\+N\+U\+LL}}
\index{S2\+N\+\_\+\+T\+L\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+M\+E\+T\+H\+O\+D\+\_\+\+N\+U\+LL@{S2\+N\+\_\+\+T\+L\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+M\+E\+T\+H\+O\+D\+\_\+\+N\+U\+LL}!s2n\+\_\+server\+\_\+hello.\+c@{s2n\+\_\+server\+\_\+hello.\+c}}
\subsubsection[{\texorpdfstring{S2\+N\+\_\+\+T\+L\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+M\+E\+T\+H\+O\+D\+\_\+\+N\+U\+LL}{S2N_TLS_COMPRESSION_METHOD_NULL}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S2\+N\+\_\+\+T\+L\+S\+\_\+\+C\+O\+M\+P\+R\+E\+S\+S\+I\+O\+N\+\_\+\+M\+E\+T\+H\+O\+D\+\_\+\+N\+U\+LL~0}\hypertarget{s2n__server__hello_8c_a2cb71a349ceab5a3a4a46d133306bf81}{}\label{s2n__server__hello_8c_a2cb71a349ceab5a3a4a46d133306bf81}


Definition at line 34 of file s2n\+\_\+server\+\_\+hello.\+c.



\subsection{Function Documentation}
\index{s2n\+\_\+server\+\_\+hello.\+c@{s2n\+\_\+server\+\_\+hello.\+c}!s2n\+\_\+server\+\_\+hello\+\_\+recv@{s2n\+\_\+server\+\_\+hello\+\_\+recv}}
\index{s2n\+\_\+server\+\_\+hello\+\_\+recv@{s2n\+\_\+server\+\_\+hello\+\_\+recv}!s2n\+\_\+server\+\_\+hello.\+c@{s2n\+\_\+server\+\_\+hello.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+hello\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_hello_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+hello\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__server__hello_8c_a2139f810755eb8cf27ebea179e81ac81}{}\label{s2n__server__hello_8c_a2139f810755eb8cf27ebea179e81ac81}


Definition at line 36 of file s2n\+\_\+server\+\_\+hello.\+c.


\begin{DoxyCode}
37 \{
38     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} *in = &conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io};
39     uint8\_t compression\_method;
40     uint8\_t session\_id[\hyperlink{tls_2s2n__crypto_8h_a29125d7c5bb81700b27164fbc9c92746}{S2N\_TLS\_SESSION\_ID\_MAX\_LEN}];
41     uint8\_t session\_id\_len;
42     uint16\_t extensions\_size;
43     uint8\_t protocol\_version[\hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2N\_TLS\_PROTOCOL\_VERSION\_LEN}];
44 
45     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ab84cff8edd5b5f264afe261f093f894b}{s2n\_stuffer\_read\_bytes}(in, protocol\_version, 
      \hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2N\_TLS\_PROTOCOL\_VERSION\_LEN}));
46 
47     conn->\hyperlink{structs2n__connection_ae48c8e6d0ef10e7b815dd500562a47e7}{server\_protocol\_version} = (protocol\_version[0] * 10) + protocol\_version[1]
      ;
48 
49     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_ae48c8e6d0ef10e7b815dd500562a47e7}{server\_protocol\_version} > conn->
      \hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version}) \{
50         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__alerts_8c_aaab45cd713be8d161a114cf078b52635}{s2n\_queue\_reader\_unsupported\_protocol\_version\_alert}
      (conn));
51         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
52     \}
53     conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} = conn->
      \hyperlink{structs2n__connection_ae48c8e6d0ef10e7b815dd500562a47e7}{server\_protocol\_version};
54     conn->\hyperlink{structs2n__connection_ab54a0b4ad8370fee08f0c47917684e65}{actual\_protocol\_version\_established} = 1;
55 
56     \textcolor{comment}{/* Verify that the protocol version is sane */}
57     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} < \hyperlink{s2n_8h_a457805749bd152786e9e344a5b22ab67}{S2N\_SSLv3} || conn->
      \hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} > \hyperlink{s2n_8h_ab17e84046986d49ffd31571b8d32d24e}{S2N\_TLS12}) \{
58         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
59     \}
60 
61     conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a76195ad1b96e7ecdec22ee893d81c6c7}{signature\_digest\_alg} = 
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5ac0f7f343aebed483dfa89ad357fa6419}{S2N\_HASH\_MD5\_SHA1};
62     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} == \hyperlink{s2n_8h_ab17e84046986d49ffd31571b8d32d24e}{S2N\_TLS12}) \{
63         conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a76195ad1b96e7ecdec22ee893d81c6c7}{signature\_digest\_alg} = 
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627}{S2N\_HASH\_SHA1};
64     \}
65 
66     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ab84cff8edd5b5f264afe261f093f894b}{s2n\_stuffer\_read\_bytes}(in, conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_ae6ef2eba6c9afbd8345314a05422a2e4}{server\_random}, \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN}));
67     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}(in, &session\_id\_len));
68 
69     \textcolor{keywordflow}{if} (session\_id\_len > \hyperlink{tls_2s2n__crypto_8h_a29125d7c5bb81700b27164fbc9c92746}{S2N\_TLS\_SESSION\_ID\_MAX\_LEN}) \{
70         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
71     \}
72 
73     conn->\hyperlink{structs2n__connection_a76a9703b780cc6c577acbe9ed651a79d}{session\_id\_len} = session\_id\_len;
74     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_ab84cff8edd5b5f264afe261f093f894b}{s2n\_stuffer\_read\_bytes}(in, session\_id, session\_id\_len));
75     uint8\_t *cipher\_suite\_wire = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(in, 
      \hyperlink{tls_2s2n__crypto_8h_aad5e2a880d4b55cf5450393843a17cf8}{S2N\_TLS\_CIPHER\_SUITE\_LEN});
76     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(cipher\_suite\_wire);
77     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__cipher__suites_8c_a1fde427e44c9343e87af779ca1666b9e}{s2n\_set\_cipher\_as\_client}(conn, cipher\_suite\_wire));
78     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}(in, &compression\_method));
79 
80     \textcolor{keywordflow}{if} (compression\_method != \hyperlink{s2n__server__hello_8c_a2cb71a349ceab5a3a4a46d133306bf81}{S2N\_TLS\_COMPRESSION\_METHOD\_NULL}) \{
81         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
82     \}
83 
84     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__handshake_8h_a4406f29de6d52b587003368d656dab20}{s2n\_conn\_set\_handshake\_type}(conn));
85 
86     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a8b8974068a8f2c38a061ffb495a5ca1c}{handshake\_type} == RESUME) \{
87         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a1425bb608ed69a0cc582af0a57955e1f}{s2n\_prf\_key\_expansion}(conn));
88     \}
89 
90     \textcolor{keywordflow}{if} (\hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(in) < 2) \{
91         \textcolor{comment}{/* No extensions */}
92         \textcolor{keywordflow}{return} 0;
93     \}
94 
95     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a788c22abe22da96107393257193632c5}{s2n\_stuffer\_read\_uint16}(in, &extensions\_size));
96 
97     \textcolor{keywordflow}{if} (extensions\_size > \hyperlink{s2n__stuffer_8h_a56d3da0e05e4c05eb87a343306c4f170}{s2n\_stuffer\_data\_available}(in)) \{
98         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
99     \}
100 
101     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} extensions;
102     extensions.\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size} = extensions\_size;
103     extensions.data = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(in, extensions.size);
104     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(extensions.data);
105 
106     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__server__extensions_8c_aa5973260f0a72187b1331e5633795fe9}{s2n\_server\_extensions\_recv}(conn, &extensions));
107 
108     \textcolor{keywordflow}{return} 0;
109 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__server__hello_8c_a2139f810755eb8cf27ebea179e81ac81_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+server\+\_\+hello.\+c@{s2n\+\_\+server\+\_\+hello.\+c}!s2n\+\_\+server\+\_\+hello\+\_\+send@{s2n\+\_\+server\+\_\+hello\+\_\+send}}
\index{s2n\+\_\+server\+\_\+hello\+\_\+send@{s2n\+\_\+server\+\_\+hello\+\_\+send}!s2n\+\_\+server\+\_\+hello.\+c@{s2n\+\_\+server\+\_\+hello.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+hello\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_hello_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+hello\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__server__hello_8c_a8e32b708f98ecbfa1148c5393f8b9dba}{}\label{s2n__server__hello_8c_a8e32b708f98ecbfa1148c5393f8b9dba}


Definition at line 111 of file s2n\+\_\+server\+\_\+hello.\+c.


\begin{DoxyCode}
112 \{
113     uint32\_t gmt\_unix\_time = \hyperlink{s2n__server__fuzz__test__overrides_8c_a840ddd268669df5b1e15c04cebbd6210}{time}(NULL);
114     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} *out = &conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io};
115     \textcolor{keyword}{struct }\hyperlink{structs2n__stuffer}{s2n\_stuffer} server\_random;
116     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} b, r;
117     uint8\_t protocol\_version[\hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2N\_TLS\_PROTOCOL\_VERSION\_LEN}];
118 
119     b.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_ae6ef2eba6c9afbd8345314a05422a2e4}{server\_random};
120     b.size = \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN};
121 
122     \textcolor{comment}{/* Create the server random data */}
123     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_af556836db8ed75fdb89af3d418fab2ee}{s2n\_stuffer\_init}(&server\_random, &b));
124     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a958a82fb4dfe3517bcfd95f46807f715}{s2n\_stuffer\_write\_uint32}(&server\_random, gmt\_unix\_time));
125 
126     r.data = \hyperlink{s2n__stuffer_8c_afdc941db81df32f38b7800210f3f2d11}{s2n\_stuffer\_raw\_write}(&server\_random, 
      \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN} - 4);
127     r.size = \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN} - 4;
128     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(r.data);
129     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__random_8c_a5cfef84444cc08086a4098569c9f1fc8}{s2n\_get\_public\_random\_data}(&r));
130 
131     protocol\_version[0] = conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} / 10;
132     protocol\_version[1] = conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} % 10;
133 
134     conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a76195ad1b96e7ecdec22ee893d81c6c7}{signature\_digest\_alg} = 
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5ac0f7f343aebed483dfa89ad357fa6419}{S2N\_HASH\_MD5\_SHA1};
135     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} == \hyperlink{s2n_8h_ab17e84046986d49ffd31571b8d32d24e}{S2N\_TLS12}) \{
136         conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.\hyperlink{structs2n__crypto__parameters_a76195ad1b96e7ecdec22ee893d81c6c7}{signature\_digest\_alg} = 
      \hyperlink{s2n__hash_8h_a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627}{S2N\_HASH\_SHA1};
137     \}
138 
139     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(out, protocol\_version, 
      \hyperlink{s2n__connection_8h_ad4c29631b045d5227442f693bc3bf117}{S2N\_TLS\_PROTOCOL\_VERSION\_LEN}));
140     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(out, conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_ae6ef2eba6c9afbd8345314a05422a2e4}{server\_random}, \hyperlink{tls_2s2n__crypto_8h_ae4f42b5fd74ab885893a960b81dbd57f}{S2N\_TLS\_RANDOM\_DATA\_LEN}));
141     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, conn->
      \hyperlink{structs2n__connection_a76a9703b780cc6c577acbe9ed651a79d}{session\_id\_len}));
142     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(out, conn->
      \hyperlink{structs2n__connection_ad009472eb0ee35fef5b49e42599a84a1}{session\_id}, conn->\hyperlink{structs2n__connection_a76a9703b780cc6c577acbe9ed651a79d}{session\_id\_len}));
143     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(out, conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_a5446cce0337d14b74b38f2a81ea19670}{cipher\_suite}->\hyperlink{structs2n__cipher__suite_a9b3a865c19b6bc5b1d68ff63ed97b6c5}{value}, \hyperlink{tls_2s2n__crypto_8h_aad5e2a880d4b55cf5450393843a17cf8}{S2N\_TLS\_CIPHER\_SUITE\_LEN}));
144     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(out, 
      \hyperlink{s2n__server__hello_8c_a2cb71a349ceab5a3a4a46d133306bf81}{S2N\_TLS\_COMPRESSION\_METHOD\_NULL}));
145 
146     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__server__extensions_8c_a72b3e9fb3b4cb76a22e8d236609029ab}{s2n\_server\_extensions\_send}(conn, out));
147 
148     conn->\hyperlink{structs2n__connection_ab54a0b4ad8370fee08f0c47917684e65}{actual\_protocol\_version\_established} = 1;
149 
150     \textcolor{keywordflow}{return} 0;
151 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__server__hello_8c_a8e32b708f98ecbfa1148c5393f8b9dba_cgraph}
\end{center}
\end{figure}


