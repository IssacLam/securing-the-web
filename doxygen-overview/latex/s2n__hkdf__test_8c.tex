\hypertarget{s2n__hkdf__test_8c}{}\section{s2n-\/master/tests/unit/s2n\+\_\+hkdf\+\_\+test.c File Reference}
\label{s2n__hkdf__test_8c}\index{s2n-\/master/tests/unit/s2n\+\_\+hkdf\+\_\+test.\+c@{s2n-\/master/tests/unit/s2n\+\_\+hkdf\+\_\+test.\+c}}
{\ttfamily \#include \char`\"{}s2n\+\_\+test.\+h\char`\"{}}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include \char`\"{}testlib/s2n\+\_\+testlib.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stuffer/s2n\+\_\+stuffer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}crypto/s2n\+\_\+hmac.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}crypto/s2n\+\_\+hkdf.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+blob.\+h\char`\"{}}\\*
Include dependency graph for s2n\+\_\+hkdf\+\_\+test.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__hkdf__test_8c__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structhkdf__test__vector}{hkdf\+\_\+test\+\_\+vector}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{s2n__hkdf__test_8c_a513819cf6a35e11aa0bb36eeb6601dc2}{N\+U\+M\+\_\+\+T\+E\+S\+TS}~12
\item 
\#define \hyperlink{s2n__hkdf__test_8c_a28d683cf067736d76f867f30c066317e}{M\+A\+X\+\_\+\+O\+U\+T\+P\+U\+T\+\_\+\+S\+I\+ZE}~82
\item 
\#define \hyperlink{s2n__hkdf__test_8c_ae0c24c56d2a1fb1fcec4475dbd8dc05f}{M\+A\+X\+\_\+\+P\+S\+E\+U\+D\+O\+\_\+\+R\+A\+N\+D\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE}~64
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{s2n__hkdf__test_8c_a9c6cabe5f7841673be19dbf9e8dad1a5}{s2n\+\_\+hkdf\+\_\+extract} (\hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\+\_\+hmac\+\_\+algorithm} alg, const struct \hyperlink{structs2n__blob}{s2n\+\_\+blob} $\ast$salt, const struct \hyperlink{structs2n__blob}{s2n\+\_\+blob} $\ast$key, struct \hyperlink{structs2n__blob}{s2n\+\_\+blob} $\ast$pseudo\+\_\+rand\+\_\+key)
\item 
int \hyperlink{s2n__hkdf__test_8c_a3c04138a5bfe5d72780bb7e82a18e627}{main} (int argc, char $\ast$$\ast$argv)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{s2n\+\_\+hkdf\+\_\+test.\+c@{s2n\+\_\+hkdf\+\_\+test.\+c}!N\+U\+M\+\_\+\+T\+E\+S\+TS@{N\+U\+M\+\_\+\+T\+E\+S\+TS}}
\index{N\+U\+M\+\_\+\+T\+E\+S\+TS@{N\+U\+M\+\_\+\+T\+E\+S\+TS}!s2n\+\_\+hkdf\+\_\+test.\+c@{s2n\+\_\+hkdf\+\_\+test.\+c}}
\subsubsection[{\texorpdfstring{N\+U\+M\+\_\+\+T\+E\+S\+TS}{NUM_TESTS}}]{\setlength{\rightskip}{0pt plus 5cm}\#define N\+U\+M\+\_\+\+T\+E\+S\+TS~12}\hypertarget{s2n__hkdf__test_8c_a513819cf6a35e11aa0bb36eeb6601dc2}{}\label{s2n__hkdf__test_8c_a513819cf6a35e11aa0bb36eeb6601dc2}


Definition at line 29 of file s2n\+\_\+hkdf\+\_\+test.\+c.

\index{s2n\+\_\+hkdf\+\_\+test.\+c@{s2n\+\_\+hkdf\+\_\+test.\+c}!M\+A\+X\+\_\+\+O\+U\+T\+P\+U\+T\+\_\+\+S\+I\+ZE@{M\+A\+X\+\_\+\+O\+U\+T\+P\+U\+T\+\_\+\+S\+I\+ZE}}
\index{M\+A\+X\+\_\+\+O\+U\+T\+P\+U\+T\+\_\+\+S\+I\+ZE@{M\+A\+X\+\_\+\+O\+U\+T\+P\+U\+T\+\_\+\+S\+I\+ZE}!s2n\+\_\+hkdf\+\_\+test.\+c@{s2n\+\_\+hkdf\+\_\+test.\+c}}
\subsubsection[{\texorpdfstring{M\+A\+X\+\_\+\+O\+U\+T\+P\+U\+T\+\_\+\+S\+I\+ZE}{MAX_OUTPUT_SIZE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+O\+U\+T\+P\+U\+T\+\_\+\+S\+I\+ZE~82}\hypertarget{s2n__hkdf__test_8c_a28d683cf067736d76f867f30c066317e}{}\label{s2n__hkdf__test_8c_a28d683cf067736d76f867f30c066317e}


Definition at line 30 of file s2n\+\_\+hkdf\+\_\+test.\+c.

\index{s2n\+\_\+hkdf\+\_\+test.\+c@{s2n\+\_\+hkdf\+\_\+test.\+c}!M\+A\+X\+\_\+\+P\+S\+E\+U\+D\+O\+\_\+\+R\+A\+N\+D\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE@{M\+A\+X\+\_\+\+P\+S\+E\+U\+D\+O\+\_\+\+R\+A\+N\+D\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE}}
\index{M\+A\+X\+\_\+\+P\+S\+E\+U\+D\+O\+\_\+\+R\+A\+N\+D\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE@{M\+A\+X\+\_\+\+P\+S\+E\+U\+D\+O\+\_\+\+R\+A\+N\+D\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE}!s2n\+\_\+hkdf\+\_\+test.\+c@{s2n\+\_\+hkdf\+\_\+test.\+c}}
\subsubsection[{\texorpdfstring{M\+A\+X\+\_\+\+P\+S\+E\+U\+D\+O\+\_\+\+R\+A\+N\+D\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE}{MAX_PSEUDO_RAND_KEY_SIZE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+P\+S\+E\+U\+D\+O\+\_\+\+R\+A\+N\+D\+\_\+\+K\+E\+Y\+\_\+\+S\+I\+ZE~64}\hypertarget{s2n__hkdf__test_8c_ae0c24c56d2a1fb1fcec4475dbd8dc05f}{}\label{s2n__hkdf__test_8c_ae0c24c56d2a1fb1fcec4475dbd8dc05f}


Definition at line 31 of file s2n\+\_\+hkdf\+\_\+test.\+c.



\subsection{Function Documentation}
\index{s2n\+\_\+hkdf\+\_\+test.\+c@{s2n\+\_\+hkdf\+\_\+test.\+c}!s2n\+\_\+hkdf\+\_\+extract@{s2n\+\_\+hkdf\+\_\+extract}}
\index{s2n\+\_\+hkdf\+\_\+extract@{s2n\+\_\+hkdf\+\_\+extract}!s2n\+\_\+hkdf\+\_\+test.\+c@{s2n\+\_\+hkdf\+\_\+test.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+hkdf\+\_\+extract(s2n\+\_\+hmac\+\_\+algorithm alg, const struct s2n\+\_\+blob $\ast$salt, const struct s2n\+\_\+blob $\ast$key, struct s2n\+\_\+blob $\ast$pseudo\+\_\+rand\+\_\+key)}{s2n_hkdf_extract(s2n_hmac_algorithm alg, const struct s2n_blob *salt, const struct s2n_blob *key, struct s2n_blob *pseudo_rand_key)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+hkdf\+\_\+extract (
\begin{DoxyParamCaption}
\item[{{\bf s2n\+\_\+hmac\+\_\+algorithm}}]{alg, }
\item[{const struct {\bf s2n\+\_\+blob} $\ast$}]{salt, }
\item[{const struct {\bf s2n\+\_\+blob} $\ast$}]{key, }
\item[{struct {\bf s2n\+\_\+blob} $\ast$}]{pseudo\+\_\+rand\+\_\+key}
\end{DoxyParamCaption}
)}\hypertarget{s2n__hkdf__test_8c_a9c6cabe5f7841673be19dbf9e8dad1a5}{}\label{s2n__hkdf__test_8c_a9c6cabe5f7841673be19dbf9e8dad1a5}


Definition at line 31 of file s2n\+\_\+hkdf.\+c.


\begin{DoxyCode}
32 \{
33     \textcolor{keyword}{struct }\hyperlink{structs2n__hmac__state}{s2n\_hmac\_state} hmac;
34     pseudo\_rand\_key->\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size} = \hyperlink{s2n__hmac_8c_ad9e0cc00ac39458cba7a9b1792429dbd}{s2n\_hmac\_digest\_size}(\hyperlink{structs2n__hmac__state_ae2daecd156006e6cf5c5800a7293628c}{alg});
35 
36     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__hmac_8c_ad5056a3fc151619a2935471a5861fc3d}{s2n\_hmac\_init}(&hmac, \hyperlink{structs2n__hmac__state_ae2daecd156006e6cf5c5800a7293628c}{alg}, salt->\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}, salt->
      \hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size}));
37     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__hmac_8c_a9dbba560a1ef91d4c2114c792f221333}{s2n\_hmac\_update}(&hmac, key->\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}, key->\hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size}));
38     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__hmac_8c_a4501c4b9ea25f86e9c6c0e9d1bd9276b}{s2n\_hmac\_digest}(&hmac, pseudo\_rand\_key->\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data}, pseudo\_rand\_key->
      \hyperlink{structs2n__blob_ab2c6b258f02add8fdf4cfc7c371dd772}{size}));
39 
40     \textcolor{keywordflow}{return} 0;
41 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__hkdf__test_8c_a9c6cabe5f7841673be19dbf9e8dad1a5_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{s2n__hkdf__test_8c_a9c6cabe5f7841673be19dbf9e8dad1a5_icgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+hkdf\+\_\+test.\+c@{s2n\+\_\+hkdf\+\_\+test.\+c}!main@{main}}
\index{main@{main}!s2n\+\_\+hkdf\+\_\+test.\+c@{s2n\+\_\+hkdf\+\_\+test.\+c}}
\subsubsection[{\texorpdfstring{main(int argc, char $\ast$$\ast$argv)}{main(int argc, char **argv)}}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$$\ast$}]{argv}
\end{DoxyParamCaption}
)}\hypertarget{s2n__hkdf__test_8c_a3c04138a5bfe5d72780bb7e82a18e627}{}\label{s2n__hkdf__test_8c_a3c04138a5bfe5d72780bb7e82a18e627}


Definition at line 520 of file s2n\+\_\+hkdf\+\_\+test.\+c.


\begin{DoxyCode}
521 \{
522     uint8\_t prk\_pad[\hyperlink{s2n__hkdf__test_8c_ae0c24c56d2a1fb1fcec4475dbd8dc05f}{MAX\_PSEUDO\_RAND\_KEY\_SIZE}];
523     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} prk\_result = \{ .\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = prk\_pad, .size = \textcolor{keyword}{sizeof}(prk\_pad) \};
524 
525     uint8\_t output\_pad[\hyperlink{s2n__hkdf__test_8c_a28d683cf067736d76f867f30c066317e}{MAX\_OUTPUT\_SIZE}];
526     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} out\_result = \{ .\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = output\_pad, .size = \textcolor{keyword}{sizeof}(output\_pad) \};
527 
528     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} in\_key\_blob, salt\_blob, info\_blob, actual\_prk\_blob, actual\_output\_blob;
529 
530     \hyperlink{s2n__test_8h_abef58b8851265310b43e5b6d8c1d2ff5}{BEGIN\_TEST}();
531 
532     \textcolor{keywordflow}{for} (uint8\_t i = 0; i < \hyperlink{s2n__hkdf__test_8c_a513819cf6a35e11aa0bb36eeb6601dc2}{NUM\_TESTS}; i++) \{
533         \textcolor{keyword}{struct }\hyperlink{structhkdf__test__vector}{hkdf\_test\_vector} *test = &tests[i];
534 
535         \hyperlink{s2n__blob_8c_a1d3a7f2981b29945a491b6b8cf791c87}{s2n\_blob\_init}(&in\_key\_blob, test->\hyperlink{structhkdf__test__vector_a8d746c85ffd247aeb96e29e45c20f94b}{in\_key}, test->
      \hyperlink{structhkdf__test__vector_ae4d3be84b6200c352c5df57bba47318e}{in\_key\_len});
536         \hyperlink{s2n__blob_8c_a1d3a7f2981b29945a491b6b8cf791c87}{s2n\_blob\_init}(&salt\_blob, test->\hyperlink{structhkdf__test__vector_abc17a7721bf086ccd67438bbf98a6dd8}{salt}, test->\hyperlink{structhkdf__test__vector_ae83f31f92af369e96c05df96c88d07aa}{salt\_len});
537         \hyperlink{s2n__blob_8c_a1d3a7f2981b29945a491b6b8cf791c87}{s2n\_blob\_init}(&info\_blob, test->\hyperlink{structhkdf__test__vector_aa62dace5a347bb15b58f40c6bb176488}{info}, test->\hyperlink{structhkdf__test__vector_a5d731d05384f812f4a53d5e254d9af21}{info\_len});
538         \hyperlink{s2n__blob_8c_a1d3a7f2981b29945a491b6b8cf791c87}{s2n\_blob\_init}(&actual\_prk\_blob, test->\hyperlink{structhkdf__test__vector_aa1c8395b21f400e367891c731063d2b9}{pseudo\_rand\_key}, test->
      \hyperlink{structhkdf__test__vector_ab2af0084520eaeac6ed5d0fe2bad1b96}{prk\_len});
539         \hyperlink{s2n__blob_8c_a1d3a7f2981b29945a491b6b8cf791c87}{s2n\_blob\_init}(&actual\_output\_blob, test->\hyperlink{structhkdf__test__vector_ad90e7e2e9491902d6b4f4ebbce6c56b1}{output}, test->
      \hyperlink{structhkdf__test__vector_a050d5038dbe2b4ba61d06c8a5b89382a}{output\_len});
540 
541         \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hkdf__test_8c_a9c6cabe5f7841673be19dbf9e8dad1a5}{s2n\_hkdf\_extract}(test->\hyperlink{structhkdf__test__vector_ae2daecd156006e6cf5c5800a7293628c}{alg}, &salt\_blob, &
      in\_key\_blob, &prk\_result));
542         \hyperlink{s2n__test_8h_aea4dfdd3a9d6afc7bbb40248a8437774}{EXPECT\_EQUAL}(memcmp(prk\_pad, actual\_prk\_blob.data, actual\_prk\_blob.size), 0);
543 
544         \hyperlink{s2n__test_8h_ad26d98d36bb5f8a59a90fe3a16d0297e}{EXPECT\_SUCCESS}(\hyperlink{s2n__hkdf_8c_a069710311186e543d82671356990fa80}{s2n\_hkdf}(test->\hyperlink{structhkdf__test__vector_ae2daecd156006e6cf5c5800a7293628c}{alg}, &salt\_blob, &in\_key\_blob, &info\_blob, &
      out\_result));
545         \hyperlink{s2n__test_8h_aea4dfdd3a9d6afc7bbb40248a8437774}{EXPECT\_EQUAL}(memcmp(output\_pad, actual\_output\_blob.data, actual\_output\_blob.size), 0);
546     \}
547 
548     \textcolor{comment}{/* This size (5101) is obtained by multiplying the digest size for}
549 \textcolor{comment}{     * SHA1 (20) by the maximum number of rounds allowed for HKDF (255),}
550 \textcolor{comment}{     * then adding 1}
551 \textcolor{comment}{     */}
552     uint8\_t error\_out\_pad[5101];
553     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} error\_out = \{ .\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = error\_out\_pad, .size = \textcolor{keyword}{sizeof}(error\_out\_pad) \};
554     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} zero\_out = \{ .\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = output\_pad, .size = 0 \};
555 
556     \hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8}{s2n\_hmac\_algorithm} alg = \hyperlink{s2n__hmac_8h_a05e34c658a0066b52f746b931d53dbf8a4c54826ffafbb42002b6097db113a742}{S2N\_HMAC\_SHA1};
557 
558     \hyperlink{s2n__test_8h_aeb59a103f4f1f44916f910eb73080c3e}{EXPECT\_FAILURE}(\hyperlink{s2n__hkdf_8c_a069710311186e543d82671356990fa80}{s2n\_hkdf}(alg, &salt\_blob, &in\_key\_blob, &info\_blob, &error\_out));
559     \hyperlink{s2n__test_8h_aeb59a103f4f1f44916f910eb73080c3e}{EXPECT\_FAILURE}(\hyperlink{s2n__hkdf_8c_a069710311186e543d82671356990fa80}{s2n\_hkdf}(alg, &salt\_blob, &in\_key\_blob, &info\_blob, &zero\_out));
560 
561     \hyperlink{s2n__test_8h_a45a83f30c32ca6265c28a1bef6dbe046}{END\_TEST}();
562 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__hkdf__test_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph}
\end{center}
\end{figure}


