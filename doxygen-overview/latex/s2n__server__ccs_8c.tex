\hypertarget{s2n__server__ccs_8c}{}\section{s2n-\/master/tls/s2n\+\_\+server\+\_\+ccs.c File Reference}
\label{s2n__server__ccs_8c}\index{s2n-\/master/tls/s2n\+\_\+server\+\_\+ccs.\+c@{s2n-\/master/tls/s2n\+\_\+server\+\_\+ccs.\+c}}
{\ttfamily \#include $<$stdint.\+h$>$}\\*
{\ttfamily \#include \char`\"{}error/s2n\+\_\+errno.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+connection.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+tls.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stuffer/s2n\+\_\+stuffer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+safety.\+h\char`\"{}}\\*
Include dependency graph for s2n\+\_\+server\+\_\+ccs.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__server__ccs_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{s2n__server__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}{C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE}~1
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{s2n__server__ccs_8c_ae06266c2514a2576c570f3f01d9f9ecf}{s2n\+\_\+server\+\_\+ccs\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__server__ccs_8c_ad4c716e8d39e6bb93acba86ccda02554}{s2n\+\_\+server\+\_\+ccs\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{s2n\+\_\+server\+\_\+ccs.\+c@{s2n\+\_\+server\+\_\+ccs.\+c}!C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE@{C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE}}
\index{C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE@{C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE}!s2n\+\_\+server\+\_\+ccs.\+c@{s2n\+\_\+server\+\_\+ccs.\+c}}
\subsubsection[{\texorpdfstring{C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE}{CHANGE_CIPHER_SPEC_TYPE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\+H\+A\+N\+G\+E\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+S\+P\+E\+C\+\_\+\+T\+Y\+PE~1}\hypertarget{s2n__server__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}{}\label{s2n__server__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}


Definition at line 28 of file s2n\+\_\+server\+\_\+ccs.\+c.



\subsection{Function Documentation}
\index{s2n\+\_\+server\+\_\+ccs.\+c@{s2n\+\_\+server\+\_\+ccs.\+c}!s2n\+\_\+server\+\_\+ccs\+\_\+recv@{s2n\+\_\+server\+\_\+ccs\+\_\+recv}}
\index{s2n\+\_\+server\+\_\+ccs\+\_\+recv@{s2n\+\_\+server\+\_\+ccs\+\_\+recv}!s2n\+\_\+server\+\_\+ccs.\+c@{s2n\+\_\+server\+\_\+ccs.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+ccs\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_ccs_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+ccs\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__server__ccs_8c_ae06266c2514a2576c570f3f01d9f9ecf}{}\label{s2n__server__ccs_8c_ae06266c2514a2576c570f3f01d9f9ecf}


Definition at line 30 of file s2n\+\_\+server\+\_\+ccs.\+c.


\begin{DoxyCode}
31 \{
32     uint8\_t \hyperlink{crypto_2x509_2x509_8h_ab512b8f495325c7ea0f5a5a5d3f938eb}{type};
33 
34     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a1178687b6091eb483d135c149e87fb0b}{s2n\_stuffer\_read\_uint8}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, &type));
35     \textcolor{keywordflow}{if} (type != \hyperlink{s2n__server__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}{CHANGE\_CIPHER\_SPEC\_TYPE}) \{
36         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
37     \}
38 
39     \textcolor{comment}{/* Zero the sequence number */}
40     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} seq = \{.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_a286710aff413808336b2f294554c7e55}{server\_sequence\_number},.size = \hyperlink{tls_2s2n__crypto_8h_ab6af529d3a237c0d8d2f67edcf831c25}{S2N\_TLS\_SEQUENCE\_NUM\_LEN} \};
41     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__blob_8c_a241c17ca2593704ff88734d13659a877}{s2n\_blob\_zero}(&seq));
42 
43     \textcolor{comment}{/* Compute the finished message */}
44     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a4d977ca107f8b2ac76823eb6281ca69b}{s2n\_prf\_server\_finished}(conn));
45 
46     \textcolor{comment}{/* Update the secure state to active, and point the client at the active state */}
47     conn->\hyperlink{structs2n__connection_abfab1f3796089e3576e73286c0b6889c}{server} = &conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure};
48 
49     \textcolor{comment}{/* Flush any partial alert messages that were pending */}
50     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_a2b6b54f7856d92f06f823bc26d10f4ba}{s2n\_stuffer\_wipe}(&conn->\hyperlink{structs2n__connection_a628dd7fe79c7cfd5f7bc02da8a270752}{alert\_in}));
51 
52     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a8b8974068a8f2c38a061ffb495a5ca1c}{handshake\_type} == RESUME) \{
53         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a1425bb608ed69a0cc582af0a57955e1f}{s2n\_prf\_key\_expansion}(conn));
54     \}
55 
56     \textcolor{keywordflow}{return} 0;
57 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__server__ccs_8c_ae06266c2514a2576c570f3f01d9f9ecf_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+server\+\_\+ccs.\+c@{s2n\+\_\+server\+\_\+ccs.\+c}!s2n\+\_\+server\+\_\+ccs\+\_\+send@{s2n\+\_\+server\+\_\+ccs\+\_\+send}}
\index{s2n\+\_\+server\+\_\+ccs\+\_\+send@{s2n\+\_\+server\+\_\+ccs\+\_\+send}!s2n\+\_\+server\+\_\+ccs.\+c@{s2n\+\_\+server\+\_\+ccs.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+server\+\_\+ccs\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_server_ccs_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+server\+\_\+ccs\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__server__ccs_8c_ad4c716e8d39e6bb93acba86ccda02554}{}\label{s2n__server__ccs_8c_ad4c716e8d39e6bb93acba86ccda02554}


Definition at line 59 of file s2n\+\_\+server\+\_\+ccs.\+c.


\begin{DoxyCode}
60 \{
61     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_aaca63d5bb519a92734bd0287199a7f5a}{s2n\_stuffer\_write\_uint8}(&conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.
      \hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, \hyperlink{s2n__server__ccs_8c_ae679d5e1291a1f62c6e66ae2f2404703}{CHANGE\_CIPHER\_SPEC\_TYPE}));
62 
63     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a8b8974068a8f2c38a061ffb495a5ca1c}{handshake\_type} == RESUME) \{
64         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a1425bb608ed69a0cc582af0a57955e1f}{s2n\_prf\_key\_expansion}(conn));
65     \}
66 
67     \textcolor{keywordflow}{return} 0;
68 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__server__ccs_8c_ad4c716e8d39e6bb93acba86ccda02554_cgraph}
\end{center}
\end{figure}


