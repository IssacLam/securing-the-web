\hypertarget{s2n__client__finished_8c}{}\section{s2n-\/master/tls/s2n\+\_\+client\+\_\+finished.c File Reference}
\label{s2n__client__finished_8c}\index{s2n-\/master/tls/s2n\+\_\+client\+\_\+finished.\+c@{s2n-\/master/tls/s2n\+\_\+client\+\_\+finished.\+c}}
{\ttfamily \#include $<$stdint.\+h$>$}\\*
{\ttfamily \#include \char`\"{}error/s2n\+\_\+errno.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+connection.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tls/s2n\+\_\+tls.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}stuffer/s2n\+\_\+stuffer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}utils/s2n\+\_\+safety.\+h\char`\"{}}\\*
Include dependency graph for s2n\+\_\+client\+\_\+finished.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__client__finished_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{s2n__client__finished_8c_a1e5af2e3c7ad308eb7a32333210875f5}{s2n\+\_\+client\+\_\+finished\+\_\+recv} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\item 
int \hyperlink{s2n__client__finished_8c_ac384b39fb82314ba9d3d4aebbae8f0e3}{s2n\+\_\+client\+\_\+finished\+\_\+send} (struct \hyperlink{structs2n__connection}{s2n\+\_\+connection} $\ast$conn)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{s2n\+\_\+client\+\_\+finished.\+c@{s2n\+\_\+client\+\_\+finished.\+c}!s2n\+\_\+client\+\_\+finished\+\_\+recv@{s2n\+\_\+client\+\_\+finished\+\_\+recv}}
\index{s2n\+\_\+client\+\_\+finished\+\_\+recv@{s2n\+\_\+client\+\_\+finished\+\_\+recv}!s2n\+\_\+client\+\_\+finished.\+c@{s2n\+\_\+client\+\_\+finished.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+finished\+\_\+recv(struct s2n\+\_\+connection $\ast$conn)}{s2n_client_finished_recv(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+finished\+\_\+recv (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__client__finished_8c_a1e5af2e3c7ad308eb7a32333210875f5}{}\label{s2n__client__finished_8c_a1e5af2e3c7ad308eb7a32333210875f5}


Definition at line 27 of file s2n\+\_\+client\+\_\+finished.\+c.


\begin{DoxyCode}
28 \{
29     uint8\_t *our\_version;
30 
31     our\_version = conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a2855df54edee8fcbca0272bfa74784ca}{client\_finished};
32     uint8\_t *their\_version = \hyperlink{s2n__stuffer_8c_a5148294f6ed0bf894afc83a31ee4f8a5}{s2n\_stuffer\_raw\_read}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, \hyperlink{tls_2s2n__crypto_8h_a325fdff46d03553d7962ab1a878bcec1}{S2N\_TLS\_FINISHED\_LEN});
33     \hyperlink{s2n__safety_8h_a372ad5deb70573456ecde442c0c466be}{notnull\_check}(their\_version);
34 
35     \textcolor{keywordflow}{if} (!\hyperlink{s2n__server__fuzz__test__overrides_8c_a407f3056ab784369c0ccb3359532669a}{s2n\_constant\_time\_equals}(our\_version, their\_version, 
      \hyperlink{tls_2s2n__crypto_8h_a325fdff46d03553d7962ab1a878bcec1}{S2N\_TLS\_FINISHED\_LEN}) || conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a65e2d8c6247963b90c9c2e3d574b0319}{rsa\_failed}) \{
36         \hyperlink{s2n__errno_8h_a4728100d8e1cd9097e9318a7e9fed9a9}{S2N\_ERROR}(\hyperlink{s2n__errno_8h_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb}{S2N\_ERR\_BAD\_MESSAGE});
37     \}
38 
39     \textcolor{keywordflow}{return} 0;
40 \}
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__client__finished_8c_a1e5af2e3c7ad308eb7a32333210875f5_cgraph}
\end{center}
\end{figure}


\index{s2n\+\_\+client\+\_\+finished.\+c@{s2n\+\_\+client\+\_\+finished.\+c}!s2n\+\_\+client\+\_\+finished\+\_\+send@{s2n\+\_\+client\+\_\+finished\+\_\+send}}
\index{s2n\+\_\+client\+\_\+finished\+\_\+send@{s2n\+\_\+client\+\_\+finished\+\_\+send}!s2n\+\_\+client\+\_\+finished.\+c@{s2n\+\_\+client\+\_\+finished.\+c}}
\subsubsection[{\texorpdfstring{s2n\+\_\+client\+\_\+finished\+\_\+send(struct s2n\+\_\+connection $\ast$conn)}{s2n_client_finished_send(struct s2n_connection *conn)}}]{\setlength{\rightskip}{0pt plus 5cm}int s2n\+\_\+client\+\_\+finished\+\_\+send (
\begin{DoxyParamCaption}
\item[{struct {\bf s2n\+\_\+connection} $\ast$}]{conn}
\end{DoxyParamCaption}
)}\hypertarget{s2n__client__finished_8c_ac384b39fb82314ba9d3d4aebbae8f0e3}{}\label{s2n__client__finished_8c_ac384b39fb82314ba9d3d4aebbae8f0e3}


Definition at line 42 of file s2n\+\_\+client\+\_\+finished.\+c.


\begin{DoxyCode}
43 \{
44     uint8\_t *our\_version;
45 
46     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__prf_8c_a809931120983e64ed6602dbac2b9b1fc}{s2n\_prf\_client\_finished}(conn));
47 
48     \textcolor{keyword}{struct }\hyperlink{structs2n__blob}{s2n\_blob} seq = \{.\hyperlink{structs2n__blob_abe222f6d3581e7920dcad5306cc906a8}{data} = conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_ab7767b5b58441b15ac1028ac18b06ef1}{client\_sequence\_number},.size = \textcolor{keyword}{sizeof}(conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure}.
      \hyperlink{structs2n__crypto__parameters_ab7767b5b58441b15ac1028ac18b06ef1}{client\_sequence\_number}) \};
49     \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__blob_8c_a241c17ca2593704ff88734d13659a877}{s2n\_blob\_zero}(&seq));
50     our\_version = conn->\hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_a2855df54edee8fcbca0272bfa74784ca}{client\_finished};
51 
52     \textcolor{comment}{/* Update the server to use the cipher suite */}
53     conn->\hyperlink{structs2n__connection_a052f81d7dc7e2612341fe0da1e749ebd}{client} = &conn->\hyperlink{structs2n__connection_aaa284f060d5075d1526931181d9e4fa7}{secure};
54 
55     \textcolor{keywordflow}{if} (conn->\hyperlink{structs2n__connection_af9b47a1de13de52e7beddb948a40fec1}{actual\_protocol\_version} == \hyperlink{s2n_8h_a457805749bd152786e9e344a5b22ab67}{S2N\_SSLv3}) \{
56         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, our\_version, \hyperlink{tls_2s2n__crypto_8h_a687b2e6f366133714257fc7e9d6537bd}{S2N\_SSL\_FINISHED\_LEN}));
57     \} \textcolor{keywordflow}{else} \{
58         \hyperlink{s2n__safety_8h_ad400572229cc8e40f7996837deb680f3}{GUARD}(\hyperlink{s2n__stuffer_8c_afe5e2db5400000f371d2245e1e0669eb}{s2n\_stuffer\_write\_bytes}(&conn->
      \hyperlink{structs2n__connection_a902584c57c26269c7cbf42e4770ed356}{handshake}.\hyperlink{structs2n__handshake_aede0d4a81b6e474b17ea185025c45bfd}{io}, our\_version, \hyperlink{tls_2s2n__crypto_8h_a325fdff46d03553d7962ab1a878bcec1}{S2N\_TLS\_FINISHED\_LEN}));
59     \}
60 
61     \textcolor{keywordflow}{return} 0;
62 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{s2n__client__finished_8c_ac384b39fb82314ba9d3d4aebbae8f0e3_cgraph}
\end{center}
\end{figure}


