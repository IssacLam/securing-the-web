<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>s2n-doxygen-full: s2n-master/tls/s2n_tls.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">s2n-doxygen-full
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('s2n__tls_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">s2n_tls.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="s2n__connection_8h_source.html">tls/s2n_connection.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for s2n_tls.h:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h__incl.png" border="0" usemap="#s2n-master_2tls_2s2n__tls_8h" alt=""/></div>
<map name="s2n-master_2tls_2s2n__tls_8h" id="s2n-master_2tls_2s2n__tls_8h">
<area shape="rect" id="node3" href="s2n__connection_8h.html" title="tls/s2n_connection.h" alt="" coords="1925,92,2067,117"/>
<area shape="rect" id="node6" href="s2n_8h.html" title="s2n.h" alt="" coords="906,385,960,411"/>
<area shape="rect" id="node8" href="s2n__tls__parameters_8h.html" title="tls/s2n_tls_parameters.h" alt="" coords="1541,165,1707,191"/>
<area shape="rect" id="node9" href="s2n__handshake_8h.html" title="tls/s2n_handshake.h" alt="" coords="1782,165,1925,191"/>
<area shape="rect" id="node10" href="tls_2s2n__crypto_8h.html" title="tls/s2n_crypto.h" alt="" coords="1991,239,2105,264"/>
<area shape="rect" id="node11" href="s2n__config_8h.html" title="tls/s2n_config.h" alt="" coords="2092,312,2206,337"/>
<area shape="rect" id="node29" href="s2n__stuffer_8h.html" title="stuffer/s2n_stuffer.h" alt="" coords="2344,459,2482,484"/>
<area shape="rect" id="node31" href="s2n__hash_8h.html" title="crypto/s2n_hash.h" alt="" coords="1744,459,1874,484"/>
<area shape="rect" id="node49" href="s2n__hmac_8h.html" title="crypto/s2n_hmac.h" alt="" coords="2434,385,2568,411"/>
<area shape="rect" id="node52" href="s2n__prf_8h.html" title="tls/s2n_prf.h" alt="" coords="2546,312,2640,337"/>
<area shape="rect" id="node53" href="s2n__timer_8h.html" title="utils/s2n_timer.h" alt="" coords="2704,239,2821,264"/>
<area shape="rect" id="node54" href="s2n__mem_8h.html" title="utils/s2n_mem.h" alt="" coords="1949,459,2067,484"/>
<area shape="rect" id="node12" href="s2n__rsa_8h.html" title="crypto/s2n_rsa.h" alt="" coords="1992,385,2112,411"/>
<area shape="rect" id="node35" href="s2n__dhe_8h.html" title="crypto/s2n_dhe.h" alt="" coords="2237,385,2360,411"/>
<area shape="rect" id="node37" href="s2n__cipher_8h.html" title="crypto/s2n_cipher.h" alt="" coords="1324,312,1460,337"/>
<area shape="rect" id="node50" href="s2n__ecc_8h.html" title="crypto/s2n_ecc.h" alt="" coords="1744,385,1866,411"/>
<area shape="rect" id="node30" href="s2n__blob_8h.html" title="utils/s2n_blob.h" alt="" coords="2179,532,2293,557"/>
<area shape="rect" id="node13" href="include_2openssl_2rsa_8h.html" title="openssl/rsa.h" alt="" coords="1038,532,1138,557"/>
<area shape="rect" id="node14" href="include_2openssl_2asn1_8h.html" title="openssl/asn1.h" alt="" coords="506,605,617,631"/>
<area shape="rect" id="node17" href="include_2openssl_2bio_8h.html" title="openssl/bio.h" alt="" coords="782,679,882,704"/>
<area shape="rect" id="node20" href="include_2openssl_2crypto_8h.html" title="openssl/crypto.h" alt="" coords="518,752,637,777"/>
<area shape="rect" id="node25" href="include_2openssl_2ossl__typ_8h.html" title="openssl/ossl_typ.h" alt="" coords="937,825,1068,851"/>
<area shape="rect" id="node27" href="include_2openssl_2bn_8h.html" title="openssl/bn.h" alt="" coords="1040,679,1136,704"/>
<area shape="rect" id="node22" href="include_2openssl_2stack_8h.html" title="openssl/stack.h" alt="" coords="323,899,437,924"/>
<area shape="rect" id="node23" href="include_2openssl_2safestack_8h.html" title="openssl/safestack.h" alt="" coords="311,825,449,851"/>
<area shape="rect" id="node26" href="include_2openssl_2symhacks_8h.html" title="openssl/symhacks.h" alt="" coords="145,825,287,851"/>
<area shape="rect" id="node24" href="include_2openssl_2opensslv_8h.html" title="openssl/opensslv.h" alt="" coords="574,825,708,851"/>
<area shape="rect" id="node32" href="include_2openssl_2md5_8h.html" title="openssl/md5.h" alt="" coords="1773,532,1881,557"/>
<area shape="rect" id="node34" href="include_2openssl_2sha_8h.html" title="openssl/sha.h" alt="" coords="1646,532,1749,557"/>
<area shape="rect" id="node36" href="include_2openssl_2dh_8h.html" title="openssl/dh.h" alt="" coords="1220,605,1316,631"/>
<area shape="rect" id="node38" href="include_2openssl_2evp_8h.html" title="openssl/evp.h" alt="" coords="828,459,932,484"/>
<area shape="rect" id="node42" href="include_2openssl_2aes_8h.html" title="openssl/aes.h" alt="" coords="1315,532,1418,557"/>
<area shape="rect" id="node43" href="include_2openssl_2rc4_8h.html" title="openssl/rc4.h" alt="" coords="1467,459,1568,484"/>
<area shape="rect" id="node44" href="include_2openssl_2des_8h.html" title="openssl/des.h" alt="" coords="700,459,804,484"/>
<area shape="rect" id="node48" href="crypto_2s2n__crypto_8h.html" title="crypto/s2n_crypto.h" alt="" coords="1211,385,1349,411"/>
<area shape="rect" id="node39" href="include_2openssl_2opensslconf_8h.html" title="openssl/opensslconf.h" alt="" coords="1446,679,1599,704"/>
<area shape="rect" id="node40" href="include_2openssl_2objects_8h.html" title="openssl/objects.h" alt="" coords="608,532,733,557"/>
<area shape="rect" id="node41" href="include_2openssl_2obj__mac_8h.html" title="openssl/obj_mac.h" alt="" coords="298,605,430,631"/>
<area shape="rect" id="node45" href="include_2openssl_2des__old_8h.html" title="openssl/des_old.h" alt="" coords="44,532,172,557"/>
<area shape="rect" id="node46" href="include_2openssl_2ui__compat_8h.html" title="openssl/ui_compat.h" alt="" coords="692,605,836,631"/>
<area shape="rect" id="node47" href="include_2openssl_2ui_8h.html" title="openssl/ui.h" alt="" coords="666,679,758,704"/>
<area shape="rect" id="node51" href="include_2openssl_2ec_8h.html" title="openssl/ec.h" alt="" coords="917,532,1013,557"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h__dep__incl.png" border="0" usemap="#s2n-master_2tls_2s2n__tls_8hdep" alt=""/></div>
<map name="s2n-master_2tls_2s2n__tls_8hdep" id="s2n-master_2tls_2s2n__tls_8hdep">
<area shape="rect" id="node2" href="s2n__memory__leak__negative__test_8c.html" title="s2n&#45;master/tests/fuzz\l/s2n_memory_leak_negative\l_test.c" alt="" coords="5,92,197,144"/>
<area shape="rect" id="node3" href="s2n__server__fuzz__test_8c.html" title="s2n&#45;master/tests/fuzz\l/s2n_server_fuzz_test.c" alt="" coords="221,99,384,137"/>
<area shape="rect" id="node4" href="s2n__client__ccs_8c.html" title="s2n&#45;master/tls/s2n\l_client_ccs.c" alt="" coords="408,99,538,137"/>
<area shape="rect" id="node5" href="s2n__client__finished_8c.html" title="s2n&#45;master/tls/s2n\l_client_finished.c" alt="" coords="563,99,693,137"/>
<area shape="rect" id="node6" href="s2n__client__hello_8c.html" title="s2n&#45;master/tls/s2n\l_client_hello.c" alt="" coords="717,99,848,137"/>
<area shape="rect" id="node7" href="s2n__connection_8c.html" title="s2n&#45;master/tls/s2n\l_connection.c" alt="" coords="872,99,1002,137"/>
<area shape="rect" id="node8" href="s2n__handshake__io_8c.html" title="s2n&#45;master/tls/s2n\l_handshake_io.c" alt="" coords="1027,99,1157,137"/>
<area shape="rect" id="node9" href="s2n__ocsp__stapling_8c.html" title="s2n&#45;master/tls/s2n\l_ocsp_stapling.c" alt="" coords="1181,99,1312,137"/>
<area shape="rect" id="node10" href="s2n__recv_8c.html" title="s2n&#45;master/tls/s2n\l_recv.c" alt="" coords="1336,99,1466,137"/>
<area shape="rect" id="node11" href="s2n__server__ccs_8c.html" title="s2n&#45;master/tls/s2n\l_server_ccs.c" alt="" coords="1491,99,1621,137"/>
<area shape="rect" id="node12" href="s2n__server__cert_8c.html" title="s2n&#45;master/tls/s2n\l_server_cert.c" alt="" coords="1645,99,1776,137"/>
<area shape="rect" id="node13" href="s2n__server__done_8c.html" title="s2n&#45;master/tls/s2n\l_server_done.c" alt="" coords="1800,99,1930,137"/>
<area shape="rect" id="node14" href="s2n__server__extensions_8c.html" title="s2n&#45;master/tls/s2n\l_server_extensions.c" alt="" coords="1954,99,2102,137"/>
<area shape="rect" id="node15" href="s2n__server__finished_8c.html" title="s2n&#45;master/tls/s2n\l_server_finished.c" alt="" coords="2125,99,2256,137"/>
<area shape="rect" id="node16" href="s2n__server__hello_8c.html" title="s2n&#45;master/tls/s2n\l_server_hello.c" alt="" coords="2280,99,2410,137"/>
<area shape="rect" id="node17" href="s2n__shutdown_8c.html" title="s2n&#45;master/tls/s2n\l_shutdown.c" alt="" coords="2435,99,2565,137"/>
<area shape="rect" id="node18" href="s2n__tls_8c.html" title="s2n&#45;master/tls/s2n\l_tls.c" alt="" coords="2589,99,2720,137"/>
</map>
</div>
</div>
<p><a href="s2n__tls_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a20bacac680b48d51f2623a1d95e85ca8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a20bacac680b48d51f2623a1d95e85ca8">s2n_server_can_send_ocsp</a>(conn)</td></tr>
<tr class="separator:a20bacac680b48d51f2623a1d95e85ca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afd95cff0f0a33052ba2784ab1a1c14c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#afd95cff0f0a33052ba2784ab1a1c14c5">s2n_flush</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn, <a class="el" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> *more)</td></tr>
<tr class="separator:afd95cff0f0a33052ba2784ab1a1c14c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b86117a2a4f018991a01ff788272441"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a4b86117a2a4f018991a01ff788272441">s2n_client_hello_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a4b86117a2a4f018991a01ff788272441"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfb7d01ea645110aea3c808de4d86f1d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#abfb7d01ea645110aea3c808de4d86f1d">s2n_client_hello_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:abfb7d01ea645110aea3c808de4d86f1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1466c1ce812576f187dacd032e682e1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#ac1466c1ce812576f187dacd032e682e1">s2n_sslv2_client_hello_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:ac1466c1ce812576f187dacd032e682e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e32b708f98ecbfa1148c5393f8b9dba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a8e32b708f98ecbfa1148c5393f8b9dba">s2n_server_hello_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a8e32b708f98ecbfa1148c5393f8b9dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2139f810755eb8cf27ebea179e81ac81"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a2139f810755eb8cf27ebea179e81ac81">s2n_server_hello_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a2139f810755eb8cf27ebea179e81ac81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1bb9b2e08cb682e4bb9b156b49a0afa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#ab1bb9b2e08cb682e4bb9b156b49a0afa">s2n_server_cert_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:ab1bb9b2e08cb682e4bb9b156b49a0afa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea75ffb292cac5d71183fee7c14b7496"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#aea75ffb292cac5d71183fee7c14b7496">s2n_server_cert_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:aea75ffb292cac5d71183fee7c14b7496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4c440c5d4b149bdc7b42a1fdf06b334"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#af4c440c5d4b149bdc7b42a1fdf06b334">s2n_server_status_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:af4c440c5d4b149bdc7b42a1fdf06b334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6688277e6e5d779a28d99ec6d023a949"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a6688277e6e5d779a28d99ec6d023a949">s2n_server_status_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a6688277e6e5d779a28d99ec6d023a949"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a940aed548236e016710e5ef69dc98df8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a940aed548236e016710e5ef69dc98df8">s2n_server_key_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a940aed548236e016710e5ef69dc98df8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a933dc8cdaebb70f8a7364e390d9deeaf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a933dc8cdaebb70f8a7364e390d9deeaf">s2n_server_key_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a933dc8cdaebb70f8a7364e390d9deeaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a944852f699b2815f6a37b602113e26f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a944852f699b2815f6a37b602113e26f7">s2n_server_done_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a944852f699b2815f6a37b602113e26f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55414ad2a6f07ebbae51cbd0bf6f5974"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a55414ad2a6f07ebbae51cbd0bf6f5974">s2n_server_done_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a55414ad2a6f07ebbae51cbd0bf6f5974"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59294a875b6596b8dd5ad02a58e77c94"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a59294a875b6596b8dd5ad02a58e77c94">s2n_client_key_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a59294a875b6596b8dd5ad02a58e77c94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d0b0b0a8964b40aff5e3562bf65a9e1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a5d0b0b0a8964b40aff5e3562bf65a9e1">s2n_client_key_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a5d0b0b0a8964b40aff5e3562bf65a9e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9be1791dfd4b0af9525be21fb52ec4eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a9be1791dfd4b0af9525be21fb52ec4eb">s2n_client_ccs_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a9be1791dfd4b0af9525be21fb52ec4eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab9d53a394720e55e7648730f94bb176"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#aab9d53a394720e55e7648730f94bb176">s2n_client_ccs_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:aab9d53a394720e55e7648730f94bb176"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c716e8d39e6bb93acba86ccda02554"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#ad4c716e8d39e6bb93acba86ccda02554">s2n_server_ccs_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:ad4c716e8d39e6bb93acba86ccda02554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae06266c2514a2576c570f3f01d9f9ecf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#ae06266c2514a2576c570f3f01d9f9ecf">s2n_server_ccs_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:ae06266c2514a2576c570f3f01d9f9ecf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac384b39fb82314ba9d3d4aebbae8f0e3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#ac384b39fb82314ba9d3d4aebbae8f0e3">s2n_client_finished_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:ac384b39fb82314ba9d3d4aebbae8f0e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e5af2e3c7ad308eb7a32333210875f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a1e5af2e3c7ad308eb7a32333210875f5">s2n_client_finished_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a1e5af2e3c7ad308eb7a32333210875f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1faebdea4c42a7b27ce347885b9bd9ee"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a1faebdea4c42a7b27ce347885b9bd9ee">s2n_server_finished_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a1faebdea4c42a7b27ce347885b9bd9ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adae4d52456ffeb3a606ed1fb545539e4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#adae4d52456ffeb3a606ed1fb545539e4">s2n_server_finished_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:adae4d52456ffeb3a606ed1fb545539e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae327aa8441c888a0bfca0058761abd97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#ae327aa8441c888a0bfca0058761abd97">s2n_handshake_write_header</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn, uint8_t message_type)</td></tr>
<tr class="separator:ae327aa8441c888a0bfca0058761abd97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a9a88c8621eab4358a80bb384dd3a3a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a0a9a88c8621eab4358a80bb384dd3a3a">s2n_handshake_finish_header</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn)</td></tr>
<tr class="separator:a0a9a88c8621eab4358a80bb384dd3a3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8930886c2b7fb7a73ef11c9c7c3c3b42"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a8930886c2b7fb7a73ef11c9c7c3c3b42">s2n_handshake_parse_header</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn, uint8_t *message_type, uint32_t *<a class="el" href="include_2openssl_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a>)</td></tr>
<tr class="separator:a8930886c2b7fb7a73ef11c9c7c3c3b42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a807adeb1baad4849f782cfd4de10d113"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a807adeb1baad4849f782cfd4de10d113">s2n_read_full_record</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn, uint8_t *record_type, int *isSSLv2)</td></tr>
<tr class="separator:a807adeb1baad4849f782cfd4de10d113"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae859ce8ed78bbade19bf53c23cf6dec8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#ae859ce8ed78bbade19bf53c23cf6dec8">s2n_recv_close_notify</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn, <a class="el" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> *blocked)</td></tr>
<tr class="separator:ae859ce8ed78bbade19bf53c23cf6dec8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5693cff7b0838d6d62b5b9e70a1e17f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a5693cff7b0838d6d62b5b9e70a1e17f8">s2n_client_extensions_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn, struct <a class="el" href="structs2n__stuffer.html">s2n_stuffer</a> *out)</td></tr>
<tr class="separator:a5693cff7b0838d6d62b5b9e70a1e17f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53cfe69398f5503ced5ba7745c562e63"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a53cfe69398f5503ced5ba7745c562e63">s2n_client_extensions_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn, struct <a class="el" href="structs2n__blob.html">s2n_blob</a> *extensions)</td></tr>
<tr class="separator:a53cfe69398f5503ced5ba7745c562e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72b3e9fb3b4cb76a22e8d236609029ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a72b3e9fb3b4cb76a22e8d236609029ab">s2n_server_extensions_send</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn, struct <a class="el" href="structs2n__stuffer.html">s2n_stuffer</a> *out)</td></tr>
<tr class="separator:a72b3e9fb3b4cb76a22e8d236609029ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5973260f0a72187b1331e5633795fe9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#aa5973260f0a72187b1331e5633795fe9">s2n_server_extensions_recv</a> (struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *conn, struct <a class="el" href="structs2n__blob.html">s2n_blob</a> *extensions)</td></tr>
<tr class="separator:aa5973260f0a72187b1331e5633795fe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0cb08e556504a133390d419bf05db470"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="s2n__tls_8h.html#a0cb08e556504a133390d419bf05db470">s2n_highest_protocol_version</a></td></tr>
<tr class="separator:a0cb08e556504a133390d419bf05db470"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a20bacac680b48d51f2623a1d95e85ca8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define s2n_server_can_send_ocsp</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">conn</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">((conn)-&gt;status_type == <a class="code" href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8">S2N_STATUS_REQUEST_OCSP</a> &amp;&amp; \</div><div class="line">        (conn)-&gt;config-&gt;cert_and_key_pairs &amp;&amp; \</div><div class="line">        (conn)-&gt;<a class="code" href="apps_8h.html#a67aa6ff0076e9d4fb2b5ad9e6fcb4d89">config</a>-&gt;cert_and_key_pairs-&gt;ocsp_status.size &gt; 0)</div><div class="ttc" id="apps_8h_html_a67aa6ff0076e9d4fb2b5ad9e6fcb4d89"><div class="ttname"><a href="apps_8h.html#a67aa6ff0076e9d4fb2b5ad9e6fcb4d89">config</a></div><div class="ttdeci">CONF * config</div><div class="ttdef"><b>Definition:</b> <a href="apps_8h_source.html#l00146">apps.h:146</a></div></div>
<div class="ttc" id="s2n_8h_html_a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8"><div class="ttname"><a href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8">S2N_STATUS_REQUEST_OCSP</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00067">s2n.h:67</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="s2n__tls_8h_source.html#l00058">58</a> of file <a class="el" href="s2n__tls_8h_source.html">s2n_tls.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="afd95cff0f0a33052ba2784ab1a1c14c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_flush </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> *&#160;</td>
          <td class="paramname"><em>more</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__send_8c_source.html#l00034">34</a> of file <a class="el" href="s2n__send_8c_source.html">s2n_send.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">int</span> w;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    *blocked = <a class="code" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15daefb6db9aaec431d69fc4c1249bc432e3">S2N_BLOCKED_ON_WRITE</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">/* Write any data that&#39;s already pending */</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  WRITE:</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#aa4edd9e7ae7d0068c43a8c3d54073da0">out</a>)) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        w = <a class="code" href="s2n__stuffer_8h.html#a40bf61bc8745a2d894dd558a2885a66b">s2n_stuffer_send_to_fd</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#aa4edd9e7ae7d0068c43a8c3d54073da0">out</a>, conn-&gt;<a class="code" href="structs2n__connection.html#abb118879baad1066df4d078fdb2da908">writefd</a>, <a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#aa4edd9e7ae7d0068c43a8c3d54073da0">out</a>));</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">if</span> (w &lt; 0) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_mac_socket_8cpp.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> == EWOULDBLOCK) {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374a440a0e3a40ff1c680a455803a9dd9dfc">S2N_ERR_BLOCKED</a>);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ae8ab0b843d6f8172ea5f923aaf083374">S2N_ERR_IO</a>);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        }</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        conn-&gt;<a class="code" href="structs2n__connection.html#ad34101c7be957b19718d9e9047e1af39">wire_bytes_out</a> += w;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#afaf913ae0bd2fe2866608f51060791a2">closing</a>) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        conn-&gt;<a class="code" href="structs2n__connection.html#a9e746c5b2dde4a77b710780924853c2f">closed</a> = 1;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="comment">/* Delay wiping for close_notify. s2n_shutdown() needs to wait for peer&#39;s close_notify */</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">if</span> (!conn-&gt;<a class="code" href="structs2n__connection.html#a1ba9fe08a4f37494def44e02d95a2ffa">close_notify_queued</a>) {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n_8h.html#aa869211ca9b49f497cdb5579935203de">s2n_connection_wipe</a>(conn));</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ae1b97eb16ae517a82ec90a0e2b8c48e7">s2n_stuffer_rewrite</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#aa4edd9e7ae7d0068c43a8c3d54073da0">out</a>));</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">/* If there&#39;s an alert pending out, send that */</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a00dd2a749a85d247561da67ec248d3e1">reader_alert_out</a>) == 2) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> alert;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        alert.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = conn-&gt;<a class="code" href="structs2n__connection.html#a00dd2a749a85d247561da67ec248d3e1">reader_alert_out</a>.<a class="code" href="structs2n__stuffer.html#ab95f00f583f1cb41ae00918e9ea180c9">blob</a>.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        alert.size = 2;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__record_8h.html#a345384c81da35d41574e7a2c8319c7e3">s2n_record_write</a>(conn, <a class="code" href="s2n__fragmentation__coalescing__test_8c.html#afe02a145f0d3a71b14d61e2774987f9d">TLS_ALERT</a>, &amp;alert));</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ae1b97eb16ae517a82ec90a0e2b8c48e7">s2n_stuffer_rewrite</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a00dd2a749a85d247561da67ec248d3e1">reader_alert_out</a>));</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        conn-&gt;<a class="code" href="structs2n__connection.html#afaf913ae0bd2fe2866608f51060791a2">closing</a> = 1;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="comment">/* Actually write it ... */</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">goto</span> WRITE;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">/* Do the same for writer driven alerts */</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a6168f6d8f8b3d65bc1d566091149ddf4">writer_alert_out</a>) == 2) {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> alert;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        alert.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = conn-&gt;<a class="code" href="structs2n__connection.html#a6168f6d8f8b3d65bc1d566091149ddf4">writer_alert_out</a>.<a class="code" href="structs2n__stuffer.html#ab95f00f583f1cb41ae00918e9ea180c9">blob</a>.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        alert.size = 2;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__record_8h.html#a345384c81da35d41574e7a2c8319c7e3">s2n_record_write</a>(conn, <a class="code" href="s2n__fragmentation__coalescing__test_8c.html#afe02a145f0d3a71b14d61e2774987f9d">TLS_ALERT</a>, &amp;alert));</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ae1b97eb16ae517a82ec90a0e2b8c48e7">s2n_stuffer_rewrite</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a6168f6d8f8b3d65bc1d566091149ddf4">writer_alert_out</a>));</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        conn-&gt;<a class="code" href="structs2n__connection.html#afaf913ae0bd2fe2866608f51060791a2">closing</a> = 1;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">/* Actually write it ... */</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">goto</span> WRITE;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    *blocked = <a class="code" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd">S2N_NOT_BLOCKED</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div><div class="ttc" id="s2n__stuffer_8c_html_ae1b97eb16ae517a82ec90a0e2b8c48e7"><div class="ttname"><a href="s2n__stuffer_8c.html#ae1b97eb16ae517a82ec90a0e2b8c48e7">s2n_stuffer_rewrite</a></div><div class="ttdeci">int s2n_stuffer_rewrite(struct s2n_stuffer *stuffer)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00102">s2n_stuffer.c:102</a></div></div>
<div class="ttc" id="structs2n__connection_html_aa4edd9e7ae7d0068c43a8c3d54073da0"><div class="ttname"><a href="structs2n__connection.html#aa4edd9e7ae7d0068c43a8c3d54073da0">s2n_connection::out</a></div><div class="ttdeci">struct s2n_stuffer out</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00092">s2n_connection.h:92</a></div></div>
<div class="ttc" id="structs2n__connection_html_ad34101c7be957b19718d9e9047e1af39"><div class="ttname"><a href="structs2n__connection.html#ad34101c7be957b19718d9e9047e1af39">s2n_connection::wire_bytes_out</a></div><div class="ttdeci">uint64_t wire_bytes_out</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00127">s2n_connection.h:127</a></div></div>
<div class="ttc" id="s2n__stuffer_8h_html_a56d3da0e05e4c05eb87a343306c4f170"><div class="ttname"><a href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a></div><div class="ttdeci">#define s2n_stuffer_data_available(s)  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00045">s2n_stuffer.h:45</a></div></div>
<div class="ttc" id="s2n__fragmentation__coalescing__test_8c_html_afe02a145f0d3a71b14d61e2774987f9d"><div class="ttname"><a href="s2n__fragmentation__coalescing__test_8c.html#afe02a145f0d3a71b14d61e2774987f9d">TLS_ALERT</a></div><div class="ttdeci">#define TLS_ALERT</div><div class="ttdef"><b>Definition:</b> <a href="s2n__fragmentation__coalescing__test_8c_source.html#l00037">s2n_fragmentation_coalescing_test.c:37</a></div></div>
<div class="ttc" id="_mac_socket_8cpp_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="_mac_socket_8cpp.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374a440a0e3a40ff1c680a455803a9dd9dfc"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374a440a0e3a40ff1c680a455803a9dd9dfc">S2N_ERR_BLOCKED</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00045">s2n_errno.h:45</a></div></div>
<div class="ttc" id="structs2n__connection_html_afaf913ae0bd2fe2866608f51060791a2"><div class="ttname"><a href="structs2n__connection.html#afaf913ae0bd2fe2866608f51060791a2">s2n_connection::closing</a></div><div class="ttdeci">sig_atomic_t closing</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00142">s2n_connection.h:142</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="structs2n__connection_html_a6168f6d8f8b3d65bc1d566091149ddf4"><div class="ttname"><a href="structs2n__connection.html#a6168f6d8f8b3d65bc1d566091149ddf4">s2n_connection::writer_alert_out</a></div><div class="ttdeci">struct s2n_stuffer writer_alert_out</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00115">s2n_connection.h:115</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="s2n_8h_html_aa869211ca9b49f497cdb5579935203de"><div class="ttname"><a href="s2n_8h.html#aa869211ca9b49f497cdb5579935203de">s2n_connection_wipe</a></div><div class="ttdeci">int s2n_connection_wipe(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8c_source.html#l00152">s2n_connection.c:152</a></div></div>
<div class="ttc" id="s2n__record_8h_html_a345384c81da35d41574e7a2c8319c7e3"><div class="ttname"><a href="s2n__record_8h.html#a345384c81da35d41574e7a2c8319c7e3">s2n_record_write</a></div><div class="ttdeci">int s2n_record_write(struct s2n_connection *conn, uint8_t content_type, struct s2n_blob *in)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__record__write_8c_source.html#l00079">s2n_record_write.c:79</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="structs2n__stuffer_html_ab95f00f583f1cb41ae00918e9ea180c9"><div class="ttname"><a href="structs2n__stuffer.html#ab95f00f583f1cb41ae00918e9ea180c9">s2n_stuffer::blob</a></div><div class="ttdeci">struct s2n_blob blob</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00025">s2n_stuffer.h:25</a></div></div>
<div class="ttc" id="s2n__stuffer_8h_html_a40bf61bc8745a2d894dd558a2885a66b"><div class="ttname"><a href="s2n__stuffer_8h.html#a40bf61bc8745a2d894dd558a2885a66b">s2n_stuffer_send_to_fd</a></div><div class="ttdeci">int s2n_stuffer_send_to_fd(struct s2n_stuffer *stuffer, int wfd, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer__file_8c_source.html#l00055">s2n_stuffer_file.c:55</a></div></div>
<div class="ttc" id="s2n_8h_html_af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd"><div class="ttname"><a href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd">S2N_NOT_BLOCKED</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00091">s2n.h:91</a></div></div>
<div class="ttc" id="structs2n__connection_html_a1ba9fe08a4f37494def44e02d95a2ffa"><div class="ttname"><a href="structs2n__connection.html#a1ba9fe08a4f37494def44e02d95a2ffa">s2n_connection::close_notify_queued</a></div><div class="ttdeci">unsigned int close_notify_queued</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00118">s2n_connection.h:118</a></div></div>
<div class="ttc" id="structs2n__connection_html_a9e746c5b2dde4a77b710780924853c2f"><div class="ttname"><a href="structs2n__connection.html#a9e746c5b2dde4a77b710780924853c2f">s2n_connection::closed</a></div><div class="ttdeci">sig_atomic_t closed</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00143">s2n_connection.h:143</a></div></div>
<div class="ttc" id="structs2n__connection_html_abb118879baad1066df4d078fdb2da908"><div class="ttname"><a href="structs2n__connection.html#abb118879baad1066df4d078fdb2da908">s2n_connection::writefd</a></div><div class="ttdeci">int writefd</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00045">s2n_connection.h:45</a></div></div>
<div class="ttc" id="structs2n__connection_html_a00dd2a749a85d247561da67ec248d3e1"><div class="ttname"><a href="structs2n__connection.html#a00dd2a749a85d247561da67ec248d3e1">s2n_connection::reader_alert_out</a></div><div class="ttdeci">struct s2n_stuffer reader_alert_out</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00114">s2n_connection.h:114</a></div></div>
<div class="ttc" id="s2n_8h_html_af70ca0b089daa98cd79a424d3f6af15daefb6db9aaec431d69fc4c1249bc432e3"><div class="ttname"><a href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15daefb6db9aaec431d69fc4c1249bc432e3">S2N_BLOCKED_ON_WRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00091">s2n.h:91</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ae8ab0b843d6f8172ea5f923aaf083374"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ae8ab0b843d6f8172ea5f923aaf083374">S2N_ERR_IO</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00041">s2n_errno.h:41</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5_cgraph.png" border="0" usemap="#s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5_cgraph" alt=""/></div>
<map name="s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5_cgraph" id="s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8h.html#a40bf61bc8745a2d894dd558a2885a66b" title="s2n_stuffer_send_to_fd" alt="" coords="132,99,292,124"/>
<area shape="rect" id="node4" href="s2n_8h.html#aa869211ca9b49f497cdb5579935203de" title="s2n_connection_wipe" alt="" coords="137,217,287,243"/>
<area shape="rect" id="node33" href="s2n__stuffer_8c.html#ae1b97eb16ae517a82ec90a0e2b8c48e7" title="s2n_stuffer_rewrite" alt="" coords="371,1349,506,1375"/>
<area shape="rect" id="node34" href="s2n__record_8h.html#a345384c81da35d41574e7a2c8319c7e3" title="s2n_record_write" alt="" coords="150,908,274,933"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="363,5,515,31"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#a2b6b54f7856d92f06f823bc26d10f4ba" title="s2n_stuffer_wipe" alt="" coords="1215,231,1337,256"/>
<area shape="rect" id="node7" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1211,505,1341,531"/>
<area shape="rect" id="node10" href="s2n__hash_8c.html#a684a3779eebad8329d41443454dd6fa2" title="s2n_hash_init" alt="" coords="829,280,932,305"/>
<area shape="rect" id="node17" href="s2n__hmac_8c.html#ad5056a3fc151619a2935471a5861fc3d" title="s2n_hmac_init" alt="" coords="385,571,492,596"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1389,455,1526,480"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1413,505,1502,531"/>
<area shape="rect" id="node9" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1574,505,1647,531"/>
<area shape="rect" id="node11" href="crypto_2md5_2md5_8h.html#ae06ac750835b8cb838b6be5986ddcad9" title="MD5_Init" alt="" coords="1049,355,1124,380"/>
<area shape="rect" id="node12" href="crypto_2sha_2sha_8h.html#ad954eeef9b6210b817502847aea169fa" title="SHA1_Init" alt="" coords="1046,404,1127,429"/>
<area shape="rect" id="node13" href="crypto_2sha_2sha_8h.html#ab3befdb5a3202fa6d2eda5f3a06eadfa" title="SHA224_Init" alt="" coords="1038,157,1134,183"/>
<area shape="rect" id="node14" href="crypto_2sha_2sha_8h.html#ac96292b35fd2d8387259000aa378ae0d" title="SHA256_Init" alt="" coords="1038,207,1134,232"/>
<area shape="rect" id="node15" href="crypto_2sha_2sha_8h.html#ab7ca087b2f4896acc5a9e55a018fb99c" title="SHA384_Init" alt="" coords="1038,256,1134,281"/>
<area shape="rect" id="node16" href="crypto_2sha_2sha_8h.html#a4a803e92438efee8717c1dd0679de99c" title="SHA512_Init" alt="" coords="1038,305,1134,331"/>
<area shape="rect" id="node18" href="s2n__hash_8c.html#a0f3c4efbf552f607071e552dc0548ee6" title="s2n_hash_update" alt="" coords="605,719,732,744"/>
<area shape="rect" id="node25" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="607,555,729,580"/>
<area shape="rect" id="node32" href="s2n__hmac_8c.html#ac4f30ec554d9a717c6269a5de8ae4acf" title="s2n_hmac_reset" alt="" coords="608,817,728,843"/>
<area shape="rect" id="node19" href="crypto_2md5_2md5_8h.html#abedf8217cb8c106b729d7b78dd7f4f46" title="MD5_Update" alt="" coords="831,752,931,777"/>
<area shape="rect" id="node20" href="crypto_2sha_2sha_8h.html#aadef8538263b2cb59f73cfc4e9e26ea0" title="SHA1_Update" alt="" coords="827,801,934,827"/>
<area shape="rect" id="node21" href="crypto_2sha_2sha_8h.html#ada9a5985070b4397bc01b6ea6ddba702" title="SHA224_Update" alt="" coords="820,851,941,876"/>
<area shape="rect" id="node22" href="crypto_2sha_2sha_8h.html#a9d2c95d9cac6ceb095f3e7c48efec95a" title="SHA256_Update" alt="" coords="820,900,941,925"/>
<area shape="rect" id="node23" href="crypto_2sha_2sha_8h.html#aa790a16716c1e350def2dfb1c7411ea2" title="SHA384_Update" alt="" coords="820,949,941,975"/>
<area shape="rect" id="node24" href="crypto_2sha_2sha_8h.html#a0728f9400cea5d81dad5e5a290c6f263" title="SHA512_Update" alt="" coords="820,703,941,728"/>
<area shape="rect" id="node26" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="838,456,923,481"/>
<area shape="rect" id="node27" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="834,505,927,531"/>
<area shape="rect" id="node28" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="827,555,934,580"/>
<area shape="rect" id="node29" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="827,604,934,629"/>
<area shape="rect" id="node30" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="827,653,934,679"/>
<area shape="rect" id="node31" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="827,407,934,432"/>
<area shape="rect" id="node35" href="s2n__hmac_8c.html#ad9e0cc00ac39458cba7a9b1792429dbd" title="s2n_hmac_digest_size" alt="" coords="360,620,517,645"/>
<area shape="rect" id="node37" href="s2n__record__write_8c.html#a2df411911fffd95c6f847fc181c77025" title="s2n_record_max_write\l_payload_size" alt="" coords="361,669,517,708"/>
<area shape="rect" id="node38" href="s2n__hmac_8c.html#a9dbba560a1ef91d4c2114c792f221333" title="s2n_hmac_update" alt="" coords="373,781,504,807"/>
<area shape="rect" id="node39" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="589,1136,748,1161"/>
<area shape="rect" id="node40" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="800,1051,962,1076"/>
<area shape="rect" id="node41" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="1010,1025,1163,1051"/>
<area shape="rect" id="node42" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f" title="s2n_stuffer_write_uint16" alt="" coords="585,1035,752,1060"/>
<area shape="rect" id="node43" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="383,732,494,757"/>
<area shape="rect" id="node44" href="s2n__aead_8c.html#aafbbe3f24a9f607cc8cb47a6af5a3505" title="s2n_aead_aad_init" alt="" coords="372,1085,506,1111"/>
<area shape="rect" id="node45" href="s2n__random_8c.html#a5cfef84444cc08086a4098569c9f1fc8" title="s2n_get_public_random_data" alt="" coords="340,1237,537,1263"/>
<area shape="rect" id="node47" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="607,933,730,959"/>
<area shape="rect" id="node48" href="s2n__sequence_8c.html#a650e459c699416b64accc69561e5fc16" title="s2n_increment_sequence\l_number" alt="" coords="352,1287,526,1325"/>
<area shape="rect" id="node49" href="s2n__stuffer_8c.html#afdc941db81df32f38b7800210f3f2d11" title="s2n_stuffer_raw_write" alt="" coords="593,1185,744,1211"/>
<area shape="rect" id="node50" href="s2n__hmac_8c.html#a4501c4b9ea25f86e9c6c0e9d1bd9276b" title="s2n_hmac_digest" alt="" coords="376,521,502,547"/>
<area shape="rect" id="node36" href="s2n__hash_8c.html#aced4a438c67e79b78d41edfbb8b3e07a" title="s2n_hash_digest_size" alt="" coords="592,768,745,793"/>
<area shape="rect" id="node46" href="s2n__drbg_8c.html#a9fad975e364d5a398330eb937745f0e6" title="s2n_drbg_generate" alt="" coords="600,1237,737,1263"/>
<area shape="rect" id="node51" href="s2n__hash_8c.html#a3ad42d683b1126e7d8eb329b68382bc8" title="s2n_hash_reset" alt="" coords="610,268,727,293"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5_icgraph.png" border="0" usemap="#s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5_icgraph" alt=""/></div>
<map name="s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5_icgraph" id="s2n__tls_8h_afd95cff0f0a33052ba2784ab1a1c14c5_icgraph">
<area shape="rect" id="node2" href="s2n__memory__leak__negative__test_8c.html#aea409319c7706f2cf28137757e2c36d4" title="LLVMFuzzerTestOneInput" alt="" coords="395,5,571,31"/>
<area shape="rect" id="node3" href="s2n__handshake__io_8c.html#a4406f29de6d52b587003368d656dab20" title="s2n_conn_set_handshake_type" alt="" coords="132,452,341,477"/>
<area shape="rect" id="node7" href="s2n__handshake__io_8c.html#a309d98d4c1adfd10c5dd62192f4c1051" title="s2n_negotiate" alt="" coords="184,129,289,155"/>
<area shape="rect" id="node16" href="s2n__recv_8c.html#afede11e597a4db3024ec2b68733a643d" title="s2n_recv" alt="" coords="199,301,274,327"/>
<area shape="rect" id="node18" href="s2n__send_8c.html#a6d221800840cc73c57109088dac2f467" title="s2n_send" alt="" coords="197,252,276,277"/>
<area shape="rect" id="node19" href="s2n__shutdown_8c.html#aa69f439da6aa9a9b0ba76945bac17210" title="s2n_shutdown" alt="" coords="183,203,290,228"/>
<area shape="rect" id="node4" href="s2n__tls_8h.html#abfb7d01ea645110aea3c808de4d86f1d" title="s2n_client_hello_recv" alt="" coords="408,452,558,477"/>
<area shape="rect" id="node5" href="s2n__tls_8h.html#ac1466c1ce812576f187dacd032e682e1" title="s2n_sslv2_client_hello_recv" alt="" coords="389,501,577,527"/>
<area shape="rect" id="node6" href="s2n__tls_8h.html#a2139f810755eb8cf27ebea179e81ac81" title="s2n_server_hello_recv" alt="" coords="405,403,561,428"/>
<area shape="rect" id="node8" href="api__test_8c.html#a767caeff0f20559426ecc269ca133182" title="harness" alt="" coords="449,252,517,277"/>
<area shape="rect" id="node9" href="s2nd_8c.html#a0c3aa10760d5a237f447120b0968ff99" title="negotiate" alt="" coords="445,55,521,80"/>
<area shape="rect" id="node13" href="s2n__client__extensions__test_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="458,104,508,129"/>
<area shape="rect" id="node14" href="s2n__self__talk__alpn__test_8c.html#af4ff368c1e25033d38a42be5a63e3ff9" title="mock_client" alt="" coords="437,153,529,179"/>
<area shape="rect" id="node10" href="s2nd_8c.html#a82dfd7cd8c27b3f6e78bc51538e81dce" title="cache_delete" alt="" coords="625,145,725,171"/>
<area shape="rect" id="node11" href="s2nd_8c.html#ad1835a0a190dc5fe4f925bb69443c770" title="main" alt="" coords="975,145,1026,171"/>
<area shape="rect" id="node12" href="s2n__config_8c.html#a5a13d9dc1fefcdd6c08c329e47f84e9e" title="s2n_config_set_cache\l_delete_callback" alt="" coords="773,167,927,205"/>
<area shape="rect" id="node15" href="s2n__self__talk__alpn__test_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="650,332,700,357"/>
<area shape="rect" id="node17" href="s2nd_8c.html#adc37832656c6aa5548ab17e981176dab" title="echo" alt="" coords="458,301,508,327"/>
<area shape="rect" id="node20" href="s2nc_8c.html#ad1835a0a190dc5fe4f925bb69443c770" title="main" alt="" coords="458,203,508,228"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4b86117a2a4f018991a01ff788272441"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_client_hello_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__client__hello_8c_source.html#l00106">106</a> of file <a class="el" href="s2n__client__hello_8c_source.html">s2n_client_hello.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;{</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    uint32_t gmt_unix_time = <a class="code" href="s2n__server__fuzz__test__overrides_8c.html#a840ddd268669df5b1e15c04cebbd6210">time</a>(NULL);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__stuffer.html">s2n_stuffer</a> *out = &amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__stuffer.html">s2n_stuffer</a> client_random;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> b, r;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    uint8_t session_id_len = 0;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    uint8_t client_protocol_version[<a class="code" href="s2n__connection_8h.html#ad4c29631b045d5227442f693bc3bf117">S2N_TLS_PROTOCOL_VERSION_LEN</a>];</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    b.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a782eb75227ef443a21bfa5f2eb9d4b7a">client_random</a>;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    b.size = <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">/* Create the client random data */</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee">s2n_stuffer_init</a>(&amp;client_random, &amp;b));</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a958a82fb4dfe3517bcfd95f46807f715">s2n_stuffer_write_uint32</a>(&amp;client_random, gmt_unix_time));</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    r.data = <a class="code" href="s2n__stuffer_8c.html#afdc941db81df32f38b7800210f3f2d11">s2n_stuffer_raw_write</a>(&amp;client_random, <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a> - 4);</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    r.size = <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a> - 4;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(r.data);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__random_8c.html#a5cfef84444cc08086a4098569c9f1fc8">s2n_get_public_random_data</a>(&amp;r));</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    client_protocol_version[0] = conn-&gt;<a class="code" href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">client_protocol_version</a> / 10;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    client_protocol_version[1] = conn-&gt;<a class="code" href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">client_protocol_version</a> % 10;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#a6055b7733f7282857a29ef763a4aed62">client_hello_version</a> = conn-&gt;<a class="code" href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">client_protocol_version</a>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a>(out, client_protocol_version, <a class="code" href="s2n__connection_8h.html#ad4c29631b045d5227442f693bc3bf117">S2N_TLS_PROTOCOL_VERSION_LEN</a>));</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aff9283fe7b7a90e13c6c90014719354d">s2n_stuffer_copy</a>(&amp;client_random, out, <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a>));</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, session_id_len));</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#a2cdf2a56849d48a020a71d6e8d03d9cf">cipher_preferences</a>-&gt;<a class="code" href="structs2n__cipher__preferences.html#a20302e2c99a60d3f612dba57e3f6333b">count</a> * <a class="code" href="tls_2s2n__crypto_8h.html#aad5e2a880d4b55cf5450393843a17cf8">S2N_TLS_CIPHER_SUITE_LEN</a>));</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a>(out, conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#a2cdf2a56849d48a020a71d6e8d03d9cf">cipher_preferences</a>-&gt;<a class="code" href="structs2n__cipher__preferences.html#acc56b427760b185ee09b05e370850623">wire_format</a>, conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#a2cdf2a56849d48a020a71d6e8d03d9cf">cipher_preferences</a>-&gt;<a class="code" href="structs2n__cipher__preferences.html#a20302e2c99a60d3f612dba57e3f6333b">count</a> * <a class="code" href="tls_2s2n__crypto_8h.html#aad5e2a880d4b55cf5450393843a17cf8">S2N_TLS_CIPHER_SUITE_LEN</a>));</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">/* Zero compression methods */</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, 1));</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, 0));</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">/* Write the extensions */</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__client__extensions_8c.html#a5693cff7b0838d6d62b5b9e70a1e17f8">s2n_client_extensions_send</a>(conn, out));</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="s2n__client__extensions_8c_html_a5693cff7b0838d6d62b5b9e70a1e17f8"><div class="ttname"><a href="s2n__client__extensions_8c.html#a5693cff7b0838d6d62b5b9e70a1e17f8">s2n_client_extensions_send</a></div><div class="ttdeci">int s2n_client_extensions_send(struct s2n_connection *conn, struct s2n_stuffer *out)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__client__extensions_8c_source.html#l00037">s2n_client_extensions.c:37</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aff9283fe7b7a90e13c6c90014719354d"><div class="ttname"><a href="s2n__stuffer_8c.html#aff9283fe7b7a90e13c6c90014719354d">s2n_stuffer_copy</a></div><div class="ttdeci">int s2n_stuffer_copy(struct s2n_stuffer *from, struct s2n_stuffer *to, const uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00349">s2n_stuffer.c:349</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_ae4f42b5fd74ab885893a960b81dbd57f"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a></div><div class="ttdeci">#define S2N_TLS_RANDOM_DATA_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00028">s2n_crypto.h:28</a></div></div>
<div class="ttc" id="structs2n__connection_html_a7d70bb7bed95daae1233293126bb9523"><div class="ttname"><a href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">s2n_connection::config</a></div><div class="ttdeci">struct s2n_config * config</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00041">s2n_connection.h:41</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aaca63d5bb519a92734bd0287199a7f5a"><div class="ttname"><a href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a></div><div class="ttdeci">int s2n_stuffer_write_uint8(struct s2n_stuffer *stuffer, const uint8_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00249">s2n_stuffer.c:249</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="structs2n__config_html_a2cdf2a56849d48a020a71d6e8d03d9cf"><div class="ttname"><a href="structs2n__config.html#a2cdf2a56849d48a020a71d6e8d03d9cf">s2n_config::cipher_preferences</a></div><div class="ttdeci">struct s2n_cipher_preferences * cipher_preferences</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00042">s2n_config.h:42</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_afdc941db81df32f38b7800210f3f2d11"><div class="ttname"><a href="s2n__stuffer_8c.html#afdc941db81df32f38b7800210f3f2d11">s2n_stuffer_raw_write</a></div><div class="ttdeci">void * s2n_stuffer_raw_write(struct s2n_stuffer *stuffer, const uint32_t data_len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00210">s2n_stuffer.c:210</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a958a82fb4dfe3517bcfd95f46807f715"><div class="ttname"><a href="s2n__stuffer_8c.html#a958a82fb4dfe3517bcfd95f46807f715">s2n_stuffer_write_uint32</a></div><div class="ttdeci">int s2n_stuffer_write_uint32(struct s2n_stuffer *stuffer, const uint32_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00313">s2n_stuffer.c:313</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="s2n__random_8c_html_a5cfef84444cc08086a4098569c9f1fc8"><div class="ttname"><a href="s2n__random_8c.html#a5cfef84444cc08086a4098569c9f1fc8">s2n_get_public_random_data</a></div><div class="ttdeci">int s2n_get_public_random_data(struct s2n_blob *blob)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__random_8c_source.html#l00083">s2n_random.c:83</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a372ad5deb70573456ecde442c0c466be"><div class="ttname"><a href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a></div><div class="ttdeci">#define notnull_check(ptr)                  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00025">s2n_safety.h:25</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a9d9c55b0847a8ae81b6379971a13f27f"><div class="ttname"><a href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a></div><div class="ttdeci">int s2n_stuffer_write_uint16(struct s2n_stuffer *stuffer, const uint16_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00268">s2n_stuffer.c:268</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_aad5e2a880d4b55cf5450393843a17cf8"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#aad5e2a880d4b55cf5450393843a17cf8">S2N_TLS_CIPHER_SUITE_LEN</a></div><div class="ttdeci">#define S2N_TLS_CIPHER_SUITE_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00030">s2n_crypto.h:30</a></div></div>
<div class="ttc" id="s2n__server__fuzz__test__overrides_8c_html_a840ddd268669df5b1e15c04cebbd6210"><div class="ttname"><a href="s2n__server__fuzz__test__overrides_8c.html#a840ddd268669df5b1e15c04cebbd6210">time</a></div><div class="ttdeci">time_t time(time_t *__timer)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__server__fuzz__test__overrides_8c_source.html#l00026">s2n_server_fuzz_test_overrides.c:26</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a782eb75227ef443a21bfa5f2eb9d4b7a"><div class="ttname"><a href="structs2n__crypto__parameters.html#a782eb75227ef443a21bfa5f2eb9d4b7a">s2n_crypto_parameters::client_random</a></div><div class="ttdeci">uint8_t client_random[S2N_TLS_RANDOM_DATA_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00058">s2n_crypto.h:58</a></div></div>
<div class="ttc" id="structs2n__connection_html_a6055b7733f7282857a29ef763a4aed62"><div class="ttname"><a href="structs2n__connection.html#a6055b7733f7282857a29ef763a4aed62">s2n_connection::client_hello_version</a></div><div class="ttdeci">uint8_t client_hello_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00069">s2n_connection.h:69</a></div></div>
<div class="ttc" id="s2n__connection_8h_html_ad4c29631b045d5227442f693bc3bf117"><div class="ttname"><a href="s2n__connection_8h.html#ad4c29631b045d5227442f693bc3bf117">S2N_TLS_PROTOCOL_VERSION_LEN</a></div><div class="ttdeci">#define S2N_TLS_PROTOCOL_VERSION_LEN</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00037">s2n_connection.h:37</a></div></div>
<div class="ttc" id="structs2n__cipher__preferences_html_acc56b427760b185ee09b05e370850623"><div class="ttname"><a href="structs2n__cipher__preferences.html#acc56b427760b185ee09b05e370850623">s2n_cipher_preferences::wire_format</a></div><div class="ttdeci">uint8_t * wire_format</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00028">s2n_cipher_suites.h:28</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_af556836db8ed75fdb89af3d418fab2ee"><div class="ttname"><a href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee">s2n_stuffer_init</a></div><div class="ttdeci">int s2n_stuffer_init(struct s2n_stuffer *stuffer, struct s2n_blob *in)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00029">s2n_stuffer.c:29</a></div></div>
<div class="ttc" id="structs2n__connection_html_a29289057caf9ad21e99bd972da14acc3"><div class="ttname"><a href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">s2n_connection::client_protocol_version</a></div><div class="ttdeci">uint8_t client_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00070">s2n_connection.h:70</a></div></div>
<div class="ttc" id="structs2n__cipher__preferences_html_a20302e2c99a60d3f612dba57e3f6333b"><div class="ttname"><a href="structs2n__cipher__preferences.html#a20302e2c99a60d3f612dba57e3f6333b">s2n_cipher_preferences::count</a></div><div class="ttdeci">uint8_t count</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00027">s2n_cipher_suites.h:27</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_afe5e2db5400000f371d2245e1e0669eb"><div class="ttname"><a href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a></div><div class="ttdeci">int s2n_stuffer_write_bytes(struct s2n_stuffer *stuffer, const uint8_t *data, const uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00224">s2n_stuffer.c:224</a></div></div>
<div class="ttc" id="structs2n__stuffer_html"><div class="ttname"><a href="structs2n__stuffer.html">s2n_stuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00023">s2n_stuffer.h:23</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a4b86117a2a4f018991a01ff788272441_cgraph.png" border="0" usemap="#s2n__tls_8h_a4b86117a2a4f018991a01ff788272441_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a4b86117a2a4f018991a01ff788272441_cgraph" id="s2n__tls_8h_a4b86117a2a4f018991a01ff788272441_cgraph">
<area shape="rect" id="node2" href="s2n__server__fuzz__test__overrides_8c.html#a840ddd268669df5b1e15c04cebbd6210" title="time" alt="" coords="282,5,328,31"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="249,55,361,80"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a958a82fb4dfe3517bcfd95f46807f715" title="s2n_stuffer_write_uint32" alt="" coords="452,453,618,479"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="666,379,828,404"/>
<area shape="rect" id="node11" href="s2n__stuffer_8c.html#afdc941db81df32f38b7800210f3f2d11" title="s2n_stuffer_raw_write" alt="" coords="671,105,823,131"/>
<area shape="rect" id="node12" href="s2n__random_8c.html#a5cfef84444cc08086a4098569c9f1fc8" title="s2n_get_public_random_data" alt="" coords="207,251,404,276"/>
<area shape="rect" id="node14" href="s2n__stuffer_8c.html#aff9283fe7b7a90e13c6c90014719354d" title="s2n_stuffer_copy" alt="" coords="244,201,366,227"/>
<area shape="rect" id="node16" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="455,305,614,331"/>
<area shape="rect" id="node17" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f" title="s2n_stuffer_write_uint16" alt="" coords="452,404,618,429"/>
<area shape="rect" id="node18" href="s2n__client__extensions_8c.html#a5693cff7b0838d6d62b5b9e70a1e17f8" title="s2n_client_extensions_send" alt="" coords="211,352,400,377"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="876,156,1030,181"/>
<area shape="rect" id="node7" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1078,156,1208,181"/>
<area shape="rect" id="node8" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1256,131,1392,156"/>
<area shape="rect" id="node9" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1279,180,1369,205"/>
<area shape="rect" id="node10" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1440,180,1514,205"/>
<area shape="rect" id="node13" href="s2n__drbg_8c.html#a9fad975e364d5a398330eb937745f0e6" title="s2n_drbg_generate" alt="" coords="466,256,603,281"/>
<area shape="rect" id="node15" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="459,207,611,232"/>
<area shape="rect" id="node19" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="474,355,596,380"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abfb7d01ea645110aea3c808de4d86f1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_client_hello_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__client__hello_8c_source.html#l00039">39</a> of file <a class="el" href="s2n__client__hello_8c_source.html">s2n_client_hello.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__stuffer.html">s2n_stuffer</a> *in = &amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    uint8_t compression_methods;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    uint16_t extensions_size;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    uint16_t cipher_suites_length;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    uint8_t *cipher_suites;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    uint8_t client_protocol_version[<a class="code" href="s2n__connection_8h.html#ad4c29631b045d5227442f693bc3bf117">S2N_TLS_PROTOCOL_VERSION_LEN</a>];</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b">s2n_stuffer_read_bytes</a>(in, client_protocol_version, <a class="code" href="s2n__connection_8h.html#ad4c29631b045d5227442f693bc3bf117">S2N_TLS_PROTOCOL_VERSION_LEN</a>));</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b">s2n_stuffer_read_bytes</a>(in, conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a782eb75227ef443a21bfa5f2eb9d4b7a">client_random</a>, <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a>));</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a>(in, &amp;conn-&gt;<a class="code" href="structs2n__connection.html#a76a9703b780cc6c577acbe9ed651a79d">session_id_len</a>));</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">client_protocol_version</a> = (client_protocol_version[0] * 10) + client_protocol_version[1];</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">client_protocol_version</a> &lt; conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#a2cdf2a56849d48a020a71d6e8d03d9cf">cipher_preferences</a>-&gt;<a class="code" href="structs2n__cipher__preferences.html#a98d8055e86b9652d5448a1a82a9f9407">minimum_protocol_version</a> || conn-&gt;<a class="code" href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">client_protocol_version</a> &gt; <a class="code" href="s2n_8h.html#ab17e84046986d49ffd31571b8d32d24e">S2N_TLS12</a>) {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__alerts_8c.html#aaab45cd713be8d161a114cf078b52635">s2n_queue_reader_unsupported_protocol_version_alert</a>(conn));</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#a6055b7733f7282857a29ef763a4aed62">client_hello_version</a> = conn-&gt;<a class="code" href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">client_protocol_version</a>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> = MIN(conn-&gt;<a class="code" href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">client_protocol_version</a>, conn-&gt;<a class="code" href="structs2n__connection.html#ae48c8e6d0ef10e7b815dd500562a47e7">server_protocol_version</a>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#a76a9703b780cc6c577acbe9ed651a79d">session_id_len</a> &gt; <a class="code" href="tls_2s2n__crypto_8h.html#a29125d7c5bb81700b27164fbc9c92746">S2N_TLS_SESSION_ID_MAX_LEN</a> || conn-&gt;<a class="code" href="structs2n__connection.html#a76a9703b780cc6c577acbe9ed651a79d">session_id_len</a> &gt; <a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(in)) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b">s2n_stuffer_read_bytes</a>(in, conn-&gt;<a class="code" href="structs2n__connection.html#ad009472eb0ee35fef5b49e42599a84a1">session_id</a>, conn-&gt;<a class="code" href="structs2n__connection.html#a76a9703b780cc6c577acbe9ed651a79d">session_id_len</a>));</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a>(in, &amp;cipher_suites_length));</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">if</span> (cipher_suites_length % <a class="code" href="tls_2s2n__crypto_8h.html#aad5e2a880d4b55cf5450393843a17cf8">S2N_TLS_CIPHER_SUITE_LEN</a>) {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    cipher_suites = <a class="code" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a>(in, cipher_suites_length);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(cipher_suites);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">/* Don&#39;t choose the cipher yet, read the extensions first */</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a>(in, &amp;compression_methods));</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b">s2n_stuffer_skip_read</a>(in, compression_methods));</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">/* This is going to be our default if the client has no preference. */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a1a6eac074b87a6fa3440ed9d4724d07d">server_ecc_params</a>.<a class="code" href="structs2n__ecc__params.html#a1e0c49e3a87b8db6332443fcf0462468">negotiated_curve</a> = &amp;<a class="code" href="s2n__ecc_8c.html#a27f438af5123167d9e831390707be2a0">s2n_ecc_supported_curves</a>[0];</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(in) &gt;= 2) {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">/* Read extensions if they are present */</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a>(in, &amp;extensions_size));</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">if</span> (extensions_size &gt; <a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(in)) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> extensions;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        extensions.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a> = extensions_size;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        extensions.data = <a class="code" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a>(in, extensions.size);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(extensions.data);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__client__extensions_8c.html#a53cfe69398f5503ced5ba7745c562e63">s2n_client_extensions_recv</a>(conn, &amp;extensions));</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">/* Now choose the ciphers and the cert chain. */</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__cipher__suites_8c.html#a786e7c2f58d929af6012129893c03e63">s2n_set_cipher_as_tls_server</a>(conn, cipher_suites, cipher_suites_length / 2));</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#abfab1f3796089e3576e73286c0b6889c">server</a>-&gt;<a class="code" href="structs2n__crypto__parameters.html#a20dd75e38ae2f99535e509425e4dface">chosen_cert_chain</a> = conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#acd0d45f80129861144d237591eee6c5f">cert_and_key_pairs</a>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">/* Set the handshake type */</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__handshake_8h.html#a4406f29de6d52b587003368d656dab20">s2n_conn_set_handshake_type</a>(conn));</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="structs2n__connection_html_abfab1f3796089e3576e73286c0b6889c"><div class="ttname"><a href="structs2n__connection.html#abfab1f3796089e3576e73286c0b6889c">s2n_connection::server</a></div><div class="ttdeci">struct s2n_crypto_parameters * server</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00081">s2n_connection.h:81</a></div></div>
<div class="ttc" id="structs2n__blob_html_ab2c6b258f02add8fdf4cfc7c371dd772"><div class="ttname"><a href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">s2n_blob::size</a></div><div class="ttdeci">uint32_t size</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00022">s2n_blob.h:22</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__stuffer_8h_html_a56d3da0e05e4c05eb87a343306c4f170"><div class="ttname"><a href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a></div><div class="ttdeci">#define s2n_stuffer_data_available(s)  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00045">s2n_stuffer.h:45</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a0d643b31c896c7f6f2c058977cf46c3b"><div class="ttname"><a href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b">s2n_stuffer_skip_read</a></div><div class="ttdeci">int s2n_stuffer_skip_read(struct s2n_stuffer *stuffer, uint32_t n)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00139">s2n_stuffer.c:139</a></div></div>
<div class="ttc" id="s2n__alerts_8c_html_aaab45cd713be8d161a114cf078b52635"><div class="ttname"><a href="s2n__alerts_8c.html#aaab45cd713be8d161a114cf078b52635">s2n_queue_reader_unsupported_protocol_version_alert</a></div><div class="ttdeci">int s2n_queue_reader_unsupported_protocol_version_alert(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__alerts_8c_source.html#l00117">s2n_alerts.c:117</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a788c22abe22da96107393257193632c5"><div class="ttname"><a href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a></div><div class="ttdeci">int s2n_stuffer_read_uint16(struct s2n_stuffer *stuffer, uint16_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00256">s2n_stuffer.c:256</a></div></div>
<div class="ttc" id="structs2n__ecc__params_html_a1e0c49e3a87b8db6332443fcf0462468"><div class="ttname"><a href="structs2n__ecc__params.html#a1e0c49e3a87b8db6332443fcf0462468">s2n_ecc_params::negotiated_curve</a></div><div class="ttdeci">const struct s2n_ecc_named_curve * negotiated_curve</div><div class="ttdef"><b>Definition:</b> <a href="s2n__ecc_8h_source.html#l00035">s2n_ecc.h:35</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a20dd75e38ae2f99535e509425e4dface"><div class="ttname"><a href="structs2n__crypto__parameters.html#a20dd75e38ae2f99535e509425e4dface">s2n_crypto_parameters::chosen_cert_chain</a></div><div class="ttdeci">struct s2n_cert_chain_and_key * chosen_cert_chain</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00049">s2n_crypto.h:49</a></div></div>
<div class="ttc" id="s2n__cipher__suites_8c_html_a786e7c2f58d929af6012129893c03e63"><div class="ttname"><a href="s2n__cipher__suites_8c.html#a786e7c2f58d929af6012129893c03e63">s2n_set_cipher_as_tls_server</a></div><div class="ttdeci">int s2n_set_cipher_as_tls_server(struct s2n_connection *conn, uint8_t *wire, uint16_t count)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8c_source.html#l00181">s2n_cipher_suites.c:181</a></div></div>
<div class="ttc" id="s2n__handshake_8h_html_a4406f29de6d52b587003368d656dab20"><div class="ttname"><a href="s2n__handshake_8h.html#a4406f29de6d52b587003368d656dab20">s2n_conn_set_handshake_type</a></div><div class="ttdeci">int s2n_conn_set_handshake_type(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake__io_8c_source.html#l00118">s2n_handshake_io.c:118</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_ae4f42b5fd74ab885893a960b81dbd57f"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a></div><div class="ttdeci">#define S2N_TLS_RANDOM_DATA_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00028">s2n_crypto.h:28</a></div></div>
<div class="ttc" id="structs2n__connection_html_a7d70bb7bed95daae1233293126bb9523"><div class="ttname"><a href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">s2n_connection::config</a></div><div class="ttdeci">struct s2n_config * config</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00041">s2n_connection.h:41</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a1a6eac074b87a6fa3440ed9d4724d07d"><div class="ttname"><a href="structs2n__crypto__parameters.html#a1a6eac074b87a6fa3440ed9d4724d07d">s2n_crypto_parameters::server_ecc_params</a></div><div class="ttdeci">struct s2n_ecc_params server_ecc_params</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00048">s2n_crypto.h:48</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="structs2n__config_html_a2cdf2a56849d48a020a71d6e8d03d9cf"><div class="ttname"><a href="structs2n__config.html#a2cdf2a56849d48a020a71d6e8d03d9cf">s2n_config::cipher_preferences</a></div><div class="ttdeci">struct s2n_cipher_preferences * cipher_preferences</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00042">s2n_config.h:42</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a5148294f6ed0bf894afc83a31ee4f8a5"><div class="ttname"><a href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a></div><div class="ttdeci">void * s2n_stuffer_raw_read(struct s2n_stuffer *stuffer, uint32_t data_len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00149">s2n_stuffer.c:149</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_a29125d7c5bb81700b27164fbc9c92746"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#a29125d7c5bb81700b27164fbc9c92746">S2N_TLS_SESSION_ID_MAX_LEN</a></div><div class="ttdeci">#define S2N_TLS_SESSION_ID_MAX_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00043">s2n_crypto.h:43</a></div></div>
<div class="ttc" id="structs2n__connection_html_ae48c8e6d0ef10e7b815dd500562a47e7"><div class="ttname"><a href="structs2n__connection.html#ae48c8e6d0ef10e7b815dd500562a47e7">s2n_connection::server_protocol_version</a></div><div class="ttdeci">uint8_t server_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00071">s2n_connection.h:71</a></div></div>
<div class="ttc" id="s2n__client__extensions_8c_html_a53cfe69398f5503ced5ba7745c562e63"><div class="ttname"><a href="s2n__client__extensions_8c.html#a53cfe69398f5503ced5ba7745c562e63">s2n_client_extensions_recv</a></div><div class="ttdeci">int s2n_client_extensions_recv(struct s2n_connection *conn, struct s2n_blob *extensions)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__client__extensions_8c_source.html#l00137">s2n_client_extensions.c:137</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00051">s2n_errno.h:51</a></div></div>
<div class="ttc" id="structs2n__connection_html_af9b47a1de13de52e7beddb948a40fec1"><div class="ttname"><a href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">s2n_connection::actual_protocol_version</a></div><div class="ttdeci">uint8_t actual_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00072">s2n_connection.h:72</a></div></div>
<div class="ttc" id="structs2n__connection_html_ad009472eb0ee35fef5b49e42599a84a1"><div class="ttname"><a href="structs2n__connection.html#ad009472eb0ee35fef5b49e42599a84a1">s2n_connection::session_id</a></div><div class="ttdeci">uint8_t session_id[S2N_TLS_SESSION_ID_MAX_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00063">s2n_connection.h:63</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_ab84cff8edd5b5f264afe261f093f894b"><div class="ttname"><a href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b">s2n_stuffer_read_bytes</a></div><div class="ttdeci">int s2n_stuffer_read_bytes(struct s2n_stuffer *stuffer, uint8_t *data, uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00180">s2n_stuffer.c:180</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a372ad5deb70573456ecde442c0c466be"><div class="ttname"><a href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a></div><div class="ttdeci">#define notnull_check(ptr)                  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00025">s2n_safety.h:25</a></div></div>
<div class="ttc" id="s2n_8h_html_ab17e84046986d49ffd31571b8d32d24e"><div class="ttname"><a href="s2n_8h.html#ab17e84046986d49ffd31571b8d32d24e">S2N_TLS12</a></div><div class="ttdeci">#define S2N_TLS12</div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00029">s2n.h:29</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_aad5e2a880d4b55cf5450393843a17cf8"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#aad5e2a880d4b55cf5450393843a17cf8">S2N_TLS_CIPHER_SUITE_LEN</a></div><div class="ttdeci">#define S2N_TLS_CIPHER_SUITE_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00030">s2n_crypto.h:30</a></div></div>
<div class="ttc" id="structs2n__connection_html_a76a9703b780cc6c577acbe9ed651a79d"><div class="ttname"><a href="structs2n__connection.html#a76a9703b780cc6c577acbe9ed651a79d">s2n_connection::session_id_len</a></div><div class="ttdeci">uint8_t session_id_len</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00064">s2n_connection.h:64</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a1178687b6091eb483d135c149e87fb0b"><div class="ttname"><a href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a></div><div class="ttdeci">int s2n_stuffer_read_uint8(struct s2n_stuffer *stuffer, uint8_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00242">s2n_stuffer.c:242</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a782eb75227ef443a21bfa5f2eb9d4b7a"><div class="ttname"><a href="structs2n__crypto__parameters.html#a782eb75227ef443a21bfa5f2eb9d4b7a">s2n_crypto_parameters::client_random</a></div><div class="ttdeci">uint8_t client_random[S2N_TLS_RANDOM_DATA_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00058">s2n_crypto.h:58</a></div></div>
<div class="ttc" id="structs2n__connection_html_a6055b7733f7282857a29ef763a4aed62"><div class="ttname"><a href="structs2n__connection.html#a6055b7733f7282857a29ef763a4aed62">s2n_connection::client_hello_version</a></div><div class="ttdeci">uint8_t client_hello_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00069">s2n_connection.h:69</a></div></div>
<div class="ttc" id="s2n__connection_8h_html_ad4c29631b045d5227442f693bc3bf117"><div class="ttname"><a href="s2n__connection_8h.html#ad4c29631b045d5227442f693bc3bf117">S2N_TLS_PROTOCOL_VERSION_LEN</a></div><div class="ttdeci">#define S2N_TLS_PROTOCOL_VERSION_LEN</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00037">s2n_connection.h:37</a></div></div>
<div class="ttc" id="s2n__ecc_8c_html_a27f438af5123167d9e831390707be2a0"><div class="ttname"><a href="s2n__ecc_8c.html#a27f438af5123167d9e831390707be2a0">s2n_ecc_supported_curves</a></div><div class="ttdeci">const struct s2n_ecc_named_curve s2n_ecc_supported_curves[2]</div><div class="ttdef"><b>Definition:</b> <a href="s2n__ecc_8c_source.html#l00030">s2n_ecc.c:30</a></div></div>
<div class="ttc" id="structs2n__config_html_acd0d45f80129861144d237591eee6c5f"><div class="ttname"><a href="structs2n__config.html#acd0d45f80129861144d237591eee6c5f">s2n_config::cert_and_key_pairs</a></div><div class="ttdeci">struct s2n_cert_chain_and_key * cert_and_key_pairs</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00041">s2n_config.h:41</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="structs2n__connection_html_a29289057caf9ad21e99bd972da14acc3"><div class="ttname"><a href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">s2n_connection::client_protocol_version</a></div><div class="ttdeci">uint8_t client_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00070">s2n_connection.h:70</a></div></div>
<div class="ttc" id="structs2n__stuffer_html"><div class="ttname"><a href="structs2n__stuffer.html">s2n_stuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00023">s2n_stuffer.h:23</a></div></div>
<div class="ttc" id="structs2n__cipher__preferences_html_a98d8055e86b9652d5448a1a82a9f9407"><div class="ttname"><a href="structs2n__cipher__preferences.html#a98d8055e86b9652d5448a1a82a9f9407">s2n_cipher_preferences::minimum_protocol_version</a></div><div class="ttdeci">int minimum_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00029">s2n_cipher_suites.h:29</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_abfb7d01ea645110aea3c808de4d86f1d_cgraph.png" border="0" usemap="#s2n__tls_8h_abfb7d01ea645110aea3c808de4d86f1d_cgraph" alt=""/></div>
<map name="s2n__tls_8h_abfb7d01ea645110aea3c808de4d86f1d_cgraph" id="s2n__tls_8h_abfb7d01ea645110aea3c808de4d86f1d_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="1417,635,1577,660"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="1632,524,1784,549"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="1186,748,1343,773"/>
<area shape="rect" id="node5" href="s2n__alerts_8c.html#aaab45cd713be8d161a114cf078b52635" title="s2n_queue_reader_unsupported\l_protocol_version_alert" alt="" coords="903,2789,1118,2828"/>
<area shape="rect" id="node13" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5" title="s2n_stuffer_read_uint16" alt="" coords="1182,635,1347,660"/>
<area shape="rect" id="node14" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="935,145,1086,171"/>
<area shape="rect" id="node15" href="s2n__client__extensions_8c.html#a53cfe69398f5503ced5ba7745c562e63" title="s2n_client_extensions_recv" alt="" coords="667,653,852,679"/>
<area shape="rect" id="node19" href="s2n__cipher__suites_8c.html#a786e7c2f58d929af6012129893c03e63" title="s2n_set_cipher_as_tls\l_server" alt="" coords="231,2080,385,2119"/>
<area shape="rect" id="node20" href="s2n__handshake_8h.html#a4406f29de6d52b587003368d656dab20" title="s2n_conn_set_handshake_type" alt="" coords="203,2031,413,2056"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="1203,2839,1326,2864"/>
<area shape="rect" id="node7" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="1416,2955,1578,2980"/>
<area shape="rect" id="node8" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="1631,2955,1785,2980"/>
<area shape="rect" id="node9" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1833,2747,1963,2772"/>
<area shape="rect" id="node10" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="2011,2228,2148,2253"/>
<area shape="rect" id="node11" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="2035,2747,2124,2772"/>
<area shape="rect" id="node12" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="2196,2747,2269,2772"/>
<area shape="rect" id="node16" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="1209,1463,1320,1488"/>
<area shape="rect" id="node17" href="s2n__stuffer_8c.html#a5d6db4ed8311ba66aec1227fceca24a9" title="s2n_stuffer_reread" alt="" coords="1198,968,1331,993"/>
<area shape="rect" id="node18" href="s2n__ecc_8c.html#abb776b3598360bc599df037aec01faa0" title="s2n_ecc_find_supported\l_curve" alt="" coords="927,1044,1094,1083"/>
<area shape="rect" id="node21" href="s2n__resume_8c.html#af0cd9536cbece4a1bcebb3d69f8d4fd1" title="s2n_is_caching_enabled" alt="" coords="926,2232,1095,2257"/>
<area shape="rect" id="node25" href="s2n__resume_8c.html#aef2e99be4e9b1782b9d208ce80f02842" title="s2n_resume_from_cache" alt="" coords="674,2536,846,2561"/>
<area shape="rect" id="node27" href="s2n__random_8c.html#a5cfef84444cc08086a4098569c9f1fc8" title="s2n_get_public_random_data" alt="" coords="1166,2404,1363,2429"/>
<area shape="rect" id="node29" href="s2n__hash_8c.html#a0f3c4efbf552f607071e552dc0548ee6" title="s2n_hash_update" alt="" coords="1644,1816,1772,1841"/>
<area shape="rect" id="node36" href="s2n__handshake_8c.html#ae327aa8441c888a0bfca0058761abd97" title="s2n_handshake_write\l_header" alt="" coords="684,3353,835,3392"/>
<area shape="rect" id="node38" href="s2n__handshake_8c.html#a0a9a88c8621eab4358a80bb384dd3a3a" title="s2n_handshake_finish\l_header" alt="" coords="683,3416,837,3455"/>
<area shape="rect" id="node40" href="s2n__record_8h.html#a2df411911fffd95c6f847fc181c77025" title="s2n_record_max_write\l_payload_size" alt="" coords="461,2636,617,2675"/>
<area shape="rect" id="node41" href="s2n__record_8h.html#a345384c81da35d41574e7a2c8319c7e3" title="s2n_record_write" alt="" coords="698,2739,822,2764"/>
<area shape="rect" id="node66" href="s2n__send_8c.html#a76828dc199bf174409532010ccbf2a07" title="s2n_flush" alt="" coords="499,2587,578,2612"/>
<area shape="rect" id="node69" href="s2n__stuffer_8c.html#a2b6b54f7856d92f06f823bc26d10f4ba" title="s2n_stuffer_wipe" alt="" coords="1436,1361,1558,1387"/>
<area shape="rect" id="node71" href="s2n__stuffer_8c.html#aff9283fe7b7a90e13c6c90014719354d" title="s2n_stuffer_copy" alt="" coords="1436,2303,1558,2328"/>
<area shape="rect" id="node72" href="s2n__handshake_8c.html#a8930886c2b7fb7a73ef11c9c7c3c3b42" title="s2n_handshake_parse\l_header" alt="" coords="932,677,1089,716"/>
<area shape="rect" id="node74" href="s2n__recv_8c.html#a807adeb1baad4849f782cfd4de10d113" title="s2n_read_full_record" alt="" coords="465,1664,612,1689"/>
<area shape="rect" id="node77" href="s2n__connection_8c.html#a746324b4543d50af7ebedc3ed91fbc57" title="s2n_connection_kill" alt="" coords="691,2031,829,2056"/>
<area shape="rect" id="node89" href="s2n__client__hello_8c.html#ac1466c1ce812576f187dacd032e682e1" title="s2n_sslv2_client_hello_recv" alt="" coords="666,460,854,485"/>
<area shape="rect" id="node91" href="s2n__alerts_8c.html#a45bdea2fd7faa208c0272f56bfb8c656" title="s2n_process_alert_fragment" alt="" coords="665,2232,855,2257"/>
<area shape="rect" id="node22" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="1185,3055,1344,3080"/>
<area shape="rect" id="node23" href="s2n__stuffer_8c.html#af5be81568462bd6626c1d00a939ff30d" title="s2n_stuffer_write_uint64" alt="" coords="1181,2636,1348,2661"/>
<area shape="rect" id="node24" href="s2n__stuffer_8c.html#ae1122959189bd03c92af5fd134016977" title="s2n_stuffer_read_uint64" alt="" coords="1182,1613,1347,1639"/>
<area shape="rect" id="node26" href="s2n__stuffer_8c.html#afdc941db81df32f38b7800210f3f2d11" title="s2n_stuffer_raw_write" alt="" coords="935,3056,1086,3081"/>
<area shape="rect" id="node28" href="s2n__drbg_8c.html#a9fad975e364d5a398330eb937745f0e6" title="s2n_drbg_generate" alt="" coords="1429,2352,1566,2377"/>
<area shape="rect" id="node30" href="crypto_2md5_2md5_8h.html#abedf8217cb8c106b729d7b78dd7f4f46" title="MD5_Update" alt="" coords="1848,1757,1948,1783"/>
<area shape="rect" id="node31" href="crypto_2sha_2sha_8h.html#aadef8538263b2cb59f73cfc4e9e26ea0" title="SHA1_Update" alt="" coords="1845,1807,1951,1832"/>
<area shape="rect" id="node32" href="crypto_2sha_2sha_8h.html#ada9a5985070b4397bc01b6ea6ddba702" title="SHA224_Update" alt="" coords="1837,1856,1959,1881"/>
<area shape="rect" id="node33" href="crypto_2sha_2sha_8h.html#a9d2c95d9cac6ceb095f3e7c48efec95a" title="SHA256_Update" alt="" coords="1837,1905,1959,1931"/>
<area shape="rect" id="node34" href="crypto_2sha_2sha_8h.html#aa790a16716c1e350def2dfb1c7411ea2" title="SHA384_Update" alt="" coords="1837,1659,1959,1684"/>
<area shape="rect" id="node35" href="crypto_2sha_2sha_8h.html#a0728f9400cea5d81dad5e5a290c6f263" title="SHA512_Update" alt="" coords="1837,1708,1959,1733"/>
<area shape="rect" id="node37" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9" title="s2n_stuffer_write_uint24" alt="" coords="927,3423,1094,3448"/>
<area shape="rect" id="node39" href="s2n__stuffer_8c.html#ae1b97eb16ae517a82ec90a0e2b8c48e7" title="s2n_stuffer_rewrite" alt="" coords="943,3321,1078,3347"/>
<area shape="rect" id="node42" href="s2n__hmac_8c.html#ad9e0cc00ac39458cba7a9b1792429dbd" title="s2n_hmac_digest_size" alt="" coords="1419,2128,1576,2153"/>
<area shape="rect" id="node51" href="s2n__hmac_8c.html#ac4f30ec554d9a717c6269a5de8ae4acf" title="s2n_hmac_reset" alt="" coords="1648,2447,1768,2472"/>
<area shape="rect" id="node59" href="s2n__record__write_8c.html#a2df411911fffd95c6f847fc181c77025" title="s2n_record_max_write\l_payload_size" alt="" coords="932,3105,1089,3144"/>
<area shape="rect" id="node60" href="s2n__hmac_8c.html#a9dbba560a1ef91d4c2114c792f221333" title="s2n_hmac_update" alt="" coords="1199,1512,1330,1537"/>
<area shape="rect" id="node61" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f" title="s2n_stuffer_write_uint16" alt="" coords="1181,3005,1348,3031"/>
<area shape="rect" id="node62" href="s2n__aead_8c.html#aafbbe3f24a9f607cc8cb47a6af5a3505" title="s2n_aead_aad_init" alt="" coords="943,2955,1077,2980"/>
<area shape="rect" id="node63" href="s2n__sequence_8c.html#a650e459c699416b64accc69561e5fc16" title="s2n_increment_sequence\l_number" alt="" coords="923,1968,1097,2007"/>
<area shape="rect" id="node64" href="s2n__hmac_8c.html#a4501c4b9ea25f86e9c6c0e9d1bd9276b" title="s2n_hmac_digest" alt="" coords="1434,2003,1560,2028"/>
<area shape="rect" id="node43" href="s2n__hash_8c.html#aced4a438c67e79b78d41edfbb8b3e07a" title="s2n_hash_digest_size" alt="" coords="1631,2177,1785,2203"/>
<area shape="rect" id="node44" href="s2n__hash_8c.html#a684a3779eebad8329d41443454dd6fa2" title="s2n_hash_init" alt="" coords="1846,2383,1950,2408"/>
<area shape="rect" id="node52" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="1647,2079,1769,2104"/>
<area shape="rect" id="node45" href="crypto_2md5_2md5_8h.html#ae06ac750835b8cb838b6be5986ddcad9" title="MD5_Init" alt="" coords="2042,2329,2117,2355"/>
<area shape="rect" id="node46" href="crypto_2sha_2sha_8h.html#ad954eeef9b6210b817502847aea169fa" title="SHA1_Init" alt="" coords="2039,2379,2120,2404"/>
<area shape="rect" id="node47" href="crypto_2sha_2sha_8h.html#ab3befdb5a3202fa6d2eda5f3a06eadfa" title="SHA224_Init" alt="" coords="2031,2428,2127,2453"/>
<area shape="rect" id="node48" href="crypto_2sha_2sha_8h.html#ac96292b35fd2d8387259000aa378ae0d" title="SHA256_Init" alt="" coords="2031,2477,2127,2503"/>
<area shape="rect" id="node49" href="crypto_2sha_2sha_8h.html#ab7ca087b2f4896acc5a9e55a018fb99c" title="SHA384_Init" alt="" coords="2031,2527,2127,2552"/>
<area shape="rect" id="node50" href="crypto_2sha_2sha_8h.html#a4a803e92438efee8717c1dd0679de99c" title="SHA512_Init" alt="" coords="2031,2280,2127,2305"/>
<area shape="rect" id="node53" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="1855,2103,1941,2128"/>
<area shape="rect" id="node54" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="1852,2152,1944,2177"/>
<area shape="rect" id="node55" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="1844,2201,1952,2227"/>
<area shape="rect" id="node56" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="1844,1955,1952,1980"/>
<area shape="rect" id="node57" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="1844,2004,1952,2029"/>
<area shape="rect" id="node58" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="1844,2053,1952,2079"/>
<area shape="rect" id="node65" href="s2n__hash_8c.html#a3ad42d683b1126e7d8eb329b68382bc8" title="s2n_hash_reset" alt="" coords="1650,2128,1766,2153"/>
<area shape="rect" id="node67" href="s2n__stuffer_8h.html#a40bf61bc8745a2d894dd558a2885a66b" title="s2n_stuffer_send_to_fd" alt="" coords="1417,947,1577,972"/>
<area shape="rect" id="node68" href="s2n_8h.html#aa869211ca9b49f497cdb5579935203de" title="s2n_connection_wipe" alt="" coords="1190,2587,1339,2612"/>
<area shape="rect" id="node70" href="s2n__hmac_8c.html#ad5056a3fc151619a2935471a5861fc3d" title="s2n_hmac_init" alt="" coords="1443,2401,1551,2427"/>
<area shape="rect" id="node73" href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c" title="s2n_stuffer_read_uint24" alt="" coords="1182,684,1347,709"/>
<area shape="rect" id="node75" href="s2n__stuffer_8h.html#a19fe623439e89aeadbac10e98b7a8896" title="s2n_stuffer_recv_from_fd" alt="" coords="1411,2847,1583,2872"/>
<area shape="rect" id="node76" href="s2n__record_8h.html#ada746040b578344a72196d5dd1d356fd" title="s2n_sslv2_record_header\l_parse" alt="" coords="923,615,1098,653"/>
<area shape="rect" id="node80" href="s2n__record_8h.html#af0794788139e3e2975022dd47f983eda" title="s2n_record_header_parse" alt="" coords="922,843,1099,868"/>
<area shape="rect" id="node81" href="s2n__record_8h.html#a26b47800a66fc8e167d92b302e0b7079" title="s2n_record_parse" alt="" coords="695,1564,824,1589"/>
<area shape="rect" id="node78" href="s2n__random_8c.html#a8aabcb071120a9849d4615358000a8a6" title="s2n_public_random" alt="" coords="942,2183,1079,2208"/>
<area shape="rect" id="node79" href="s2n__timer_8c.html#a78c722b16f52af289f500f2f6e471904" title="s2n_timer_start" alt="" coords="954,2031,1067,2056"/>
<area shape="rect" id="node82" href="s2n__record__read_8c.html#af0794788139e3e2975022dd47f983eda" title="s2n_record_header_parse" alt="" coords="922,892,1099,917"/>
<area shape="rect" id="node83" href="s2n__stuffer_8c.html#a49bb9749c055c6fb6f713cebeaa14cb5" title="s2n_stuffer_read" alt="" coords="950,513,1071,539"/>
<area shape="rect" id="node84" href="s2n__cbc_8c.html#a49a0a2c5708c690625b2474555727b80" title="s2n_verify_cbc" alt="" coords="955,1615,1066,1640"/>
<area shape="rect" id="node88" href="s2n__hmac_8c.html#a7787cefe78aedac6b20db11cc451a433" title="s2n_hmac_digest_verify" alt="" coords="928,1664,1093,1689"/>
<area shape="rect" id="node85" href="s2n__hmac_8c.html#a6007599a9ecbe64464dc464093931f6a" title="s2n_hmac_copy" alt="" coords="1205,1725,1324,1751"/>
<area shape="rect" id="node86" href="s2n__hmac_8c.html#a2afcf63a3b7f8fc08957f53b820ad39f" title="s2n_hmac_digest_two\l_compression_rounds" alt="" coords="1187,1663,1341,1701"/>
<area shape="rect" id="node87" href="s2n__server__fuzz__test__overrides_8c.html#a407f3056ab784369c0ccb3359532669a" title="s2n_constant_time_equals" alt="" coords="1174,1827,1354,1852"/>
<area shape="rect" id="node90" href="s2n__cipher__suites_8c.html#a93d49c8f6f3f8a5f4b7e703a61421b7b" title="s2n_set_cipher_as_sslv2\l_server" alt="" coords="925,348,1096,387"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac1466c1ce812576f187dacd032e682e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_sslv2_client_hello_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__client__hello_8c_source.html#l00148">148</a> of file <a class="el" href="s2n__client__hello_8c_source.html">s2n_client_hello.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;{</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__stuffer.html">s2n_stuffer</a> *in = &amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    uint16_t session_id_length;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    uint16_t cipher_suites_length;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    uint16_t challenge_length;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    uint8_t *cipher_suites;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">client_protocol_version</a> &lt; conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#a2cdf2a56849d48a020a71d6e8d03d9cf">cipher_preferences</a>-&gt;<a class="code" href="structs2n__cipher__preferences.html#a98d8055e86b9652d5448a1a82a9f9407">minimum_protocol_version</a> || conn-&gt;<a class="code" href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">client_protocol_version</a> &gt; <a class="code" href="s2n_8h.html#ab17e84046986d49ffd31571b8d32d24e">S2N_TLS12</a>) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__alerts_8c.html#aaab45cd713be8d161a114cf078b52635">s2n_queue_reader_unsupported_protocol_version_alert</a>(conn));</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> = MIN(conn-&gt;<a class="code" href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">client_protocol_version</a>, conn-&gt;<a class="code" href="structs2n__connection.html#ae48c8e6d0ef10e7b815dd500562a47e7">server_protocol_version</a>);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#a6055b7733f7282857a29ef763a4aed62">client_hello_version</a> = <a class="code" href="s2n_8h.html#a495735277344c9c306668f6027e3f077">S2N_SSLv2</a>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">/* We start 5 bytes into the record */</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a>(in, &amp;cipher_suites_length));</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">if</span> (cipher_suites_length % <a class="code" href="tls_2s2n__crypto_8h.html#a3949cc93dd4131fe3bcc6d11d2d43da4">S2N_SSLv2_CIPHER_SUITE_LEN</a>) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    }</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a>(in, &amp;session_id_length));</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a>(in, &amp;challenge_length));</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (challenge_length &gt; <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a>) {</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    cipher_suites = <a class="code" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a>(in, cipher_suites_length);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(cipher_suites);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__cipher__suites_8c.html#a93d49c8f6f3f8a5f4b7e703a61421b7b">s2n_set_cipher_as_sslv2_server</a>(conn, cipher_suites, cipher_suites_length / S2N_SSLv2_CIPHER_SUITE_LEN));</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (session_id_length &gt; <a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(in)) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (session_id_length &gt; 0 &amp;&amp; session_id_length &lt;= <a class="code" href="tls_2s2n__crypto_8h.html#a29125d7c5bb81700b27164fbc9c92746">S2N_TLS_SESSION_ID_MAX_LEN</a>) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b">s2n_stuffer_read_bytes</a>(in, conn-&gt;<a class="code" href="structs2n__connection.html#ad009472eb0ee35fef5b49e42599a84a1">session_id</a>, session_id_length));</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        conn-&gt;<a class="code" href="structs2n__connection.html#a76a9703b780cc6c577acbe9ed651a79d">session_id_len</a> = (uint8_t) session_id_length;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b">s2n_stuffer_skip_read</a>(in, session_id_length));</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> b;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    b.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a782eb75227ef443a21bfa5f2eb9d4b7a">client_random</a>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    b.size = <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    b.data += <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a> - challenge_length;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    b.size -= <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a> - challenge_length;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a49bb9749c055c6fb6f713cebeaa14cb5">s2n_stuffer_read</a>(in, &amp;b));</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#abfab1f3796089e3576e73286c0b6889c">server</a>-&gt;<a class="code" href="structs2n__crypto__parameters.html#a20dd75e38ae2f99535e509425e4dface">chosen_cert_chain</a> = conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#acd0d45f80129861144d237591eee6c5f">cert_and_key_pairs</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__handshake_8h.html#a4406f29de6d52b587003368d656dab20">s2n_conn_set_handshake_type</a>(conn));</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="structs2n__connection_html_abfab1f3796089e3576e73286c0b6889c"><div class="ttname"><a href="structs2n__connection.html#abfab1f3796089e3576e73286c0b6889c">s2n_connection::server</a></div><div class="ttdeci">struct s2n_crypto_parameters * server</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00081">s2n_connection.h:81</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a49bb9749c055c6fb6f713cebeaa14cb5"><div class="ttname"><a href="s2n__stuffer_8c.html#a49bb9749c055c6fb6f713cebeaa14cb5">s2n_stuffer_read</a></div><div class="ttdeci">int s2n_stuffer_read(struct s2n_stuffer *stuffer, struct s2n_blob *out)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00158">s2n_stuffer.c:158</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__stuffer_8h_html_a56d3da0e05e4c05eb87a343306c4f170"><div class="ttname"><a href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a></div><div class="ttdeci">#define s2n_stuffer_data_available(s)  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00045">s2n_stuffer.h:45</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a0d643b31c896c7f6f2c058977cf46c3b"><div class="ttname"><a href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b">s2n_stuffer_skip_read</a></div><div class="ttdeci">int s2n_stuffer_skip_read(struct s2n_stuffer *stuffer, uint32_t n)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00139">s2n_stuffer.c:139</a></div></div>
<div class="ttc" id="s2n__alerts_8c_html_aaab45cd713be8d161a114cf078b52635"><div class="ttname"><a href="s2n__alerts_8c.html#aaab45cd713be8d161a114cf078b52635">s2n_queue_reader_unsupported_protocol_version_alert</a></div><div class="ttdeci">int s2n_queue_reader_unsupported_protocol_version_alert(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__alerts_8c_source.html#l00117">s2n_alerts.c:117</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a788c22abe22da96107393257193632c5"><div class="ttname"><a href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a></div><div class="ttdeci">int s2n_stuffer_read_uint16(struct s2n_stuffer *stuffer, uint16_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00256">s2n_stuffer.c:256</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a20dd75e38ae2f99535e509425e4dface"><div class="ttname"><a href="structs2n__crypto__parameters.html#a20dd75e38ae2f99535e509425e4dface">s2n_crypto_parameters::chosen_cert_chain</a></div><div class="ttdeci">struct s2n_cert_chain_and_key * chosen_cert_chain</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00049">s2n_crypto.h:49</a></div></div>
<div class="ttc" id="s2n__cipher__suites_8c_html_a93d49c8f6f3f8a5f4b7e703a61421b7b"><div class="ttname"><a href="s2n__cipher__suites_8c.html#a93d49c8f6f3f8a5f4b7e703a61421b7b">s2n_set_cipher_as_sslv2_server</a></div><div class="ttdeci">int s2n_set_cipher_as_sslv2_server(struct s2n_connection *conn, uint8_t *wire, uint16_t count)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8c_source.html#l00176">s2n_cipher_suites.c:176</a></div></div>
<div class="ttc" id="s2n__handshake_8h_html_a4406f29de6d52b587003368d656dab20"><div class="ttname"><a href="s2n__handshake_8h.html#a4406f29de6d52b587003368d656dab20">s2n_conn_set_handshake_type</a></div><div class="ttdeci">int s2n_conn_set_handshake_type(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake__io_8c_source.html#l00118">s2n_handshake_io.c:118</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_ae4f42b5fd74ab885893a960b81dbd57f"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a></div><div class="ttdeci">#define S2N_TLS_RANDOM_DATA_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00028">s2n_crypto.h:28</a></div></div>
<div class="ttc" id="structs2n__connection_html_a7d70bb7bed95daae1233293126bb9523"><div class="ttname"><a href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">s2n_connection::config</a></div><div class="ttdeci">struct s2n_config * config</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00041">s2n_connection.h:41</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="structs2n__config_html_a2cdf2a56849d48a020a71d6e8d03d9cf"><div class="ttname"><a href="structs2n__config.html#a2cdf2a56849d48a020a71d6e8d03d9cf">s2n_config::cipher_preferences</a></div><div class="ttdeci">struct s2n_cipher_preferences * cipher_preferences</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00042">s2n_config.h:42</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a5148294f6ed0bf894afc83a31ee4f8a5"><div class="ttname"><a href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a></div><div class="ttdeci">void * s2n_stuffer_raw_read(struct s2n_stuffer *stuffer, uint32_t data_len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00149">s2n_stuffer.c:149</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_a29125d7c5bb81700b27164fbc9c92746"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#a29125d7c5bb81700b27164fbc9c92746">S2N_TLS_SESSION_ID_MAX_LEN</a></div><div class="ttdeci">#define S2N_TLS_SESSION_ID_MAX_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00043">s2n_crypto.h:43</a></div></div>
<div class="ttc" id="structs2n__connection_html_ae48c8e6d0ef10e7b815dd500562a47e7"><div class="ttname"><a href="structs2n__connection.html#ae48c8e6d0ef10e7b815dd500562a47e7">s2n_connection::server_protocol_version</a></div><div class="ttdeci">uint8_t server_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00071">s2n_connection.h:71</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00051">s2n_errno.h:51</a></div></div>
<div class="ttc" id="structs2n__connection_html_af9b47a1de13de52e7beddb948a40fec1"><div class="ttname"><a href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">s2n_connection::actual_protocol_version</a></div><div class="ttdeci">uint8_t actual_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00072">s2n_connection.h:72</a></div></div>
<div class="ttc" id="structs2n__connection_html_ad009472eb0ee35fef5b49e42599a84a1"><div class="ttname"><a href="structs2n__connection.html#ad009472eb0ee35fef5b49e42599a84a1">s2n_connection::session_id</a></div><div class="ttdeci">uint8_t session_id[S2N_TLS_SESSION_ID_MAX_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00063">s2n_connection.h:63</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_ab84cff8edd5b5f264afe261f093f894b"><div class="ttname"><a href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b">s2n_stuffer_read_bytes</a></div><div class="ttdeci">int s2n_stuffer_read_bytes(struct s2n_stuffer *stuffer, uint8_t *data, uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00180">s2n_stuffer.c:180</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a372ad5deb70573456ecde442c0c466be"><div class="ttname"><a href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a></div><div class="ttdeci">#define notnull_check(ptr)                  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00025">s2n_safety.h:25</a></div></div>
<div class="ttc" id="s2n_8h_html_a495735277344c9c306668f6027e3f077"><div class="ttname"><a href="s2n_8h.html#a495735277344c9c306668f6027e3f077">S2N_SSLv2</a></div><div class="ttdeci">#define S2N_SSLv2</div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00025">s2n.h:25</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_a3949cc93dd4131fe3bcc6d11d2d43da4"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#a3949cc93dd4131fe3bcc6d11d2d43da4">S2N_SSLv2_CIPHER_SUITE_LEN</a></div><div class="ttdeci">#define S2N_SSLv2_CIPHER_SUITE_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00031">s2n_crypto.h:31</a></div></div>
<div class="ttc" id="s2n_8h_html_ab17e84046986d49ffd31571b8d32d24e"><div class="ttname"><a href="s2n_8h.html#ab17e84046986d49ffd31571b8d32d24e">S2N_TLS12</a></div><div class="ttdeci">#define S2N_TLS12</div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00029">s2n.h:29</a></div></div>
<div class="ttc" id="structs2n__connection_html_a76a9703b780cc6c577acbe9ed651a79d"><div class="ttname"><a href="structs2n__connection.html#a76a9703b780cc6c577acbe9ed651a79d">s2n_connection::session_id_len</a></div><div class="ttdeci">uint8_t session_id_len</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00064">s2n_connection.h:64</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a782eb75227ef443a21bfa5f2eb9d4b7a"><div class="ttname"><a href="structs2n__crypto__parameters.html#a782eb75227ef443a21bfa5f2eb9d4b7a">s2n_crypto_parameters::client_random</a></div><div class="ttdeci">uint8_t client_random[S2N_TLS_RANDOM_DATA_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00058">s2n_crypto.h:58</a></div></div>
<div class="ttc" id="structs2n__connection_html_a6055b7733f7282857a29ef763a4aed62"><div class="ttname"><a href="structs2n__connection.html#a6055b7733f7282857a29ef763a4aed62">s2n_connection::client_hello_version</a></div><div class="ttdeci">uint8_t client_hello_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00069">s2n_connection.h:69</a></div></div>
<div class="ttc" id="structs2n__config_html_acd0d45f80129861144d237591eee6c5f"><div class="ttname"><a href="structs2n__config.html#acd0d45f80129861144d237591eee6c5f">s2n_config::cert_and_key_pairs</a></div><div class="ttdeci">struct s2n_cert_chain_and_key * cert_and_key_pairs</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00041">s2n_config.h:41</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="structs2n__connection_html_a29289057caf9ad21e99bd972da14acc3"><div class="ttname"><a href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">s2n_connection::client_protocol_version</a></div><div class="ttdeci">uint8_t client_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00070">s2n_connection.h:70</a></div></div>
<div class="ttc" id="structs2n__stuffer_html"><div class="ttname"><a href="structs2n__stuffer.html">s2n_stuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00023">s2n_stuffer.h:23</a></div></div>
<div class="ttc" id="structs2n__cipher__preferences_html_a98d8055e86b9652d5448a1a82a9f9407"><div class="ttname"><a href="structs2n__cipher__preferences.html#a98d8055e86b9652d5448a1a82a9f9407">s2n_cipher_preferences::minimum_protocol_version</a></div><div class="ttdeci">int minimum_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00029">s2n_cipher_suites.h:29</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1_cgraph.png" border="0" usemap="#s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1_cgraph" alt=""/></div>
<map name="s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1_cgraph" id="s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1_cgraph">
<area shape="rect" id="node2" href="s2n__alerts_8c.html#aaab45cd713be8d161a114cf078b52635" title="s2n_queue_reader_unsupported\l_protocol_version_alert" alt="" coords="941,2051,1156,2090"/>
<area shape="rect" id="node10" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5" title="s2n_stuffer_read_uint16" alt="" coords="1220,622,1385,647"/>
<area shape="rect" id="node11" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="1455,622,1615,647"/>
<area shape="rect" id="node12" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="1670,622,1822,647"/>
<area shape="rect" id="node13" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="973,157,1123,182"/>
<area shape="rect" id="node14" href="s2n__cipher__suites_8c.html#a93d49c8f6f3f8a5f4b7e703a61421b7b" title="s2n_set_cipher_as_sslv2\l_server" alt="" coords="963,94,1134,133"/>
<area shape="rect" id="node15" href="s2n__stuffer_8c.html#a49bb9749c055c6fb6f713cebeaa14cb5" title="s2n_stuffer_read" alt="" coords="988,459,1109,485"/>
<area shape="rect" id="node16" href="s2n__handshake_8h.html#a4406f29de6d52b587003368d656dab20" title="s2n_conn_set_handshake_type" alt="" coords="241,1165,450,1190"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="1241,2318,1364,2343"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="1454,2369,1616,2394"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="1669,2369,1823,2394"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1871,2102,2001,2127"/>
<area shape="rect" id="node7" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="2049,2026,2186,2051"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="2072,2102,2162,2127"/>
<area shape="rect" id="node9" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="2234,2102,2307,2127"/>
<area shape="rect" id="node17" href="s2n__resume_8c.html#af0cd9536cbece4a1bcebb3d69f8d4fd1" title="s2n_is_caching_enabled" alt="" coords="964,1646,1132,1671"/>
<area shape="rect" id="node22" href="s2n__resume_8c.html#aef2e99be4e9b1782b9d208ce80f02842" title="s2n_resume_from_cache" alt="" coords="712,2495,884,2521"/>
<area shape="rect" id="node25" href="s2n__random_8c.html#a5cfef84444cc08086a4098569c9f1fc8" title="s2n_get_public_random_data" alt="" coords="1204,309,1401,334"/>
<area shape="rect" id="node27" href="s2n__hash_8c.html#a0f3c4efbf552f607071e552dc0548ee6" title="s2n_hash_update" alt="" coords="1682,1398,1810,1423"/>
<area shape="rect" id="node34" href="s2n__handshake_8c.html#ae327aa8441c888a0bfca0058761abd97" title="s2n_handshake_write\l_header" alt="" coords="722,2779,873,2818"/>
<area shape="rect" id="node36" href="s2n__handshake_8c.html#a0a9a88c8621eab4358a80bb384dd3a3a" title="s2n_handshake_finish\l_header" alt="" coords="721,2842,875,2881"/>
<area shape="rect" id="node38" href="s2n__record_8h.html#a2df411911fffd95c6f847fc181c77025" title="s2n_record_max_write\l_payload_size" alt="" coords="498,635,655,674"/>
<area shape="rect" id="node39" href="s2n__record_8h.html#a345384c81da35d41574e7a2c8319c7e3" title="s2n_record_write" alt="" coords="736,2286,859,2311"/>
<area shape="rect" id="node64" href="s2n__send_8c.html#a76828dc199bf174409532010ccbf2a07" title="s2n_flush" alt="" coords="537,1849,616,1874"/>
<area shape="rect" id="node67" href="s2n__stuffer_8c.html#a2b6b54f7856d92f06f823bc26d10f4ba" title="s2n_stuffer_wipe" alt="" coords="1474,2001,1596,2026"/>
<area shape="rect" id="node69" href="s2n__stuffer_8c.html#aff9283fe7b7a90e13c6c90014719354d" title="s2n_stuffer_copy" alt="" coords="1474,1595,1596,1621"/>
<area shape="rect" id="node70" href="s2n__handshake_8c.html#a8930886c2b7fb7a73ef11c9c7c3c3b42" title="s2n_handshake_parse\l_header" alt="" coords="970,662,1126,701"/>
<area shape="rect" id="node72" href="s2n__stuffer_8c.html#a5d6db4ed8311ba66aec1227fceca24a9" title="s2n_stuffer_reread" alt="" coords="1236,825,1369,850"/>
<area shape="rect" id="node73" href="s2n__recv_8c.html#a807adeb1baad4849f782cfd4de10d113" title="s2n_read_full_record" alt="" coords="503,837,650,862"/>
<area shape="rect" id="node76" href="s2n__connection_8c.html#a746324b4543d50af7ebedc3ed91fbc57" title="s2n_connection_kill" alt="" coords="729,623,867,649"/>
<area shape="rect" id="node87" href="s2n__client__hello_8c.html#ac1466c1ce812576f187dacd032e682e1" title="s2n_sslv2_client_hello_recv" alt="" coords="704,357,891,382"/>
<area shape="rect" id="node88" href="s2n__alerts_8c.html#a45bdea2fd7faa208c0272f56bfb8c656" title="s2n_process_alert_fragment" alt="" coords="703,1697,893,1722"/>
<area shape="rect" id="node18" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="1223,2469,1382,2494"/>
<area shape="rect" id="node19" href="s2n__stuffer_8c.html#af5be81568462bd6626c1d00a939ff30d" title="s2n_stuffer_write_uint64" alt="" coords="1219,1950,1385,1975"/>
<area shape="rect" id="node20" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="1223,723,1381,749"/>
<area shape="rect" id="node21" href="s2n__stuffer_8c.html#ae1122959189bd03c92af5fd134016977" title="s2n_stuffer_read_uint64" alt="" coords="1220,1075,1385,1101"/>
<area shape="rect" id="node23" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="993,2495,1104,2521"/>
<area shape="rect" id="node24" href="s2n__stuffer_8c.html#afdc941db81df32f38b7800210f3f2d11" title="s2n_stuffer_raw_write" alt="" coords="973,2698,1124,2723"/>
<area shape="rect" id="node26" href="s2n__drbg_8c.html#a9fad975e364d5a398330eb937745f0e6" title="s2n_drbg_generate" alt="" coords="1466,309,1603,334"/>
<area shape="rect" id="node28" href="crypto_2md5_2md5_8h.html#abedf8217cb8c106b729d7b78dd7f4f46" title="MD5_Update" alt="" coords="1886,1393,1986,1418"/>
<area shape="rect" id="node29" href="crypto_2sha_2sha_8h.html#aadef8538263b2cb59f73cfc4e9e26ea0" title="SHA1_Update" alt="" coords="1882,1442,1989,1467"/>
<area shape="rect" id="node30" href="crypto_2sha_2sha_8h.html#ada9a5985070b4397bc01b6ea6ddba702" title="SHA224_Update" alt="" coords="1875,1491,1996,1517"/>
<area shape="rect" id="node31" href="crypto_2sha_2sha_8h.html#a9d2c95d9cac6ceb095f3e7c48efec95a" title="SHA256_Update" alt="" coords="1875,1245,1996,1270"/>
<area shape="rect" id="node32" href="crypto_2sha_2sha_8h.html#aa790a16716c1e350def2dfb1c7411ea2" title="SHA384_Update" alt="" coords="1875,1294,1996,1319"/>
<area shape="rect" id="node33" href="crypto_2sha_2sha_8h.html#a0728f9400cea5d81dad5e5a290c6f263" title="SHA512_Update" alt="" coords="1875,1343,1996,1369"/>
<area shape="rect" id="node35" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9" title="s2n_stuffer_write_uint24" alt="" coords="965,2849,1131,2874"/>
<area shape="rect" id="node37" href="s2n__stuffer_8c.html#ae1b97eb16ae517a82ec90a0e2b8c48e7" title="s2n_stuffer_rewrite" alt="" coords="981,2747,1116,2773"/>
<area shape="rect" id="node40" href="s2n__hmac_8c.html#ad9e0cc00ac39458cba7a9b1792429dbd" title="s2n_hmac_digest_size" alt="" coords="1456,1494,1613,1519"/>
<area shape="rect" id="node49" href="s2n__hmac_8c.html#ac4f30ec554d9a717c6269a5de8ae4acf" title="s2n_hmac_reset" alt="" coords="1686,1645,1806,1670"/>
<area shape="rect" id="node57" href="s2n__record__write_8c.html#a2df411911fffd95c6f847fc181c77025" title="s2n_record_max_write\l_payload_size" alt="" coords="970,2279,1126,2318"/>
<area shape="rect" id="node58" href="s2n__hmac_8c.html#a9dbba560a1ef91d4c2114c792f221333" title="s2n_hmac_update" alt="" coords="1237,977,1368,1002"/>
<area shape="rect" id="node59" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f" title="s2n_stuffer_write_uint16" alt="" coords="1219,2419,1385,2445"/>
<area shape="rect" id="node60" href="s2n__aead_8c.html#aafbbe3f24a9f607cc8cb47a6af5a3505" title="s2n_aead_aad_init" alt="" coords="981,2394,1115,2419"/>
<area shape="rect" id="node61" href="s2n__sequence_8c.html#a650e459c699416b64accc69561e5fc16" title="s2n_increment_sequence\l_number" alt="" coords="961,2114,1135,2153"/>
<area shape="rect" id="node62" href="s2n__hmac_8c.html#a4501c4b9ea25f86e9c6c0e9d1bd9276b" title="s2n_hmac_digest" alt="" coords="1472,1234,1598,1259"/>
<area shape="rect" id="node41" href="s2n__hash_8c.html#aced4a438c67e79b78d41edfbb8b3e07a" title="s2n_hash_digest_size" alt="" coords="1669,1494,1823,1519"/>
<area shape="rect" id="node42" href="s2n__hash_8c.html#a684a3779eebad8329d41443454dd6fa2" title="s2n_hash_init" alt="" coords="1884,1195,1988,1221"/>
<area shape="rect" id="node50" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="1685,1595,1807,1621"/>
<area shape="rect" id="node43" href="crypto_2md5_2md5_8h.html#ae06ac750835b8cb838b6be5986ddcad9" title="MD5_Init" alt="" coords="2080,1270,2154,1295"/>
<area shape="rect" id="node44" href="crypto_2sha_2sha_8h.html#ad954eeef9b6210b817502847aea169fa" title="SHA1_Init" alt="" coords="2076,1319,2158,1345"/>
<area shape="rect" id="node45" href="crypto_2sha_2sha_8h.html#ab3befdb5a3202fa6d2eda5f3a06eadfa" title="SHA224_Init" alt="" coords="2069,1073,2165,1098"/>
<area shape="rect" id="node46" href="crypto_2sha_2sha_8h.html#ac96292b35fd2d8387259000aa378ae0d" title="SHA256_Init" alt="" coords="2069,1122,2165,1147"/>
<area shape="rect" id="node47" href="crypto_2sha_2sha_8h.html#ab7ca087b2f4896acc5a9e55a018fb99c" title="SHA384_Init" alt="" coords="2069,1171,2165,1197"/>
<area shape="rect" id="node48" href="crypto_2sha_2sha_8h.html#a4a803e92438efee8717c1dd0679de99c" title="SHA512_Init" alt="" coords="2069,1221,2165,1246"/>
<area shape="rect" id="node51" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="1893,1689,1979,1714"/>
<area shape="rect" id="node52" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="1890,1738,1982,1763"/>
<area shape="rect" id="node53" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="1882,1787,1989,1813"/>
<area shape="rect" id="node54" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="1882,1541,1989,1566"/>
<area shape="rect" id="node55" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="1882,1590,1989,1615"/>
<area shape="rect" id="node56" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="1882,1639,1989,1665"/>
<area shape="rect" id="node63" href="s2n__hash_8c.html#a3ad42d683b1126e7d8eb329b68382bc8" title="s2n_hash_reset" alt="" coords="1688,1195,1804,1221"/>
<area shape="rect" id="node65" href="s2n__stuffer_8h.html#a40bf61bc8745a2d894dd558a2885a66b" title="s2n_stuffer_send_to_fd" alt="" coords="1455,773,1615,798"/>
<area shape="rect" id="node66" href="s2n_8h.html#aa869211ca9b49f497cdb5579935203de" title="s2n_connection_wipe" alt="" coords="1227,1798,1377,1823"/>
<area shape="rect" id="node68" href="s2n__hmac_8c.html#ad5056a3fc151619a2935471a5861fc3d" title="s2n_hmac_init" alt="" coords="1481,1645,1589,1670"/>
<area shape="rect" id="node71" href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c" title="s2n_stuffer_read_uint24" alt="" coords="1220,521,1385,546"/>
<area shape="rect" id="node74" href="s2n__stuffer_8h.html#a19fe623439e89aeadbac10e98b7a8896" title="s2n_stuffer_recv_from_fd" alt="" coords="1449,2249,1621,2274"/>
<area shape="rect" id="node75" href="s2n__record_8h.html#ada746040b578344a72196d5dd1d356fd" title="s2n_sslv2_record_header\l_parse" alt="" coords="961,725,1136,763"/>
<area shape="rect" id="node79" href="s2n__record_8h.html#af0794788139e3e2975022dd47f983eda" title="s2n_record_header_parse" alt="" coords="959,787,1137,813"/>
<area shape="rect" id="node80" href="s2n__record_8h.html#a26b47800a66fc8e167d92b302e0b7079" title="s2n_record_parse" alt="" coords="733,1266,862,1291"/>
<area shape="rect" id="node77" href="s2n__random_8c.html#a8aabcb071120a9849d4615358000a8a6" title="s2n_public_random" alt="" coords="979,410,1117,435"/>
<area shape="rect" id="node78" href="s2n__timer_8c.html#a78c722b16f52af289f500f2f6e471904" title="s2n_timer_start" alt="" coords="992,561,1105,586"/>
<area shape="rect" id="node81" href="s2n__record__read_8c.html#af0794788139e3e2975022dd47f983eda" title="s2n_record_header_parse" alt="" coords="959,837,1137,862"/>
<area shape="rect" id="node82" href="s2n__cbc_8c.html#a49a0a2c5708c690625b2474555727b80" title="s2n_verify_cbc" alt="" coords="993,1191,1103,1217"/>
<area shape="rect" id="node86" href="s2n__hmac_8c.html#a7787cefe78aedac6b20db11cc451a433" title="s2n_hmac_digest_verify" alt="" coords="966,1241,1131,1266"/>
<area shape="rect" id="node83" href="s2n__hmac_8c.html#a6007599a9ecbe64464dc464093931f6a" title="s2n_hmac_copy" alt="" coords="1243,1026,1361,1051"/>
<area shape="rect" id="node84" href="s2n__hmac_8c.html#a2afcf63a3b7f8fc08957f53b820ad39f" title="s2n_hmac_digest_two\l_compression_rounds" alt="" coords="1225,1177,1379,1215"/>
<area shape="rect" id="node85" href="s2n__server__fuzz__test__overrides_8c.html#a407f3056ab784369c0ccb3359532669a" title="s2n_constant_time_equals" alt="" coords="1212,1291,1392,1317"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1_icgraph.png" border="0" usemap="#s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1_icgraph" alt=""/></div>
<map name="s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1_icgraph" id="s2n__tls_8h_ac1466c1ce812576f187dacd032e682e1_icgraph">
<area shape="rect" id="node2" href="s2n__handshake__io_8c.html#a4406f29de6d52b587003368d656dab20" title="s2n_conn_set_handshake_type" alt="" coords="241,31,450,56"/>
<area shape="rect" id="node3" href="s2n__tls_8h.html#abfb7d01ea645110aea3c808de4d86f1d" title="s2n_client_hello_recv" alt="" coords="501,5,651,31"/>
<area shape="rect" id="node4" href="s2n__tls_8h.html#a2139f810755eb8cf27ebea179e81ac81" title="s2n_server_hello_recv" alt="" coords="498,55,654,80"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8e32b708f98ecbfa1148c5393f8b9dba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_hello_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__hello_8c_source.html#l00111">111</a> of file <a class="el" href="s2n__server__hello_8c_source.html">s2n_server_hello.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    uint32_t gmt_unix_time = <a class="code" href="s2n__server__fuzz__test__overrides_8c.html#a840ddd268669df5b1e15c04cebbd6210">time</a>(NULL);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__stuffer.html">s2n_stuffer</a> *out = &amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__stuffer.html">s2n_stuffer</a> server_random;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> b, r;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    uint8_t protocol_version[<a class="code" href="s2n__connection_8h.html#ad4c29631b045d5227442f693bc3bf117">S2N_TLS_PROTOCOL_VERSION_LEN</a>];</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    b.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#ae6ef2eba6c9afbd8345314a05422a2e4">server_random</a>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    b.size = <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">/* Create the server random data */</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee">s2n_stuffer_init</a>(&amp;server_random, &amp;b));</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a958a82fb4dfe3517bcfd95f46807f715">s2n_stuffer_write_uint32</a>(&amp;server_random, gmt_unix_time));</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    r.data = <a class="code" href="s2n__stuffer_8c.html#afdc941db81df32f38b7800210f3f2d11">s2n_stuffer_raw_write</a>(&amp;server_random, <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a> - 4);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    r.size = <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a> - 4;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(r.data);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__random_8c.html#a5cfef84444cc08086a4098569c9f1fc8">s2n_get_public_random_data</a>(&amp;r));</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    protocol_version[0] = conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> / 10;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    protocol_version[1] = conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> % 10;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a76195ad1b96e7ecdec22ee893d81c6c7">signature_digest_alg</a> = <a class="code" href="s2n__hash_8h.html#a45fca4e9152a9bfb4b15f8d9f1a074e5ac0f7f343aebed483dfa89ad357fa6419">S2N_HASH_MD5_SHA1</a>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> == <a class="code" href="s2n_8h.html#ab17e84046986d49ffd31571b8d32d24e">S2N_TLS12</a>) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a76195ad1b96e7ecdec22ee893d81c6c7">signature_digest_alg</a> = <a class="code" href="s2n__hash_8h.html#a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627">S2N_HASH_SHA1</a>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a>(out, protocol_version, <a class="code" href="s2n__connection_8h.html#ad4c29631b045d5227442f693bc3bf117">S2N_TLS_PROTOCOL_VERSION_LEN</a>));</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a>(out, conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#ae6ef2eba6c9afbd8345314a05422a2e4">server_random</a>, <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a>));</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, conn-&gt;<a class="code" href="structs2n__connection.html#a76a9703b780cc6c577acbe9ed651a79d">session_id_len</a>));</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a>(out, conn-&gt;<a class="code" href="structs2n__connection.html#ad009472eb0ee35fef5b49e42599a84a1">session_id</a>, conn-&gt;<a class="code" href="structs2n__connection.html#a76a9703b780cc6c577acbe9ed651a79d">session_id_len</a>));</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a>(out, conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a5446cce0337d14b74b38f2a81ea19670">cipher_suite</a>-&gt;<a class="code" href="structs2n__cipher__suite.html#a9b3a865c19b6bc5b1d68ff63ed97b6c5">value</a>, <a class="code" href="tls_2s2n__crypto_8h.html#aad5e2a880d4b55cf5450393843a17cf8">S2N_TLS_CIPHER_SUITE_LEN</a>));</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, <a class="code" href="s2n__server__hello_8c.html#a2cb71a349ceab5a3a4a46d133306bf81">S2N_TLS_COMPRESSION_METHOD_NULL</a>));</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__server__extensions_8c.html#a72b3e9fb3b4cb76a22e8d236609029ab">s2n_server_extensions_send</a>(conn, out));</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#ab54a0b4ad8370fee08f0c47917684e65">actual_protocol_version_established</a> = 1;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="s2n__server__hello_8c_html_a2cb71a349ceab5a3a4a46d133306bf81"><div class="ttname"><a href="s2n__server__hello_8c.html#a2cb71a349ceab5a3a4a46d133306bf81">S2N_TLS_COMPRESSION_METHOD_NULL</a></div><div class="ttdeci">#define S2N_TLS_COMPRESSION_METHOD_NULL</div><div class="ttdef"><b>Definition:</b> <a href="s2n__server__hello_8c_source.html#l00034">s2n_server_hello.c:34</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a5446cce0337d14b74b38f2a81ea19670"><div class="ttname"><a href="structs2n__crypto__parameters.html#a5446cce0337d14b74b38f2a81ea19670">s2n_crypto_parameters::cipher_suite</a></div><div class="ttdeci">struct s2n_cipher_suite * cipher_suite</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00052">s2n_crypto.h:52</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_ae4f42b5fd74ab885893a960b81dbd57f"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a></div><div class="ttdeci">#define S2N_TLS_RANDOM_DATA_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00028">s2n_crypto.h:28</a></div></div>
<div class="ttc" id="structs2n__connection_html_ab54a0b4ad8370fee08f0c47917684e65"><div class="ttname"><a href="structs2n__connection.html#ab54a0b4ad8370fee08f0c47917684e65">s2n_connection::actual_protocol_version_established</a></div><div class="ttdeci">uint8_t actual_protocol_version_established</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00073">s2n_connection.h:73</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aaca63d5bb519a92734bd0287199a7f5a"><div class="ttname"><a href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a></div><div class="ttdeci">int s2n_stuffer_write_uint8(struct s2n_stuffer *stuffer, const uint8_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00249">s2n_stuffer.c:249</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_afdc941db81df32f38b7800210f3f2d11"><div class="ttname"><a href="s2n__stuffer_8c.html#afdc941db81df32f38b7800210f3f2d11">s2n_stuffer_raw_write</a></div><div class="ttdeci">void * s2n_stuffer_raw_write(struct s2n_stuffer *stuffer, const uint32_t data_len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00210">s2n_stuffer.c:210</a></div></div>
<div class="ttc" id="structs2n__connection_html_af9b47a1de13de52e7beddb948a40fec1"><div class="ttname"><a href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">s2n_connection::actual_protocol_version</a></div><div class="ttdeci">uint8_t actual_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00072">s2n_connection.h:72</a></div></div>
<div class="ttc" id="s2n__hash_8h_html_a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627"><div class="ttname"><a href="s2n__hash_8h.html#a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627">S2N_HASH_SHA1</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__hash_8h_source.html#l00040">s2n_hash.h:40</a></div></div>
<div class="ttc" id="structs2n__connection_html_ad009472eb0ee35fef5b49e42599a84a1"><div class="ttname"><a href="structs2n__connection.html#ad009472eb0ee35fef5b49e42599a84a1">s2n_connection::session_id</a></div><div class="ttdeci">uint8_t session_id[S2N_TLS_SESSION_ID_MAX_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00063">s2n_connection.h:63</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a76195ad1b96e7ecdec22ee893d81c6c7"><div class="ttname"><a href="structs2n__crypto__parameters.html#a76195ad1b96e7ecdec22ee893d81c6c7">s2n_crypto_parameters::signature_digest_alg</a></div><div class="ttdeci">s2n_hash_algorithm signature_digest_alg</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00050">s2n_crypto.h:50</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a958a82fb4dfe3517bcfd95f46807f715"><div class="ttname"><a href="s2n__stuffer_8c.html#a958a82fb4dfe3517bcfd95f46807f715">s2n_stuffer_write_uint32</a></div><div class="ttdeci">int s2n_stuffer_write_uint32(struct s2n_stuffer *stuffer, const uint32_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00313">s2n_stuffer.c:313</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_ae6ef2eba6c9afbd8345314a05422a2e4"><div class="ttname"><a href="structs2n__crypto__parameters.html#ae6ef2eba6c9afbd8345314a05422a2e4">s2n_crypto_parameters::server_random</a></div><div class="ttdeci">uint8_t server_random[S2N_TLS_RANDOM_DATA_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00059">s2n_crypto.h:59</a></div></div>
<div class="ttc" id="s2n__random_8c_html_a5cfef84444cc08086a4098569c9f1fc8"><div class="ttname"><a href="s2n__random_8c.html#a5cfef84444cc08086a4098569c9f1fc8">s2n_get_public_random_data</a></div><div class="ttdeci">int s2n_get_public_random_data(struct s2n_blob *blob)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__random_8c_source.html#l00083">s2n_random.c:83</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a372ad5deb70573456ecde442c0c466be"><div class="ttname"><a href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a></div><div class="ttdeci">#define notnull_check(ptr)                  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00025">s2n_safety.h:25</a></div></div>
<div class="ttc" id="s2n__server__extensions_8c_html_a72b3e9fb3b4cb76a22e8d236609029ab"><div class="ttname"><a href="s2n__server__extensions_8c.html#a72b3e9fb3b4cb76a22e8d236609029ab">s2n_server_extensions_send</a></div><div class="ttdeci">int s2n_server_extensions_send(struct s2n_connection *conn, struct s2n_stuffer *out)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__server__extensions_8c_source.html#l00033">s2n_server_extensions.c:33</a></div></div>
<div class="ttc" id="s2n_8h_html_ab17e84046986d49ffd31571b8d32d24e"><div class="ttname"><a href="s2n_8h.html#ab17e84046986d49ffd31571b8d32d24e">S2N_TLS12</a></div><div class="ttdeci">#define S2N_TLS12</div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00029">s2n.h:29</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_aad5e2a880d4b55cf5450393843a17cf8"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#aad5e2a880d4b55cf5450393843a17cf8">S2N_TLS_CIPHER_SUITE_LEN</a></div><div class="ttdeci">#define S2N_TLS_CIPHER_SUITE_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00030">s2n_crypto.h:30</a></div></div>
<div class="ttc" id="s2n__server__fuzz__test__overrides_8c_html_a840ddd268669df5b1e15c04cebbd6210"><div class="ttname"><a href="s2n__server__fuzz__test__overrides_8c.html#a840ddd268669df5b1e15c04cebbd6210">time</a></div><div class="ttdeci">time_t time(time_t *__timer)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__server__fuzz__test__overrides_8c_source.html#l00026">s2n_server_fuzz_test_overrides.c:26</a></div></div>
<div class="ttc" id="s2n__hash_8h_html_a45fca4e9152a9bfb4b15f8d9f1a074e5ac0f7f343aebed483dfa89ad357fa6419"><div class="ttname"><a href="s2n__hash_8h.html#a45fca4e9152a9bfb4b15f8d9f1a074e5ac0f7f343aebed483dfa89ad357fa6419">S2N_HASH_MD5_SHA1</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__hash_8h_source.html#l00041">s2n_hash.h:41</a></div></div>
<div class="ttc" id="structs2n__cipher__suite_html_a9b3a865c19b6bc5b1d68ff63ed97b6c5"><div class="ttname"><a href="structs2n__cipher__suite.html#a9b3a865c19b6bc5b1d68ff63ed97b6c5">s2n_cipher_suite::value</a></div><div class="ttdeci">uint8_t value[2]</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00047">s2n_cipher_suites.h:47</a></div></div>
<div class="ttc" id="structs2n__connection_html_a76a9703b780cc6c577acbe9ed651a79d"><div class="ttname"><a href="structs2n__connection.html#a76a9703b780cc6c577acbe9ed651a79d">s2n_connection::session_id_len</a></div><div class="ttdeci">uint8_t session_id_len</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00064">s2n_connection.h:64</a></div></div>
<div class="ttc" id="s2n__connection_8h_html_ad4c29631b045d5227442f693bc3bf117"><div class="ttname"><a href="s2n__connection_8h.html#ad4c29631b045d5227442f693bc3bf117">S2N_TLS_PROTOCOL_VERSION_LEN</a></div><div class="ttdeci">#define S2N_TLS_PROTOCOL_VERSION_LEN</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00037">s2n_connection.h:37</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_af556836db8ed75fdb89af3d418fab2ee"><div class="ttname"><a href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee">s2n_stuffer_init</a></div><div class="ttdeci">int s2n_stuffer_init(struct s2n_stuffer *stuffer, struct s2n_blob *in)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00029">s2n_stuffer.c:29</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_afe5e2db5400000f371d2245e1e0669eb"><div class="ttname"><a href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a></div><div class="ttdeci">int s2n_stuffer_write_bytes(struct s2n_stuffer *stuffer, const uint8_t *data, const uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00224">s2n_stuffer.c:224</a></div></div>
<div class="ttc" id="structs2n__stuffer_html"><div class="ttname"><a href="structs2n__stuffer.html">s2n_stuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00023">s2n_stuffer.h:23</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a8e32b708f98ecbfa1148c5393f8b9dba_cgraph.png" border="0" usemap="#s2n__tls_8h_a8e32b708f98ecbfa1148c5393f8b9dba_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a8e32b708f98ecbfa1148c5393f8b9dba_cgraph" id="s2n__tls_8h_a8e32b708f98ecbfa1148c5393f8b9dba_cgraph">
<area shape="rect" id="node2" href="s2n__server__fuzz__test__overrides_8c.html#a840ddd268669df5b1e15c04cebbd6210" title="time" alt="" coords="288,5,334,31"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="255,55,367,80"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a958a82fb4dfe3517bcfd95f46807f715" title="s2n_stuffer_write_uint32" alt="" coords="458,156,624,181"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="672,283,834,308"/>
<area shape="rect" id="node11" href="s2n__stuffer_8c.html#afdc941db81df32f38b7800210f3f2d11" title="s2n_stuffer_raw_write" alt="" coords="677,157,829,183"/>
<area shape="rect" id="node12" href="s2n__random_8c.html#a5cfef84444cc08086a4098569c9f1fc8" title="s2n_get_public_random_data" alt="" coords="213,207,410,232"/>
<area shape="rect" id="node14" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="461,409,620,435"/>
<area shape="rect" id="node15" href="s2n__server__extensions_8c.html#a72b3e9fb3b4cb76a22e8d236609029ab" title="s2n_server_extensions_send" alt="" coords="214,320,408,345"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="882,220,1036,245"/>
<area shape="rect" id="node7" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1084,220,1214,245"/>
<area shape="rect" id="node8" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1262,195,1398,220"/>
<area shape="rect" id="node9" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1285,244,1375,269"/>
<area shape="rect" id="node10" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1446,244,1520,269"/>
<area shape="rect" id="node13" href="s2n__drbg_8c.html#a9fad975e364d5a398330eb937745f0e6" title="s2n_drbg_generate" alt="" coords="472,207,609,232"/>
<area shape="rect" id="node16" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f" title="s2n_stuffer_write_uint16" alt="" coords="458,308,624,333"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2139f810755eb8cf27ebea179e81ac81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_hello_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__hello_8c_source.html#l00036">36</a> of file <a class="el" href="s2n__server__hello_8c_source.html">s2n_server_hello.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__stuffer.html">s2n_stuffer</a> *in = &amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    uint8_t compression_method;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    uint8_t session_id[<a class="code" href="tls_2s2n__crypto_8h.html#a29125d7c5bb81700b27164fbc9c92746">S2N_TLS_SESSION_ID_MAX_LEN</a>];</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    uint8_t session_id_len;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    uint16_t extensions_size;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    uint8_t protocol_version[<a class="code" href="s2n__connection_8h.html#ad4c29631b045d5227442f693bc3bf117">S2N_TLS_PROTOCOL_VERSION_LEN</a>];</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b">s2n_stuffer_read_bytes</a>(in, protocol_version, <a class="code" href="s2n__connection_8h.html#ad4c29631b045d5227442f693bc3bf117">S2N_TLS_PROTOCOL_VERSION_LEN</a>));</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#ae48c8e6d0ef10e7b815dd500562a47e7">server_protocol_version</a> = (protocol_version[0] * 10) + protocol_version[1];</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#ae48c8e6d0ef10e7b815dd500562a47e7">server_protocol_version</a> &gt; conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a>) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__alerts_8c.html#aaab45cd713be8d161a114cf078b52635">s2n_queue_reader_unsupported_protocol_version_alert</a>(conn));</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> = conn-&gt;<a class="code" href="structs2n__connection.html#ae48c8e6d0ef10e7b815dd500562a47e7">server_protocol_version</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#ab54a0b4ad8370fee08f0c47917684e65">actual_protocol_version_established</a> = 1;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">/* Verify that the protocol version is sane */</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> &lt; <a class="code" href="s2n_8h.html#a457805749bd152786e9e344a5b22ab67">S2N_SSLv3</a> || conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> &gt; <a class="code" href="s2n_8h.html#ab17e84046986d49ffd31571b8d32d24e">S2N_TLS12</a>) {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a76195ad1b96e7ecdec22ee893d81c6c7">signature_digest_alg</a> = <a class="code" href="s2n__hash_8h.html#a45fca4e9152a9bfb4b15f8d9f1a074e5ac0f7f343aebed483dfa89ad357fa6419">S2N_HASH_MD5_SHA1</a>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> == <a class="code" href="s2n_8h.html#ab17e84046986d49ffd31571b8d32d24e">S2N_TLS12</a>) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a76195ad1b96e7ecdec22ee893d81c6c7">signature_digest_alg</a> = <a class="code" href="s2n__hash_8h.html#a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627">S2N_HASH_SHA1</a>;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b">s2n_stuffer_read_bytes</a>(in, conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#ae6ef2eba6c9afbd8345314a05422a2e4">server_random</a>, <a class="code" href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a>));</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a>(in, &amp;session_id_len));</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">if</span> (session_id_len &gt; <a class="code" href="tls_2s2n__crypto_8h.html#a29125d7c5bb81700b27164fbc9c92746">S2N_TLS_SESSION_ID_MAX_LEN</a>) {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#a76a9703b780cc6c577acbe9ed651a79d">session_id_len</a> = session_id_len;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b">s2n_stuffer_read_bytes</a>(in, session_id, session_id_len));</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    uint8_t *cipher_suite_wire = <a class="code" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a>(in, <a class="code" href="tls_2s2n__crypto_8h.html#aad5e2a880d4b55cf5450393843a17cf8">S2N_TLS_CIPHER_SUITE_LEN</a>);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(cipher_suite_wire);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__cipher__suites_8c.html#a1fde427e44c9343e87af779ca1666b9e">s2n_set_cipher_as_client</a>(conn, cipher_suite_wire));</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a>(in, &amp;compression_method));</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (compression_method != <a class="code" href="s2n__server__hello_8c.html#a2cb71a349ceab5a3a4a46d133306bf81">S2N_TLS_COMPRESSION_METHOD_NULL</a>) {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__handshake_8h.html#a4406f29de6d52b587003368d656dab20">s2n_conn_set_handshake_type</a>(conn));</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#a8b8974068a8f2c38a061ffb495a5ca1c">handshake_type</a> == RESUME) {</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f">s2n_prf_key_expansion</a>(conn));</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(in) &lt; 2) {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">/* No extensions */</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a>(in, &amp;extensions_size));</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (extensions_size &gt; <a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(in)) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> extensions;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    extensions.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a> = extensions_size;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    extensions.data = <a class="code" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a>(in, extensions.size);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(extensions.data);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__server__extensions_8c.html#aa5973260f0a72187b1331e5633795fe9">s2n_server_extensions_recv</a>(conn, &amp;extensions));</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div><div class="ttc" id="s2n__prf_8c_html_a1425bb608ed69a0cc582af0a57955e1f"><div class="ttname"><a href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f">s2n_prf_key_expansion</a></div><div class="ttdeci">int s2n_prf_key_expansion(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__prf_8c_source.html#l00349">s2n_prf.c:349</a></div></div>
<div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="structs2n__blob_html_ab2c6b258f02add8fdf4cfc7c371dd772"><div class="ttname"><a href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">s2n_blob::size</a></div><div class="ttdeci">uint32_t size</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00022">s2n_blob.h:22</a></div></div>
<div class="ttc" id="s2n__server__hello_8c_html_a2cb71a349ceab5a3a4a46d133306bf81"><div class="ttname"><a href="s2n__server__hello_8c.html#a2cb71a349ceab5a3a4a46d133306bf81">S2N_TLS_COMPRESSION_METHOD_NULL</a></div><div class="ttdeci">#define S2N_TLS_COMPRESSION_METHOD_NULL</div><div class="ttdef"><b>Definition:</b> <a href="s2n__server__hello_8c_source.html#l00034">s2n_server_hello.c:34</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__stuffer_8h_html_a56d3da0e05e4c05eb87a343306c4f170"><div class="ttname"><a href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a></div><div class="ttdeci">#define s2n_stuffer_data_available(s)  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00045">s2n_stuffer.h:45</a></div></div>
<div class="ttc" id="s2n__alerts_8c_html_aaab45cd713be8d161a114cf078b52635"><div class="ttname"><a href="s2n__alerts_8c.html#aaab45cd713be8d161a114cf078b52635">s2n_queue_reader_unsupported_protocol_version_alert</a></div><div class="ttdeci">int s2n_queue_reader_unsupported_protocol_version_alert(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__alerts_8c_source.html#l00117">s2n_alerts.c:117</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a788c22abe22da96107393257193632c5"><div class="ttname"><a href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a></div><div class="ttdeci">int s2n_stuffer_read_uint16(struct s2n_stuffer *stuffer, uint16_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00256">s2n_stuffer.c:256</a></div></div>
<div class="ttc" id="s2n__handshake_8h_html_a4406f29de6d52b587003368d656dab20"><div class="ttname"><a href="s2n__handshake_8h.html#a4406f29de6d52b587003368d656dab20">s2n_conn_set_handshake_type</a></div><div class="ttdeci">int s2n_conn_set_handshake_type(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake__io_8c_source.html#l00118">s2n_handshake_io.c:118</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_ae4f42b5fd74ab885893a960b81dbd57f"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#ae4f42b5fd74ab885893a960b81dbd57f">S2N_TLS_RANDOM_DATA_LEN</a></div><div class="ttdeci">#define S2N_TLS_RANDOM_DATA_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00028">s2n_crypto.h:28</a></div></div>
<div class="ttc" id="structs2n__connection_html_ab54a0b4ad8370fee08f0c47917684e65"><div class="ttname"><a href="structs2n__connection.html#ab54a0b4ad8370fee08f0c47917684e65">s2n_connection::actual_protocol_version_established</a></div><div class="ttdeci">uint8_t actual_protocol_version_established</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00073">s2n_connection.h:73</a></div></div>
<div class="ttc" id="structs2n__handshake_html_a8b8974068a8f2c38a061ffb495a5ca1c"><div class="ttname"><a href="structs2n__handshake.html#a8b8974068a8f2c38a061ffb495a5ca1c">s2n_handshake::handshake_type</a></div><div class="ttdeci">enum s2n_handshake::@78 handshake_type</div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a5148294f6ed0bf894afc83a31ee4f8a5"><div class="ttname"><a href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a></div><div class="ttdeci">void * s2n_stuffer_raw_read(struct s2n_stuffer *stuffer, uint32_t data_len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00149">s2n_stuffer.c:149</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_a29125d7c5bb81700b27164fbc9c92746"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#a29125d7c5bb81700b27164fbc9c92746">S2N_TLS_SESSION_ID_MAX_LEN</a></div><div class="ttdeci">#define S2N_TLS_SESSION_ID_MAX_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00043">s2n_crypto.h:43</a></div></div>
<div class="ttc" id="structs2n__connection_html_ae48c8e6d0ef10e7b815dd500562a47e7"><div class="ttname"><a href="structs2n__connection.html#ae48c8e6d0ef10e7b815dd500562a47e7">s2n_connection::server_protocol_version</a></div><div class="ttdeci">uint8_t server_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00071">s2n_connection.h:71</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00051">s2n_errno.h:51</a></div></div>
<div class="ttc" id="structs2n__connection_html_af9b47a1de13de52e7beddb948a40fec1"><div class="ttname"><a href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">s2n_connection::actual_protocol_version</a></div><div class="ttdeci">uint8_t actual_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00072">s2n_connection.h:72</a></div></div>
<div class="ttc" id="s2n__hash_8h_html_a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627"><div class="ttname"><a href="s2n__hash_8h.html#a45fca4e9152a9bfb4b15f8d9f1a074e5aa460f813770b3e8d9678b19a6dc39627">S2N_HASH_SHA1</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__hash_8h_source.html#l00040">s2n_hash.h:40</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a76195ad1b96e7ecdec22ee893d81c6c7"><div class="ttname"><a href="structs2n__crypto__parameters.html#a76195ad1b96e7ecdec22ee893d81c6c7">s2n_crypto_parameters::signature_digest_alg</a></div><div class="ttdeci">s2n_hash_algorithm signature_digest_alg</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00050">s2n_crypto.h:50</a></div></div>
<div class="ttc" id="s2n__server__extensions_8c_html_aa5973260f0a72187b1331e5633795fe9"><div class="ttname"><a href="s2n__server__extensions_8c.html#aa5973260f0a72187b1331e5633795fe9">s2n_server_extensions_recv</a></div><div class="ttdeci">int s2n_server_extensions_recv(struct s2n_connection *conn, struct s2n_blob *extensions)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__server__extensions_8c_source.html#l00082">s2n_server_extensions.c:82</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_ae6ef2eba6c9afbd8345314a05422a2e4"><div class="ttname"><a href="structs2n__crypto__parameters.html#ae6ef2eba6c9afbd8345314a05422a2e4">s2n_crypto_parameters::server_random</a></div><div class="ttdeci">uint8_t server_random[S2N_TLS_RANDOM_DATA_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00059">s2n_crypto.h:59</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_ab84cff8edd5b5f264afe261f093f894b"><div class="ttname"><a href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b">s2n_stuffer_read_bytes</a></div><div class="ttdeci">int s2n_stuffer_read_bytes(struct s2n_stuffer *stuffer, uint8_t *data, uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00180">s2n_stuffer.c:180</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a372ad5deb70573456ecde442c0c466be"><div class="ttname"><a href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a></div><div class="ttdeci">#define notnull_check(ptr)                  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00025">s2n_safety.h:25</a></div></div>
<div class="ttc" id="s2n_8h_html_a457805749bd152786e9e344a5b22ab67"><div class="ttname"><a href="s2n_8h.html#a457805749bd152786e9e344a5b22ab67">S2N_SSLv3</a></div><div class="ttdeci">#define S2N_SSLv3</div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00026">s2n.h:26</a></div></div>
<div class="ttc" id="s2n_8h_html_ab17e84046986d49ffd31571b8d32d24e"><div class="ttname"><a href="s2n_8h.html#ab17e84046986d49ffd31571b8d32d24e">S2N_TLS12</a></div><div class="ttdeci">#define S2N_TLS12</div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00029">s2n.h:29</a></div></div>
<div class="ttc" id="s2n__cipher__suites_8c_html_a1fde427e44c9343e87af779ca1666b9e"><div class="ttname"><a href="s2n__cipher__suites_8c.html#a1fde427e44c9343e87af779ca1666b9e">s2n_set_cipher_as_client</a></div><div class="ttdeci">int s2n_set_cipher_as_client(struct s2n_connection *conn, uint8_t wire[S2N_TLS_CIPHER_SUITE_LEN])</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8c_source.html#l00088">s2n_cipher_suites.c:88</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_aad5e2a880d4b55cf5450393843a17cf8"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#aad5e2a880d4b55cf5450393843a17cf8">S2N_TLS_CIPHER_SUITE_LEN</a></div><div class="ttdeci">#define S2N_TLS_CIPHER_SUITE_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00030">s2n_crypto.h:30</a></div></div>
<div class="ttc" id="s2n__hash_8h_html_a45fca4e9152a9bfb4b15f8d9f1a074e5ac0f7f343aebed483dfa89ad357fa6419"><div class="ttname"><a href="s2n__hash_8h.html#a45fca4e9152a9bfb4b15f8d9f1a074e5ac0f7f343aebed483dfa89ad357fa6419">S2N_HASH_MD5_SHA1</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__hash_8h_source.html#l00041">s2n_hash.h:41</a></div></div>
<div class="ttc" id="structs2n__connection_html_a76a9703b780cc6c577acbe9ed651a79d"><div class="ttname"><a href="structs2n__connection.html#a76a9703b780cc6c577acbe9ed651a79d">s2n_connection::session_id_len</a></div><div class="ttdeci">uint8_t session_id_len</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00064">s2n_connection.h:64</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a1178687b6091eb483d135c149e87fb0b"><div class="ttname"><a href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a></div><div class="ttdeci">int s2n_stuffer_read_uint8(struct s2n_stuffer *stuffer, uint8_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00242">s2n_stuffer.c:242</a></div></div>
<div class="ttc" id="s2n__connection_8h_html_ad4c29631b045d5227442f693bc3bf117"><div class="ttname"><a href="s2n__connection_8h.html#ad4c29631b045d5227442f693bc3bf117">S2N_TLS_PROTOCOL_VERSION_LEN</a></div><div class="ttdeci">#define S2N_TLS_PROTOCOL_VERSION_LEN</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00037">s2n_connection.h:37</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="structs2n__stuffer_html"><div class="ttname"><a href="structs2n__stuffer.html">s2n_stuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00023">s2n_stuffer.h:23</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a2139f810755eb8cf27ebea179e81ac81_cgraph.png" border="0" usemap="#s2n__tls_8h_a2139f810755eb8cf27ebea179e81ac81_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a2139f810755eb8cf27ebea179e81ac81_cgraph" id="s2n__tls_8h_a2139f810755eb8cf27ebea179e81ac81_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="1441,582,1602,607"/>
<area shape="rect" id="node4" href="s2n__alerts_8c.html#aaab45cd713be8d161a114cf078b52635" title="s2n_queue_reader_unsupported\l_protocol_version_alert" alt="" coords="702,613,917,651"/>
<area shape="rect" id="node12" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="1210,557,1368,582"/>
<area shape="rect" id="node13" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="978,195,1129,221"/>
<area shape="rect" id="node14" href="s2n__cipher__suites_8c.html#a1fde427e44c9343e87af779ca1666b9e" title="s2n_set_cipher_as_client" alt="" coords="228,2193,400,2218"/>
<area shape="rect" id="node16" href="s2n__handshake_8h.html#a4406f29de6d52b587003368d656dab20" title="s2n_conn_set_handshake_type" alt="" coords="209,1159,418,1185"/>
<area shape="rect" id="node75" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5" title="s2n_stuffer_read_uint16" alt="" coords="1206,405,1371,430"/>
<area shape="rect" id="node91" href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f" title="s2n_prf_key_expansion" alt="" coords="728,981,890,1006"/>
<area shape="rect" id="node92" href="s2n__server__extensions_8c.html#aa5973260f0a72187b1331e5633795fe9" title="s2n_server_extensions_recv" alt="" coords="714,563,905,589"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="1656,747,1809,773"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="992,978,1115,1003"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="1441,1377,1602,1402"/>
<area shape="rect" id="node7" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="1656,1377,1809,1402"/>
<area shape="rect" id="node8" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1857,1851,1987,1877"/>
<area shape="rect" id="node9" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="2035,2202,2172,2227"/>
<area shape="rect" id="node10" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="2059,1851,2149,1877"/>
<area shape="rect" id="node11" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="2220,1851,2293,1877"/>
<area shape="rect" id="node15" href="s2n__cipher__suites_8c.html#aaa51227c2ad71438bda77345819ce0cb" title="s2n_cipher_suite_match" alt="" coords="477,3130,643,3155"/>
<area shape="rect" id="node17" href="s2n__resume_8c.html#af0cd9536cbece4a1bcebb3d69f8d4fd1" title="s2n_is_caching_enabled" alt="" coords="969,826,1138,851"/>
<area shape="rect" id="node21" href="s2n__resume_8c.html#aef2e99be4e9b1782b9d208ce80f02842" title="s2n_resume_from_cache" alt="" coords="723,1133,895,1158"/>
<area shape="rect" id="node24" href="s2n__random_8c.html#a5cfef84444cc08086a4098569c9f1fc8" title="s2n_get_public_random_data" alt="" coords="1190,3029,1387,3054"/>
<area shape="rect" id="node26" href="s2n__hash_8c.html#a0f3c4efbf552f607071e552dc0548ee6" title="s2n_hash_update" alt="" coords="1669,2643,1796,2669"/>
<area shape="rect" id="node33" href="s2n__handshake_8c.html#ae327aa8441c888a0bfca0058761abd97" title="s2n_handshake_write\l_header" alt="" coords="734,1245,885,1283"/>
<area shape="rect" id="node35" href="s2n__handshake_8c.html#a0a9a88c8621eab4358a80bb384dd3a3a" title="s2n_handshake_finish\l_header" alt="" coords="732,1182,886,1221"/>
<area shape="rect" id="node37" href="s2n__record_8h.html#a2df411911fffd95c6f847fc181c77025" title="s2n_record_max_write\l_payload_size" alt="" coords="482,967,638,1006"/>
<area shape="rect" id="node38" href="s2n__record_8h.html#a345384c81da35d41574e7a2c8319c7e3" title="s2n_record_write" alt="" coords="747,1547,871,1573"/>
<area shape="rect" id="node63" href="s2n__send_8c.html#a76828dc199bf174409532010ccbf2a07" title="s2n_flush" alt="" coords="521,1331,599,1357"/>
<area shape="rect" id="node66" href="s2n__stuffer_8c.html#a2b6b54f7856d92f06f823bc26d10f4ba" title="s2n_stuffer_wipe" alt="" coords="1228,2354,1350,2379"/>
<area shape="rect" id="node68" href="s2n__stuffer_8c.html#aff9283fe7b7a90e13c6c90014719354d" title="s2n_stuffer_copy" alt="" coords="1460,990,1583,1015"/>
<area shape="rect" id="node69" href="s2n__handshake_8c.html#a8930886c2b7fb7a73ef11c9c7c3c3b42" title="s2n_handshake_parse\l_header" alt="" coords="975,665,1132,703"/>
<area shape="rect" id="node71" href="s2n__stuffer_8c.html#a5d6db4ed8311ba66aec1227fceca24a9" title="s2n_stuffer_reread" alt="" coords="1222,1547,1355,1573"/>
<area shape="rect" id="node72" href="s2n__recv_8c.html#a807adeb1baad4849f782cfd4de10d113" title="s2n_read_full_record" alt="" coords="487,1699,633,1725"/>
<area shape="rect" id="node76" href="s2n__connection_8c.html#a746324b4543d50af7ebedc3ed91fbc57" title="s2n_connection_kill" alt="" coords="740,2979,878,3005"/>
<area shape="rect" id="node88" href="s2n__client__hello_8c.html#ac1466c1ce812576f187dacd032e682e1" title="s2n_sslv2_client_hello_recv" alt="" coords="466,398,654,423"/>
<area shape="rect" id="node90" href="s2n__alerts_8c.html#a45bdea2fd7faa208c0272f56bfb8c656" title="s2n_process_alert_fragment" alt="" coords="714,879,904,905"/>
<area shape="rect" id="node18" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="1209,1377,1368,1402"/>
<area shape="rect" id="node19" href="s2n__stuffer_8c.html#af5be81568462bd6626c1d00a939ff30d" title="s2n_stuffer_write_uint64" alt="" coords="1206,1070,1372,1095"/>
<area shape="rect" id="node20" href="s2n__stuffer_8c.html#ae1122959189bd03c92af5fd134016977" title="s2n_stuffer_read_uint64" alt="" coords="1206,758,1371,783"/>
<area shape="rect" id="node22" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="998,1079,1109,1105"/>
<area shape="rect" id="node23" href="s2n__stuffer_8c.html#afdc941db81df32f38b7800210f3f2d11" title="s2n_stuffer_raw_write" alt="" coords="978,1181,1129,1206"/>
<area shape="rect" id="node25" href="s2n__drbg_8c.html#a9fad975e364d5a398330eb937745f0e6" title="s2n_drbg_generate" alt="" coords="1453,3029,1590,3054"/>
<area shape="rect" id="node27" href="crypto_2md5_2md5_8h.html#abedf8217cb8c106b729d7b78dd7f4f46" title="MD5_Update" alt="" coords="1873,2601,1972,2626"/>
<area shape="rect" id="node28" href="crypto_2sha_2sha_8h.html#aadef8538263b2cb59f73cfc4e9e26ea0" title="SHA1_Update" alt="" coords="1869,2650,1976,2675"/>
<area shape="rect" id="node29" href="crypto_2sha_2sha_8h.html#ada9a5985070b4397bc01b6ea6ddba702" title="SHA224_Update" alt="" coords="1862,2699,1983,2725"/>
<area shape="rect" id="node30" href="crypto_2sha_2sha_8h.html#a9d2c95d9cac6ceb095f3e7c48efec95a" title="SHA256_Update" alt="" coords="1862,2749,1983,2774"/>
<area shape="rect" id="node31" href="crypto_2sha_2sha_8h.html#aa790a16716c1e350def2dfb1c7411ea2" title="SHA384_Update" alt="" coords="1862,2798,1983,2823"/>
<area shape="rect" id="node32" href="crypto_2sha_2sha_8h.html#a0728f9400cea5d81dad5e5a290c6f263" title="SHA512_Update" alt="" coords="1862,2551,1983,2577"/>
<area shape="rect" id="node34" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9" title="s2n_stuffer_write_uint24" alt="" coords="970,1230,1137,1255"/>
<area shape="rect" id="node36" href="s2n__stuffer_8c.html#ae1b97eb16ae517a82ec90a0e2b8c48e7" title="s2n_stuffer_rewrite" alt="" coords="986,1331,1121,1357"/>
<area shape="rect" id="node39" href="s2n__hmac_8c.html#ad9e0cc00ac39458cba7a9b1792429dbd" title="s2n_hmac_digest_size" alt="" coords="1210,2519,1367,2545"/>
<area shape="rect" id="node48" href="s2n__hmac_8c.html#ac4f30ec554d9a717c6269a5de8ae4acf" title="s2n_hmac_reset" alt="" coords="1462,2206,1581,2231"/>
<area shape="rect" id="node56" href="s2n__record__write_8c.html#a2df411911fffd95c6f847fc181c77025" title="s2n_record_max_write\l_payload_size" alt="" coords="975,1433,1132,1471"/>
<area shape="rect" id="node57" href="s2n__hmac_8c.html#a9dbba560a1ef91d4c2114c792f221333" title="s2n_hmac_update" alt="" coords="1223,2730,1354,2755"/>
<area shape="rect" id="node58" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f" title="s2n_stuffer_write_uint16" alt="" coords="1206,1498,1372,1523"/>
<area shape="rect" id="node59" href="s2n__aead_8c.html#aafbbe3f24a9f607cc8cb47a6af5a3505" title="s2n_aead_aad_init" alt="" coords="986,1598,1121,1623"/>
<area shape="rect" id="node60" href="s2n__sequence_8c.html#a650e459c699416b64accc69561e5fc16" title="s2n_increment_sequence\l_number" alt="" coords="966,2206,1141,2245"/>
<area shape="rect" id="node61" href="s2n__hmac_8c.html#a4501c4b9ea25f86e9c6c0e9d1bd9276b" title="s2n_hmac_digest" alt="" coords="1459,2405,1584,2430"/>
<area shape="rect" id="node40" href="s2n__hash_8c.html#aced4a438c67e79b78d41edfbb8b3e07a" title="s2n_hash_digest_size" alt="" coords="1445,2519,1598,2545"/>
<area shape="rect" id="node41" href="s2n__hash_8c.html#a684a3779eebad8329d41443454dd6fa2" title="s2n_hash_init" alt="" coords="1871,2003,1974,2029"/>
<area shape="rect" id="node49" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="1671,2403,1794,2429"/>
<area shape="rect" id="node42" href="crypto_2md5_2md5_8h.html#ae06ac750835b8cb838b6be5986ddcad9" title="MD5_Init" alt="" coords="2067,2099,2141,2125"/>
<area shape="rect" id="node43" href="crypto_2sha_2sha_8h.html#ad954eeef9b6210b817502847aea169fa" title="SHA1_Init" alt="" coords="2063,2149,2145,2174"/>
<area shape="rect" id="node44" href="crypto_2sha_2sha_8h.html#ab3befdb5a3202fa6d2eda5f3a06eadfa" title="SHA224_Init" alt="" coords="2056,1902,2152,1927"/>
<area shape="rect" id="node45" href="crypto_2sha_2sha_8h.html#ac96292b35fd2d8387259000aa378ae0d" title="SHA256_Init" alt="" coords="2056,1951,2152,1977"/>
<area shape="rect" id="node46" href="crypto_2sha_2sha_8h.html#ab7ca087b2f4896acc5a9e55a018fb99c" title="SHA384_Init" alt="" coords="2056,2001,2152,2026"/>
<area shape="rect" id="node47" href="crypto_2sha_2sha_8h.html#a4a803e92438efee8717c1dd0679de99c" title="SHA512_Init" alt="" coords="2056,2050,2152,2075"/>
<area shape="rect" id="node50" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="1880,2354,1965,2379"/>
<area shape="rect" id="node51" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="1876,2403,1969,2429"/>
<area shape="rect" id="node52" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="1869,2453,1976,2478"/>
<area shape="rect" id="node53" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="1869,2502,1976,2527"/>
<area shape="rect" id="node54" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="1869,2255,1976,2281"/>
<area shape="rect" id="node55" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="1869,2305,1976,2330"/>
<area shape="rect" id="node62" href="s2n__hash_8c.html#a3ad42d683b1126e7d8eb329b68382bc8" title="s2n_hash_reset" alt="" coords="1674,2301,1791,2326"/>
<area shape="rect" id="node64" href="s2n__stuffer_8h.html#a40bf61bc8745a2d894dd558a2885a66b" title="s2n_stuffer_send_to_fd" alt="" coords="1441,911,1602,937"/>
<area shape="rect" id="node65" href="s2n_8h.html#aa869211ca9b49f497cdb5579935203de" title="s2n_connection_wipe" alt="" coords="979,1953,1128,1978"/>
<area shape="rect" id="node67" href="s2n__hmac_8c.html#ad5056a3fc151619a2935471a5861fc3d" title="s2n_hmac_init" alt="" coords="1235,2003,1343,2029"/>
<area shape="rect" id="node70" href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c" title="s2n_stuffer_read_uint24" alt="" coords="1206,606,1371,631"/>
<area shape="rect" id="node73" href="s2n__stuffer_8h.html#a19fe623439e89aeadbac10e98b7a8896" title="s2n_stuffer_recv_from_fd" alt="" coords="1435,1775,1608,1801"/>
<area shape="rect" id="node74" href="s2n__record_8h.html#ada746040b578344a72196d5dd1d356fd" title="s2n_sslv2_record_header\l_parse" alt="" coords="966,449,1141,487"/>
<area shape="rect" id="node79" href="s2n__record_8h.html#af0794788139e3e2975022dd47f983eda" title="s2n_record_header_parse" alt="" coords="965,727,1142,753"/>
<area shape="rect" id="node80" href="s2n__record_8h.html#a26b47800a66fc8e167d92b302e0b7079" title="s2n_record_parse" alt="" coords="745,2242,874,2267"/>
<area shape="rect" id="node77" href="s2n__random_8c.html#a8aabcb071120a9849d4615358000a8a6" title="s2n_public_random" alt="" coords="985,3029,1122,3054"/>
<area shape="rect" id="node78" href="s2n__timer_8c.html#a78c722b16f52af289f500f2f6e471904" title="s2n_timer_start" alt="" coords="997,2979,1110,3005"/>
<area shape="rect" id="node81" href="s2n__record__read_8c.html#af0794788139e3e2975022dd47f983eda" title="s2n_record_header_parse" alt="" coords="965,777,1142,802"/>
<area shape="rect" id="node82" href="s2n__stuffer_8c.html#a49bb9749c055c6fb6f713cebeaa14cb5" title="s2n_stuffer_read" alt="" coords="993,563,1114,589"/>
<area shape="rect" id="node83" href="s2n__cbc_8c.html#a49a0a2c5708c690625b2474555727b80" title="s2n_verify_cbc" alt="" coords="998,2625,1109,2650"/>
<area shape="rect" id="node87" href="s2n__hmac_8c.html#a7787cefe78aedac6b20db11cc451a433" title="s2n_hmac_digest_verify" alt="" coords="971,2726,1136,2751"/>
<area shape="rect" id="node84" href="s2n__hmac_8c.html#a6007599a9ecbe64464dc464093931f6a" title="s2n_hmac_copy" alt="" coords="1230,2569,1348,2594"/>
<area shape="rect" id="node85" href="s2n__hmac_8c.html#a2afcf63a3b7f8fc08957f53b820ad39f" title="s2n_hmac_digest_two\l_compression_rounds" alt="" coords="1212,2618,1366,2657"/>
<area shape="rect" id="node86" href="s2n__server__fuzz__test__overrides_8c.html#a407f3056ab784369c0ccb3359532669a" title="s2n_constant_time_equals" alt="" coords="1199,2681,1379,2706"/>
<area shape="rect" id="node89" href="s2n__cipher__suites_8c.html#a93d49c8f6f3f8a5f4b7e703a61421b7b" title="s2n_set_cipher_as_sslv2\l_server" alt="" coords="724,449,895,487"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab1bb9b2e08cb682e4bb9b156b49a0afa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_cert_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__cert_8c_source.html#l00070">70</a> of file <a class="el" href="s2n__server__cert_8c_source.html">s2n_server_cert.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__cert__chain.html">s2n_cert_chain</a> *head = conn-&gt;<a class="code" href="structs2n__connection.html#abfab1f3796089e3576e73286c0b6889c">server</a>-&gt;<a class="code" href="structs2n__crypto__parameters.html#a20dd75e38ae2f99535e509425e4dface">chosen_cert_chain</a>-&gt;<a class="code" href="structs2n__cert__chain__and__key.html#a006e23cea0adf1733edba58ea15cd7ed">head</a>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9">s2n_stuffer_write_uint24</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, conn-&gt;<a class="code" href="structs2n__connection.html#abfab1f3796089e3576e73286c0b6889c">server</a>-&gt;<a class="code" href="structs2n__crypto__parameters.html#a20dd75e38ae2f99535e509425e4dface">chosen_cert_chain</a>-&gt;<a class="code" href="structs2n__cert__chain__and__key.html#af6903d14cb3f4627a8cfe70d368b1413">chain_size</a>));</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">while</span> (head) {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9">s2n_stuffer_write_uint24</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, head-&gt;<a class="code" href="structs2n__cert__chain.html#a875a2920fc4ec101b865d6006baa3b75">cert</a>.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a>));</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, head-&gt;<a class="code" href="structs2n__cert__chain.html#a875a2920fc4ec101b865d6006baa3b75">cert</a>.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a>, head-&gt;<a class="code" href="structs2n__cert__chain.html#a875a2920fc4ec101b865d6006baa3b75">cert</a>.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a>));</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        head = head-&gt;<a class="code" href="structs2n__cert__chain.html#ae78fa31ff74363e3d7351dd25f5a0745">next</a>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_abfab1f3796089e3576e73286c0b6889c"><div class="ttname"><a href="structs2n__connection.html#abfab1f3796089e3576e73286c0b6889c">s2n_connection::server</a></div><div class="ttdeci">struct s2n_crypto_parameters * server</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00081">s2n_connection.h:81</a></div></div>
<div class="ttc" id="structs2n__blob_html_ab2c6b258f02add8fdf4cfc7c371dd772"><div class="ttname"><a href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">s2n_blob::size</a></div><div class="ttdeci">uint32_t size</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00022">s2n_blob.h:22</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a20dd75e38ae2f99535e509425e4dface"><div class="ttname"><a href="structs2n__crypto__parameters.html#a20dd75e38ae2f99535e509425e4dface">s2n_crypto_parameters::chosen_cert_chain</a></div><div class="ttdeci">struct s2n_cert_chain_and_key * chosen_cert_chain</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00049">s2n_crypto.h:49</a></div></div>
<div class="ttc" id="structs2n__cert__chain__and__key_html_a006e23cea0adf1733edba58ea15cd7ed"><div class="ttname"><a href="structs2n__cert__chain__and__key.html#a006e23cea0adf1733edba58ea15cd7ed">s2n_cert_chain_and_key::head</a></div><div class="ttdeci">struct s2n_cert_chain * head</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00033">s2n_config.h:33</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aa78701a9bb01def1efcbfa30ba0bdfc9"><div class="ttname"><a href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9">s2n_stuffer_write_uint24</a></div><div class="ttdeci">int s2n_stuffer_write_uint24(struct s2n_stuffer *stuffer, const uint32_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00290">s2n_stuffer.c:290</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="structs2n__cert__chain_html_ae78fa31ff74363e3d7351dd25f5a0745"><div class="ttname"><a href="structs2n__cert__chain.html#ae78fa31ff74363e3d7351dd25f5a0745">s2n_cert_chain::next</a></div><div class="ttdeci">struct s2n_cert_chain * next</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00028">s2n_config.h:28</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="structs2n__cert__chain__and__key_html_af6903d14cb3f4627a8cfe70d368b1413"><div class="ttname"><a href="structs2n__cert__chain__and__key.html#af6903d14cb3f4627a8cfe70d368b1413">s2n_cert_chain_and_key::chain_size</a></div><div class="ttdeci">uint32_t chain_size</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00032">s2n_config.h:32</a></div></div>
<div class="ttc" id="structs2n__cert__chain_html"><div class="ttname"><a href="structs2n__cert__chain.html">s2n_cert_chain</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00026">s2n_config.h:26</a></div></div>
<div class="ttc" id="structs2n__cert__chain_html_a875a2920fc4ec101b865d6006baa3b75"><div class="ttname"><a href="structs2n__cert__chain.html#a875a2920fc4ec101b865d6006baa3b75">s2n_cert_chain::cert</a></div><div class="ttdeci">struct s2n_blob cert</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00027">s2n_config.h:27</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_afe5e2db5400000f371d2245e1e0669eb"><div class="ttname"><a href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a></div><div class="ttdeci">int s2n_stuffer_write_bytes(struct s2n_stuffer *stuffer, const uint8_t *data, const uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00224">s2n_stuffer.c:224</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_ab1bb9b2e08cb682e4bb9b156b49a0afa_cgraph.png" border="0" usemap="#s2n__tls_8h_ab1bb9b2e08cb682e4bb9b156b49a0afa_cgraph" alt=""/></div>
<map name="s2n__tls_8h_ab1bb9b2e08cb682e4bb9b156b49a0afa_cgraph" id="s2n__tls_8h_ab1bb9b2e08cb682e4bb9b156b49a0afa_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9" title="s2n_stuffer_write_uint24" alt="" coords="207,5,373,31"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="421,31,583,56"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="631,31,785,56"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="833,31,963,56"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1011,5,1147,31"/>
<area shape="rect" id="node7" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1034,55,1124,80"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1195,55,1269,80"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aea75ffb292cac5d71183fee7c14b7496"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_cert_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__cert_8c_source.html#l00029">29</a> of file <a class="el" href="s2n__server__cert_8c_source.html">s2n_server_cert.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    uint32_t size_of_all_certificates;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c">s2n_stuffer_read_uint24</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, &amp;size_of_all_certificates));</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (size_of_all_certificates &gt; <a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>) || size_of_all_certificates &lt; 3) {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">int</span> certificate_count = 0;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>)) {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        uint32_t certificate_size;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c">s2n_stuffer_read_uint24</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, &amp;certificate_size));</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">if</span> (certificate_size &gt; <a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>) || certificate_size == 0) {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> asn1cert;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        asn1cert.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = <a class="code" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, certificate_size);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        asn1cert.size = certificate_size;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(asn1cert.data);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="comment">/* TODO: certificate validation goes here */</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <a class="code" href="s2n__safety_8h.html#a83da623ffe1132fa8ff86945161d4ed7">gt_check</a>(certificate_size, 0);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="comment">/* Pull the public key from the first certificate */</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keywordflow">if</span> (certificate_count == 0) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__rsa_8c.html#a4cd1d9d3c5bb5e42c5301366b38b361a">s2n_asn1der_to_rsa_public_key</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#ac66524c1ba7864aa76ef5774384e7579">server_rsa_public_key</a>, &amp;asn1cert));</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        certificate_count++;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="s2n__safety_8h.html#a033f3870a2832a9972eadb4700f725b9">gte_check</a>(certificate_count, 1);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__stuffer_8h_html_a56d3da0e05e4c05eb87a343306c4f170"><div class="ttname"><a href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a></div><div class="ttdeci">#define s2n_stuffer_data_available(s)  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00045">s2n_stuffer.h:45</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_ac66524c1ba7864aa76ef5774384e7579"><div class="ttname"><a href="structs2n__crypto__parameters.html#ac66524c1ba7864aa76ef5774384e7579">s2n_crypto_parameters::server_rsa_public_key</a></div><div class="ttdeci">struct s2n_rsa_public_key server_rsa_public_key</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00046">s2n_crypto.h:46</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a83da623ffe1132fa8ff86945161d4ed7"><div class="ttname"><a href="s2n__safety_8h.html#a83da623ffe1132fa8ff86945161d4ed7">gt_check</a></div><div class="ttdeci">#define gt_check(n, min)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00035">s2n_safety.h:35</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a5148294f6ed0bf894afc83a31ee4f8a5"><div class="ttname"><a href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a></div><div class="ttdeci">void * s2n_stuffer_raw_read(struct s2n_stuffer *stuffer, uint32_t data_len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00149">s2n_stuffer.c:149</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00051">s2n_errno.h:51</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a372ad5deb70573456ecde442c0c466be"><div class="ttname"><a href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a></div><div class="ttdeci">#define notnull_check(ptr)                  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00025">s2n_safety.h:25</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a033f3870a2832a9972eadb4700f725b9"><div class="ttname"><a href="s2n__safety_8h.html#a033f3870a2832a9972eadb4700f725b9">gte_check</a></div><div class="ttdeci">#define gte_check(n, min)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00033">s2n_safety.h:33</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a71787bb6eeba3413137cde42d32a0f6c"><div class="ttname"><a href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c">s2n_stuffer_read_uint24</a></div><div class="ttdeci">int s2n_stuffer_read_uint24(struct s2n_stuffer *stuffer, uint32_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00277">s2n_stuffer.c:277</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="s2n__rsa_8c_html_a4cd1d9d3c5bb5e42c5301366b38b361a"><div class="ttname"><a href="s2n__rsa_8c.html#a4cd1d9d3c5bb5e42c5301366b38b361a">s2n_asn1der_to_rsa_public_key</a></div><div class="ttdeci">int s2n_asn1der_to_rsa_public_key(struct s2n_rsa_public_key *key, struct s2n_blob *asn1der)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__rsa_8c_source.html#l00031">s2n_rsa.c:31</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_aea75ffb292cac5d71183fee7c14b7496_cgraph.png" border="0" usemap="#s2n__tls_8h_aea75ffb292cac5d71183fee7c14b7496_cgraph" alt=""/></div>
<map name="s2n__tls_8h_aea75ffb292cac5d71183fee7c14b7496_cgraph" id="s2n__tls_8h_aea75ffb292cac5d71183fee7c14b7496_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c" title="s2n_stuffer_read_uint24" alt="" coords="203,7,368,32"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="210,56,360,81"/>
<area shape="rect" id="node6" href="s2n__rsa_8c.html#a4cd1d9d3c5bb5e42c5301366b38b361a" title="s2n_asn1der_to_rsa\l_public_key" alt="" coords="214,128,357,167"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="416,5,576,31"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="624,31,777,56"/>
<area shape="rect" id="node7" href="crypto_2x509_2x509_8h.html#a97c3703b14a1f4a987c5d31cdf6cb205" title="X509_get_pubkey" alt="" coords="432,107,560,132"/>
<area shape="rect" id="node8" href="crypto_2evp_2evp_8h.html#a448d9f9209a54694aff045d403850db7" title="EVP_PKEY_free" alt="" coords="435,156,557,181"/>
<area shape="rect" id="node9" href="crypto_2evp_2evp_8h.html#a099bf05b0933b7d7457dc5d74a29daf1" title="EVP_PKEY_get1_RSA" alt="" coords="416,205,576,231"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af4c440c5d4b149bdc7b42a1fdf06b334"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_status_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__ocsp__stapling_8c_source.html#l00027">27</a> of file <a class="el" href="s2n__ocsp__stapling_8c_source.html">s2n_ocsp_stapling.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    uint32_t <a class="code" href="crypto_2asn1_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a> = conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#acd0d45f80129861144d237591eee6c5f">cert_and_key_pairs</a>-&gt;<a class="code" href="structs2n__cert__chain__and__key.html#a4baf31cc326e006017c66fe41b4194d6">ocsp_status</a>.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a> + 4;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9">s2n_stuffer_write_uint24</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, length));</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, (uint8_t) <a class="code" href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8">S2N_STATUS_REQUEST_OCSP</a>));</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9">s2n_stuffer_write_uint24</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#acd0d45f80129861144d237591eee6c5f">cert_and_key_pairs</a>-&gt;<a class="code" href="structs2n__cert__chain__and__key.html#a4baf31cc326e006017c66fe41b4194d6">ocsp_status</a>.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a>));</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde">s2n_stuffer_write</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, &amp;conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#acd0d45f80129861144d237591eee6c5f">cert_and_key_pairs</a>-&gt;<a class="code" href="structs2n__cert__chain__and__key.html#a4baf31cc326e006017c66fe41b4194d6">ocsp_status</a>));</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div><div class="ttc" id="structs2n__blob_html_ab2c6b258f02add8fdf4cfc7c371dd772"><div class="ttname"><a href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">s2n_blob::size</a></div><div class="ttdeci">uint32_t size</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00022">s2n_blob.h:22</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="crypto_2asn1_2asn1_8h_html_a5a2d57a92488e64c730cabc247c9d5b5"><div class="ttname"><a href="crypto_2asn1_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a></div><div class="ttdeci">const unsigned char long length</div><div class="ttdef"><b>Definition:</b> <a href="crypto_2asn1_2asn1_8h_source.html#l00907">asn1.h:907</a></div></div>
<div class="ttc" id="structs2n__connection_html_a7d70bb7bed95daae1233293126bb9523"><div class="ttname"><a href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">s2n_connection::config</a></div><div class="ttdeci">struct s2n_config * config</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00041">s2n_connection.h:41</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aa78701a9bb01def1efcbfa30ba0bdfc9"><div class="ttname"><a href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9">s2n_stuffer_write_uint24</a></div><div class="ttdeci">int s2n_stuffer_write_uint24(struct s2n_stuffer *stuffer, const uint32_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00290">s2n_stuffer.c:290</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aaca63d5bb519a92734bd0287199a7f5a"><div class="ttname"><a href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a></div><div class="ttdeci">int s2n_stuffer_write_uint8(struct s2n_stuffer *stuffer, const uint8_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00249">s2n_stuffer.c:249</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_ad77ea23089bbeb19b897a73bf6ca3fde"><div class="ttname"><a href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde">s2n_stuffer_write</a></div><div class="ttdeci">int s2n_stuffer_write(struct s2n_stuffer *stuffer, const struct s2n_blob *in)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00219">s2n_stuffer.c:219</a></div></div>
<div class="ttc" id="structs2n__cert__chain__and__key_html_a4baf31cc326e006017c66fe41b4194d6"><div class="ttname"><a href="structs2n__cert__chain__and__key.html#a4baf31cc326e006017c66fe41b4194d6">s2n_cert_chain_and_key::ocsp_status</a></div><div class="ttdeci">struct s2n_blob ocsp_status</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00035">s2n_config.h:35</a></div></div>
<div class="ttc" id="structs2n__config_html_acd0d45f80129861144d237591eee6c5f"><div class="ttname"><a href="structs2n__config.html#acd0d45f80129861144d237591eee6c5f">s2n_config::cert_and_key_pairs</a></div><div class="ttdeci">struct s2n_cert_chain_and_key * cert_and_key_pairs</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00041">s2n_config.h:41</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="s2n_8h_html_a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8"><div class="ttname"><a href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8">S2N_STATUS_REQUEST_OCSP</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00067">s2n.h:67</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_af4c440c5d4b149bdc7b42a1fdf06b334_cgraph.png" border="0" usemap="#s2n__tls_8h_af4c440c5d4b149bdc7b42a1fdf06b334_cgraph" alt=""/></div>
<map name="s2n__tls_8h_af4c440c5d4b149bdc7b42a1fdf06b334_cgraph" id="s2n__tls_8h_af4c440c5d4b149bdc7b42a1fdf06b334_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9" title="s2n_stuffer_write_uint24" alt="" coords="220,5,386,31"/>
<area shape="rect" id="node9" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="224,55,383,80"/>
<area shape="rect" id="node10" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="242,104,364,129"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="434,55,596,80"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="644,55,798,80"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="846,55,976,80"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1024,29,1161,55"/>
<area shape="rect" id="node7" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1048,79,1137,104"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1209,79,1282,104"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6688277e6e5d779a28d99ec6d023a949"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_status_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__ocsp__stapling_8c_source.html#l00039">39</a> of file <a class="el" href="s2n__ocsp__stapling_8c_source.html">s2n_ocsp_stapling.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    uint8_t <a class="code" href="crypto_2x509_2x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> status = {.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = NULL,.size = 0 };</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, &amp;type));</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c">s2n_stuffer_read_uint24</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, &amp;status.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a>));</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    status.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = <a class="code" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, status.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a>);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(status.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (type == <a class="code" href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8">S2N_STATUS_REQUEST_OCSP</a>) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__mem_8c.html#a6fb5d30c5bbbc73694b21821ff2da82f">s2n_alloc</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#ab3cd78ec62aea98bf900913bb379d523">status_response</a>, status.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a>));</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad77a50a47d8de0b8e6c8d4beffed95b2">memcpy_check</a>(conn-&gt;<a class="code" href="structs2n__connection.html#ab3cd78ec62aea98bf900913bb379d523">status_response</a>.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a>, status.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a>, status.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a>);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        conn-&gt;<a class="code" href="structs2n__connection.html#ab3cd78ec62aea98bf900913bb379d523">status_response</a>.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a> = status.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div><div class="ttc" id="structs2n__blob_html_ab2c6b258f02add8fdf4cfc7c371dd772"><div class="ttname"><a href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">s2n_blob::size</a></div><div class="ttdeci">uint32_t size</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00022">s2n_blob.h:22</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="s2n__mem_8c_html_a6fb5d30c5bbbc73694b21821ff2da82f"><div class="ttname"><a href="s2n__mem_8c.html#a6fb5d30c5bbbc73694b21821ff2da82f">s2n_alloc</a></div><div class="ttdeci">int s2n_alloc(struct s2n_blob *b, uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__mem_8c_source.html#l00040">s2n_mem.c:40</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a5148294f6ed0bf894afc83a31ee4f8a5"><div class="ttname"><a href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a></div><div class="ttdeci">void * s2n_stuffer_raw_read(struct s2n_stuffer *stuffer, uint32_t data_len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00149">s2n_stuffer.c:149</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a372ad5deb70573456ecde442c0c466be"><div class="ttname"><a href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a></div><div class="ttdeci">#define notnull_check(ptr)                  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00025">s2n_safety.h:25</a></div></div>
<div class="ttc" id="crypto_2x509_2x509_8h_html_ab512b8f495325c7ea0f5a5a5d3f938eb"><div class="ttname"><a href="crypto_2x509_2x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a></div><div class="ttdeci">const ASN1_OBJECT int type</div><div class="ttdef"><b>Definition:</b> <a href="crypto_2x509_2x509_8h_source.html#l01121">x509.h:1121</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad77a50a47d8de0b8e6c8d4beffed95b2"><div class="ttname"><a href="s2n__safety_8h.html#ad77a50a47d8de0b8e6c8d4beffed95b2">memcpy_check</a></div><div class="ttdeci">#define memcpy_check(d, s, n)      </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00029">s2n_safety.h:29</a></div></div>
<div class="ttc" id="structs2n__connection_html_ab3cd78ec62aea98bf900913bb379d523"><div class="ttname"><a href="structs2n__connection.html#ab3cd78ec62aea98bf900913bb379d523">s2n_connection::status_response</a></div><div class="ttdeci">struct s2n_blob status_response</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00158">s2n_connection.h:158</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a1178687b6091eb483d135c149e87fb0b"><div class="ttname"><a href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a></div><div class="ttdeci">int s2n_stuffer_read_uint8(struct s2n_stuffer *stuffer, uint8_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00242">s2n_stuffer.c:242</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a71787bb6eeba3413137cde42d32a0f6c"><div class="ttname"><a href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c">s2n_stuffer_read_uint24</a></div><div class="ttdeci">int s2n_stuffer_read_uint24(struct s2n_stuffer *stuffer, uint32_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00277">s2n_stuffer.c:277</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="s2n_8h_html_a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8"><div class="ttname"><a href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8">S2N_STATUS_REQUEST_OCSP</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00067">s2n.h:67</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a6688277e6e5d779a28d99ec6d023a949_cgraph.png" border="0" usemap="#s2n__tls_8h_a6688277e6e5d779a28d99ec6d023a949_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a6688277e6e5d779a28d99ec6d023a949_cgraph" id="s2n__tls_8h_a6688277e6e5d779a28d99ec6d023a949_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="220,5,377,31"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c" title="s2n_stuffer_read_uint24" alt="" coords="216,55,381,80"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="434,105,584,131"/>
<area shape="rect" id="node7" href="s2n__mem_8c.html#a6fb5d30c5bbbc73694b21821ff2da82f" title="s2n_alloc" alt="" coords="260,156,338,181"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="429,55,590,80"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="638,80,790,105"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="465,156,554,181"/>
<area shape="rect" id="node9" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="677,156,750,181"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a940aed548236e016710e5ef69dc98df8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_key_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__key__exchange_8c_source.html#l00210">210</a> of file <a class="el" href="s2n__server__key__exchange_8c_source.html">s2n_server_key_exchange.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;{</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a5446cce0337d14b74b38f2a81ea19670">cipher_suite</a>-&gt;<a class="code" href="structs2n__cipher__suite.html#aaf88ce0be23d983d21bbbecfce1c293d">key_exchange_alg</a>-&gt;<a class="code" href="structs2n__key__exchange__algorithm.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a> &amp; <a class="code" href="s2n__cipher__suites_8h.html#a12019f7e03ca6cbe2075ef675d5e5dec">S2N_KEY_EXCHANGE_ECC</a>) {</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_ecdhe_server_key_send(conn));</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_dhe_server_key_send(conn));</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a5446cce0337d14b74b38f2a81ea19670"><div class="ttname"><a href="structs2n__crypto__parameters.html#a5446cce0337d14b74b38f2a81ea19670">s2n_crypto_parameters::cipher_suite</a></div><div class="ttdeci">struct s2n_cipher_suite * cipher_suite</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00052">s2n_crypto.h:52</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="structs2n__key__exchange__algorithm_html_a1e87af3c18a2fd36c61faf89949bdc3f"><div class="ttname"><a href="structs2n__key__exchange__algorithm.html#a1e87af3c18a2fd36c61faf89949bdc3f">s2n_key_exchange_algorithm::flags</a></div><div class="ttdeci">uint16_t flags</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00039">s2n_cipher_suites.h:39</a></div></div>
<div class="ttc" id="s2n__cipher__suites_8h_html_a12019f7e03ca6cbe2075ef675d5e5dec"><div class="ttname"><a href="s2n__cipher__suites_8h.html#a12019f7e03ca6cbe2075ef675d5e5dec">S2N_KEY_EXCHANGE_ECC</a></div><div class="ttdeci">#define S2N_KEY_EXCHANGE_ECC</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00035">s2n_cipher_suites.h:35</a></div></div>
<div class="ttc" id="structs2n__cipher__suite_html_aaf88ce0be23d983d21bbbecfce1c293d"><div class="ttname"><a href="structs2n__cipher__suite.html#aaf88ce0be23d983d21bbbecfce1c293d">s2n_cipher_suite::key_exchange_alg</a></div><div class="ttdeci">const struct s2n_key_exchange_algorithm * key_exchange_alg</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00048">s2n_cipher_suites.h:48</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a940aed548236e016710e5ef69dc98df8_cgraph.png" border="0" usemap="#s2n__tls_8h_a940aed548236e016710e5ef69dc98df8_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a940aed548236e016710e5ef69dc98df8_cgraph" id="s2n__tls_8h_a940aed548236e016710e5ef69dc98df8_cgraph">
<area shape="rect" id="node2" href="s2n__hash_8c.html#a684a3779eebad8329d41443454dd6fa2" title="s2n_hash_init" alt="" coords="268,153,372,179"/>
<area shape="rect" id="node9" href="s2n__ecc_8c.html#aeec802fc7158ae21261d4601d559cf8f" title="s2n_ecc_generate_ephemeral_key" alt="" coords="205,299,435,324"/>
<area shape="rect" id="node10" href="s2n__ecc_8c.html#a22f487d2899e677ff0567f080c25cdd8" title="s2n_ecc_write_ecc_params" alt="" coords="227,400,413,425"/>
<area shape="rect" id="node11" href="s2n__stuffer_8c.html#afdc941db81df32f38b7800210f3f2d11" title="s2n_stuffer_raw_write" alt="" coords="497,499,648,524"/>
<area shape="rect" id="node17" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="493,301,652,327"/>
<area shape="rect" id="node19" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f" title="s2n_stuffer_write_uint16" alt="" coords="490,449,656,475"/>
<area shape="rect" id="node22" href="s2n__hash_8c.html#a0f3c4efbf552f607071e552dc0548ee6" title="s2n_hash_update" alt="" coords="256,745,384,771"/>
<area shape="rect" id="node29" href="s2n__rsa_8c.html#a7f7235a51c9e042f8be94d1f9af57799" title="s2n_rsa_private_encrypted_size" alt="" coords="213,868,427,893"/>
<area shape="rect" id="node31" href="s2n__rsa_8c.html#a4d61a68eccd5b587339fe9d8726a9b9f" title="s2n_rsa_sign" alt="" coords="270,992,370,1017"/>
<area shape="rect" id="node40" href="s2n__dhe_8c.html#a3de1805a7078d382e8f9c8fd776b75b0" title="s2n_dh_params_copy" alt="" coords="244,1053,396,1079"/>
<area shape="rect" id="node42" href="s2n__dhe_8c.html#a52481b6c08da550c51db7be50445c54a" title="s2n_dh_generate_ephemeral_key" alt="" coords="208,1127,432,1152"/>
<area shape="rect" id="node44" href="s2n__dhe_8c.html#a847b2d0a73d4e014a41c50b9780b8245" title="s2n_dh_params_to_p_g_Ys" alt="" coords="226,552,414,577"/>
<area shape="rect" id="node3" href="crypto_2md5_2md5_8h.html#ae06ac750835b8cb838b6be5986ddcad9" title="MD5_Init" alt="" coords="535,5,610,31"/>
<area shape="rect" id="node4" href="crypto_2sha_2sha_8h.html#ad954eeef9b6210b817502847aea169fa" title="SHA1_Init" alt="" coords="532,55,613,80"/>
<area shape="rect" id="node5" href="crypto_2sha_2sha_8h.html#ab3befdb5a3202fa6d2eda5f3a06eadfa" title="SHA224_Init" alt="" coords="525,104,621,129"/>
<area shape="rect" id="node6" href="crypto_2sha_2sha_8h.html#ac96292b35fd2d8387259000aa378ae0d" title="SHA256_Init" alt="" coords="525,153,621,179"/>
<area shape="rect" id="node7" href="crypto_2sha_2sha_8h.html#ab7ca087b2f4896acc5a9e55a018fb99c" title="SHA384_Init" alt="" coords="525,203,621,228"/>
<area shape="rect" id="node8" href="crypto_2sha_2sha_8h.html#a4a803e92438efee8717c1dd0679de99c" title="SHA512_Init" alt="" coords="525,252,621,277"/>
<area shape="rect" id="node20" href="crypto_2ec_2ec_8h.html#a4801169f999e2527d5368ec2a8cfc20a" title="EC_KEY_get0_public_key" alt="" coords="484,400,662,425"/>
<area shape="rect" id="node21" href="crypto_2ec_2ec_8h.html#aa11ad233e9c9a49d34d33e2feef70c33" title="EC_KEY_get0_group" alt="" coords="498,351,647,376"/>
<area shape="rect" id="node12" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="921,473,1074,499"/>
<area shape="rect" id="node13" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1122,473,1252,499"/>
<area shape="rect" id="node14" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1300,448,1437,473"/>
<area shape="rect" id="node15" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1324,497,1414,523"/>
<area shape="rect" id="node16" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1485,497,1558,523"/>
<area shape="rect" id="node18" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="711,448,873,473"/>
<area shape="rect" id="node23" href="crypto_2md5_2md5_8h.html#abedf8217cb8c106b729d7b78dd7f4f46" title="MD5_Update" alt="" coords="523,647,623,672"/>
<area shape="rect" id="node24" href="crypto_2sha_2sha_8h.html#aadef8538263b2cb59f73cfc4e9e26ea0" title="SHA1_Update" alt="" coords="519,696,626,721"/>
<area shape="rect" id="node25" href="crypto_2sha_2sha_8h.html#ada9a5985070b4397bc01b6ea6ddba702" title="SHA224_Update" alt="" coords="512,745,633,771"/>
<area shape="rect" id="node26" href="crypto_2sha_2sha_8h.html#a9d2c95d9cac6ceb095f3e7c48efec95a" title="SHA256_Update" alt="" coords="512,795,633,820"/>
<area shape="rect" id="node27" href="crypto_2sha_2sha_8h.html#aa790a16716c1e350def2dfb1c7411ea2" title="SHA384_Update" alt="" coords="512,844,633,869"/>
<area shape="rect" id="node28" href="crypto_2sha_2sha_8h.html#a0728f9400cea5d81dad5e5a290c6f263" title="SHA512_Update" alt="" coords="512,893,633,919"/>
<area shape="rect" id="node30" href="crypto_2rsa_2rsa_8h.html#af8cdf91fccaa56fa80cae55eece27d9d" title="RSA_size" alt="" coords="533,943,613,968"/>
<area shape="rect" id="node32" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="512,992,634,1017"/>
<area shape="rect" id="node39" href="crypto_2rsa_2rsa_8h.html#a381db3f60450984caceebb01035fe62e" title="RSA_sign" alt="" coords="532,1041,613,1067"/>
<area shape="rect" id="node33" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="749,868,835,893"/>
<area shape="rect" id="node34" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="745,917,838,943"/>
<area shape="rect" id="node35" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="738,967,845,992"/>
<area shape="rect" id="node36" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="738,1016,845,1041"/>
<area shape="rect" id="node37" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="738,1065,845,1091"/>
<area shape="rect" id="node38" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="738,1115,845,1140"/>
<area shape="rect" id="node41" href="crypto_2dh_2dh_8h.html#ab71b4cb56c0ad4c6bbf3606aab6dd175" title="DHparams_dup" alt="" coords="515,1091,630,1116"/>
<area shape="rect" id="node43" href="crypto_2dh_2dh_8h.html#ab90ec6b9e64f62c05754731c0c13ea01" title="DH_generate_key" alt="" coords="508,1140,637,1165"/>
<area shape="rect" id="node45" href="s2n__dhe_8c.html#abdd990a3dbfa9733ba67c06fa8c1a056" title="s2n_check_all_dh_params" alt="" coords="483,548,663,573"/>
<area shape="rect" id="node46" href="crypto_2bn_2bn_8h.html#a72e393df20fc0ec8e761204fe5f28c17" title="BN_bn2bin" alt="" coords="529,597,616,623"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a933dc8cdaebb70f8a7364e390d9deeaf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_key_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__key__exchange_8c_source.html#l00035">35</a> of file <a class="el" href="s2n__server__key__exchange_8c_source.html">s2n_server_key_exchange.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a5446cce0337d14b74b38f2a81ea19670">cipher_suite</a>-&gt;<a class="code" href="structs2n__cipher__suite.html#aaf88ce0be23d983d21bbbecfce1c293d">key_exchange_alg</a>-&gt;<a class="code" href="structs2n__key__exchange__algorithm.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a> &amp; <a class="code" href="s2n__cipher__suites_8h.html#a12019f7e03ca6cbe2075ef675d5e5dec">S2N_KEY_EXCHANGE_ECC</a>) {</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_ecdhe_server_key_recv(conn));</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_dhe_server_key_recv(conn));</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a5446cce0337d14b74b38f2a81ea19670"><div class="ttname"><a href="structs2n__crypto__parameters.html#a5446cce0337d14b74b38f2a81ea19670">s2n_crypto_parameters::cipher_suite</a></div><div class="ttdeci">struct s2n_cipher_suite * cipher_suite</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00052">s2n_crypto.h:52</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="structs2n__key__exchange__algorithm_html_a1e87af3c18a2fd36c61faf89949bdc3f"><div class="ttname"><a href="structs2n__key__exchange__algorithm.html#a1e87af3c18a2fd36c61faf89949bdc3f">s2n_key_exchange_algorithm::flags</a></div><div class="ttdeci">uint16_t flags</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00039">s2n_cipher_suites.h:39</a></div></div>
<div class="ttc" id="s2n__cipher__suites_8h_html_a12019f7e03ca6cbe2075ef675d5e5dec"><div class="ttname"><a href="s2n__cipher__suites_8h.html#a12019f7e03ca6cbe2075ef675d5e5dec">S2N_KEY_EXCHANGE_ECC</a></div><div class="ttdeci">#define S2N_KEY_EXCHANGE_ECC</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00035">s2n_cipher_suites.h:35</a></div></div>
<div class="ttc" id="structs2n__cipher__suite_html_aaf88ce0be23d983d21bbbecfce1c293d"><div class="ttname"><a href="structs2n__cipher__suite.html#aaf88ce0be23d983d21bbbecfce1c293d">s2n_cipher_suite::key_exchange_alg</a></div><div class="ttdeci">const struct s2n_key_exchange_algorithm * key_exchange_alg</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00048">s2n_cipher_suites.h:48</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a933dc8cdaebb70f8a7364e390d9deeaf_cgraph.png" border="0" usemap="#s2n__tls_8h_a933dc8cdaebb70f8a7364e390d9deeaf_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a933dc8cdaebb70f8a7364e390d9deeaf_cgraph" id="s2n__tls_8h_a933dc8cdaebb70f8a7364e390d9deeaf_cgraph">
<area shape="rect" id="node2" href="s2n__ecc_8c.html#a5e4d1afa56f139f9e455415fa3abc4b2" title="s2n_ecc_read_ecc_params" alt="" coords="201,167,387,192"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="464,5,614,31"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="460,317,617,343"/>
<area shape="rect" id="node16" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5" title="s2n_stuffer_read_uint16" alt="" coords="691,237,856,263"/>
<area shape="rect" id="node21" href="s2n__hash_8c.html#a684a3779eebad8329d41443454dd6fa2" title="s2n_hash_init" alt="" coords="242,491,346,516"/>
<area shape="rect" id="node28" href="s2n__hash_8c.html#a0f3c4efbf552f607071e552dc0548ee6" title="s2n_hash_update" alt="" coords="230,761,358,787"/>
<area shape="rect" id="node35" href="s2n__rsa_8c.html#a4c3db82f148a27d966bada97f3dbe45a" title="s2n_rsa_verify" alt="" coords="240,959,348,984"/>
<area shape="rect" id="node44" href="s2n__rsa_8c.html#a91a24681dfa755b5842d8f3157d4c7e9" title="s2n_rsa_public_key_free" alt="" coords="209,1029,379,1055"/>
<area shape="rect" id="node46" href="s2n__dhe_8c.html#aeb2667fcb851a9b7ce54fc822d358f19" title="s2n_dh_p_g_Ys_to_dh\l_params" alt="" coords="215,1124,373,1163"/>
<area shape="rect" id="node7" href="s2n__ecc_8c.html#abb776b3598360bc599df037aec01faa0" title="s2n_ecc_find_supported\l_curve" alt="" coords="455,104,622,143"/>
<area shape="rect" id="node18" href="crypto_2ec_2ec_8h.html#a182a5987df69a31238f78634f6d57e8d" title="EC_KEY_new_by_curve_name" alt="" coords="435,55,643,80"/>
<area shape="rect" id="node19" href="crypto_2ec_2ec_8h.html#ab3456a0d8ea13abb1e0c4c79fa0fef48" title="EC_KEY_set_public_key" alt="" coords="454,167,623,192"/>
<area shape="rect" id="node20" href="crypto_2ec_2ec_8h.html#a7defc41c1babb9e601de2d50c9fc81b5" title="EC_POINT_free" alt="" coords="479,216,598,241"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="1114,11,1266,36"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="904,237,1065,263"/>
<area shape="rect" id="node8" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="717,111,829,136"/>
<area shape="rect" id="node9" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="712,61,834,87"/>
<area shape="rect" id="node17" href="s2n__stuffer_8c.html#a5d6db4ed8311ba66aec1227fceca24a9" title="s2n_stuffer_reread" alt="" coords="707,160,840,185"/>
<area shape="rect" id="node10" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="904,61,1065,87"/>
<area shape="rect" id="node11" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="1113,61,1267,87"/>
<area shape="rect" id="node12" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1315,61,1445,87"/>
<area shape="rect" id="node13" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1493,36,1630,61"/>
<area shape="rect" id="node14" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1517,85,1606,111"/>
<area shape="rect" id="node15" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1678,85,1751,111"/>
<area shape="rect" id="node22" href="crypto_2md5_2md5_8h.html#ae06ac750835b8cb838b6be5986ddcad9" title="MD5_Init" alt="" coords="501,515,576,540"/>
<area shape="rect" id="node23" href="crypto_2sha_2sha_8h.html#ad954eeef9b6210b817502847aea169fa" title="SHA1_Init" alt="" coords="498,564,579,589"/>
<area shape="rect" id="node24" href="crypto_2sha_2sha_8h.html#ab3befdb5a3202fa6d2eda5f3a06eadfa" title="SHA224_Init" alt="" coords="490,613,587,639"/>
<area shape="rect" id="node25" href="crypto_2sha_2sha_8h.html#ac96292b35fd2d8387259000aa378ae0d" title="SHA256_Init" alt="" coords="490,367,587,392"/>
<area shape="rect" id="node26" href="crypto_2sha_2sha_8h.html#ab7ca087b2f4896acc5a9e55a018fb99c" title="SHA384_Init" alt="" coords="490,416,587,441"/>
<area shape="rect" id="node27" href="crypto_2sha_2sha_8h.html#a4a803e92438efee8717c1dd0679de99c" title="SHA512_Init" alt="" coords="490,465,587,491"/>
<area shape="rect" id="node29" href="crypto_2md5_2md5_8h.html#abedf8217cb8c106b729d7b78dd7f4f46" title="MD5_Update" alt="" coords="489,811,589,836"/>
<area shape="rect" id="node30" href="crypto_2sha_2sha_8h.html#aadef8538263b2cb59f73cfc4e9e26ea0" title="SHA1_Update" alt="" coords="485,860,592,885"/>
<area shape="rect" id="node31" href="crypto_2sha_2sha_8h.html#ada9a5985070b4397bc01b6ea6ddba702" title="SHA224_Update" alt="" coords="478,909,599,935"/>
<area shape="rect" id="node32" href="crypto_2sha_2sha_8h.html#a9d2c95d9cac6ceb095f3e7c48efec95a" title="SHA256_Update" alt="" coords="478,663,599,688"/>
<area shape="rect" id="node33" href="crypto_2sha_2sha_8h.html#aa790a16716c1e350def2dfb1c7411ea2" title="SHA384_Update" alt="" coords="478,712,599,737"/>
<area shape="rect" id="node34" href="crypto_2sha_2sha_8h.html#a0728f9400cea5d81dad5e5a290c6f263" title="SHA512_Update" alt="" coords="478,761,599,787"/>
<area shape="rect" id="node36" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="478,1008,600,1033"/>
<area shape="rect" id="node43" href="crypto_2rsa_2rsa_8h.html#add5f2bc9baaff5469270f286e16fe232" title="RSA_verify" alt="" coords="495,959,583,984"/>
<area shape="rect" id="node37" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="730,884,816,909"/>
<area shape="rect" id="node38" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="727,933,819,959"/>
<area shape="rect" id="node39" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="719,983,827,1008"/>
<area shape="rect" id="node40" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="719,1032,827,1057"/>
<area shape="rect" id="node41" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="719,1081,827,1107"/>
<area shape="rect" id="node42" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="719,1131,827,1156"/>
<area shape="rect" id="node45" href="crypto_2rsa_2rsa_8h.html#a024a38ff42a2e0b5456d733bc934e7dd" title="RSA_free" alt="" coords="499,1057,578,1083"/>
<area shape="rect" id="node47" href="crypto_2dh_2dh_8h.html#a76c6e12bd1f0b9977d80fee83b086031" title="DH_new" alt="" coords="502,1107,575,1132"/>
<area shape="rect" id="node48" href="crypto_2bn_2bn_8h.html#a9ca9a524bd4c4de12ae0947872c5182b" title="BN_bin2bn" alt="" coords="495,1156,582,1181"/>
<area shape="rect" id="node49" href="s2n__dhe_8c.html#abdd990a3dbfa9733ba67c06fa8c1a056" title="s2n_check_all_dh_params" alt="" coords="449,1205,629,1231"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a944852f699b2815f6a37b602113e26f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_done_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__done_8c_source.html#l00034">34</a> of file <a class="el" href="s2n__server__done_8c_source.html">s2n_server_done.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;{</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a55414ad2a6f07ebbae51cbd0bf6f5974"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_done_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__done_8c_source.html#l00025">25</a> of file <a class="el" href="s2n__server__done_8c_source.html">s2n_server_done.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>)) {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    }</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__stuffer_8h_html_a56d3da0e05e4c05eb87a343306c4f170"><div class="ttname"><a href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a></div><div class="ttdeci">#define s2n_stuffer_data_available(s)  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00045">s2n_stuffer.h:45</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00051">s2n_errno.h:51</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a59294a875b6596b8dd5ad02a58e77c94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_client_key_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__client__key__exchange_8c_source.html#l00224">224</a> of file <a class="el" href="s2n__client__key__exchange_8c_source.html">s2n_client_key_exchange.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;{</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a5446cce0337d14b74b38f2a81ea19670">cipher_suite</a>-&gt;<a class="code" href="structs2n__cipher__suite.html#aaf88ce0be23d983d21bbbecfce1c293d">key_exchange_alg</a>-&gt;<a class="code" href="structs2n__key__exchange__algorithm.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a> &amp; <a class="code" href="s2n__cipher__suites_8h.html#af4ba4603e445c3767469486093d99598">S2N_KEY_EXCHANGE_DH</a>) {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">return</span> s2n_dhe_client_key_send(conn);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">return</span> s2n_rsa_client_key_send(conn);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a5446cce0337d14b74b38f2a81ea19670"><div class="ttname"><a href="structs2n__crypto__parameters.html#a5446cce0337d14b74b38f2a81ea19670">s2n_crypto_parameters::cipher_suite</a></div><div class="ttdeci">struct s2n_cipher_suite * cipher_suite</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00052">s2n_crypto.h:52</a></div></div>
<div class="ttc" id="structs2n__key__exchange__algorithm_html_a1e87af3c18a2fd36c61faf89949bdc3f"><div class="ttname"><a href="structs2n__key__exchange__algorithm.html#a1e87af3c18a2fd36c61faf89949bdc3f">s2n_key_exchange_algorithm::flags</a></div><div class="ttdeci">uint16_t flags</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00039">s2n_cipher_suites.h:39</a></div></div>
<div class="ttc" id="structs2n__cipher__suite_html_aaf88ce0be23d983d21bbbecfce1c293d"><div class="ttname"><a href="structs2n__cipher__suite.html#aaf88ce0be23d983d21bbbecfce1c293d">s2n_cipher_suite::key_exchange_alg</a></div><div class="ttdeci">const struct s2n_key_exchange_algorithm * key_exchange_alg</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00048">s2n_cipher_suites.h:48</a></div></div>
<div class="ttc" id="s2n__cipher__suites_8h_html_af4ba4603e445c3767469486093d99598"><div class="ttname"><a href="s2n__cipher__suites_8h.html#af4ba4603e445c3767469486093d99598">S2N_KEY_EXCHANGE_DH</a></div><div class="ttdeci">#define S2N_KEY_EXCHANGE_DH</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00033">s2n_cipher_suites.h:33</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5d0b0b0a8964b40aff5e3562bf65a9e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_client_key_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__client__key__exchange_8c_source.html#l00127">127</a> of file <a class="el" href="s2n__client__key__exchange_8c_source.html">s2n_client_key_exchange.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a5446cce0337d14b74b38f2a81ea19670">cipher_suite</a>-&gt;<a class="code" href="structs2n__cipher__suite.html#aaf88ce0be23d983d21bbbecfce1c293d">key_exchange_alg</a>-&gt;<a class="code" href="structs2n__key__exchange__algorithm.html#a1e87af3c18a2fd36c61faf89949bdc3f">flags</a> &amp; <a class="code" href="s2n__cipher__suites_8h.html#af4ba4603e445c3767469486093d99598">S2N_KEY_EXCHANGE_DH</a>) {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">return</span> s2n_dhe_client_key_recv(conn);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="s2n__server__fuzz__test__overrides_8c.html#a4894ba367df6cc84ab8907adde93178c">s2n_rsa_client_key_recv</a>(conn);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a5446cce0337d14b74b38f2a81ea19670"><div class="ttname"><a href="structs2n__crypto__parameters.html#a5446cce0337d14b74b38f2a81ea19670">s2n_crypto_parameters::cipher_suite</a></div><div class="ttdeci">struct s2n_cipher_suite * cipher_suite</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00052">s2n_crypto.h:52</a></div></div>
<div class="ttc" id="structs2n__key__exchange__algorithm_html_a1e87af3c18a2fd36c61faf89949bdc3f"><div class="ttname"><a href="structs2n__key__exchange__algorithm.html#a1e87af3c18a2fd36c61faf89949bdc3f">s2n_key_exchange_algorithm::flags</a></div><div class="ttdeci">uint16_t flags</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00039">s2n_cipher_suites.h:39</a></div></div>
<div class="ttc" id="structs2n__cipher__suite_html_aaf88ce0be23d983d21bbbecfce1c293d"><div class="ttname"><a href="structs2n__cipher__suite.html#aaf88ce0be23d983d21bbbecfce1c293d">s2n_cipher_suite::key_exchange_alg</a></div><div class="ttdeci">const struct s2n_key_exchange_algorithm * key_exchange_alg</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00048">s2n_cipher_suites.h:48</a></div></div>
<div class="ttc" id="s2n__cipher__suites_8h_html_af4ba4603e445c3767469486093d99598"><div class="ttname"><a href="s2n__cipher__suites_8h.html#af4ba4603e445c3767469486093d99598">S2N_KEY_EXCHANGE_DH</a></div><div class="ttdeci">#define S2N_KEY_EXCHANGE_DH</div><div class="ttdef"><b>Definition:</b> <a href="s2n__cipher__suites_8h_source.html#l00033">s2n_cipher_suites.h:33</a></div></div>
<div class="ttc" id="s2n__server__fuzz__test__overrides_8c_html_a4894ba367df6cc84ab8907adde93178c"><div class="ttname"><a href="s2n__server__fuzz__test__overrides_8c.html#a4894ba367df6cc84ab8907adde93178c">s2n_rsa_client_key_recv</a></div><div class="ttdeci">int s2n_rsa_client_key_recv(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__server__fuzz__test__overrides_8c_source.html#l00050">s2n_server_fuzz_test_overrides.c:50</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a5d0b0b0a8964b40aff5e3562bf65a9e1_cgraph.png" border="0" usemap="#s2n__tls_8h_a5d0b0b0a8964b40aff5e3562bf65a9e1_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a5d0b0b0a8964b40aff5e3562bf65a9e1_cgraph" id="s2n__tls_8h_a5d0b0b0a8964b40aff5e3562bf65a9e1_cgraph">
<area shape="rect" id="node2" href="s2n__server__fuzz__test__overrides_8c.html#a4894ba367df6cc84ab8907adde93178c" title="s2n_rsa_client_key_recv" alt="" coords="213,143,381,168"/>
<area shape="rect" id="node3" href="s2n__ecc_8c.html#adf5f203c386c47c234efb85287401f7f" title="s2n_ecc_compute_shared\l_secret_as_client" alt="" coords="208,617,385,656"/>
<area shape="rect" id="node7" href="s2n__dhe_8c.html#a5883f9a420e0b7c297b061ea0ed108e8" title="s2n_dh_compute_shared\l_secret_as_client" alt="" coords="211,295,382,333"/>
<area shape="rect" id="node18" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f" title="s2n_stuffer_write_uint16" alt="" coords="474,5,641,31"/>
<area shape="rect" id="node23" href="s2n__stuffer_8c.html#afdc941db81df32f38b7800210f3f2d11" title="s2n_stuffer_raw_write" alt="" coords="482,55,633,80"/>
<area shape="rect" id="node24" href="s2n__memory__leak__negative__test__overrides_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="521,499,594,524"/>
<area shape="rect" id="node25" href="s2n__dhe_8c.html#ad31b1e9b035a2f883bd9e8338e2e61de" title="s2n_dh_params_free" alt="" coords="484,400,631,425"/>
<area shape="rect" id="node29" href="s2n__prf_8c.html#a290fe2c5aef3de88d8e727c089513b06" title="s2n_prf_master_secret" alt="" coords="218,1371,375,1396"/>
<area shape="rect" id="node53" href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877" title="s2n_blob_zero" alt="" coords="242,1420,351,1445"/>
<area shape="rect" id="node54" href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f" title="s2n_prf_key_expansion" alt="" coords="215,1295,378,1320"/>
<area shape="rect" id="node65" href="s2n__resume_8c.html#af0cd9536cbece4a1bcebb3d69f8d4fd1" title="s2n_is_caching_enabled" alt="" coords="473,1195,642,1220"/>
<area shape="rect" id="node70" href="s2n__resume_8c.html#ad19683b9eb6d7635dc7d808d52744deb" title="s2n_store_to_cache" alt="" coords="226,1220,367,1245"/>
<area shape="rect" id="node71" href="s2n__ecc_8c.html#a637d230cb6cd42160518cd5778d9994d" title="s2n_ecc_params_free" alt="" coords="220,797,373,823"/>
<area shape="rect" id="node80" href="s2n__random_8c.html#aaad2cf7ed73ddf58358fb714b1abfb39" title="s2n_get_private_random_data" alt="" coords="195,1520,398,1545"/>
<area shape="rect" id="node82" href="s2n__rsa_8c.html#a1d525d434e1ba38bc8100155fe2d54f8" title="s2n_rsa_public_encrypted_size" alt="" coords="453,1747,662,1772"/>
<area shape="rect" id="node84" href="s2n__rsa_8c.html#a4898a688987344069449328892165a59" title="s2n_rsa_encrypt" alt="" coords="237,1747,357,1772"/>
<area shape="rect" id="node86" href="s2n__rsa_8c.html#a91a24681dfa755b5842d8f3157d4c7e9" title="s2n_rsa_public_key_free" alt="" coords="212,1820,381,1845"/>
<area shape="rect" id="node4" href="crypto_2ec_2ec_8h.html#a4801169f999e2527d5368ec2a8cfc20a" title="EC_KEY_get0_public_key" alt="" coords="469,548,646,573"/>
<area shape="rect" id="node5" href="crypto_2ec_2ec_8h.html#af3759e18dd8bf0c3144527c0377668a7" title="EC_KEY_free" alt="" coords="505,597,610,623"/>
<area shape="rect" id="node6" href="crypto_2ec_2ec_8h.html#aa11ad233e9c9a49d34d33e2feef70c33" title="EC_KEY_get0_group" alt="" coords="483,647,632,672"/>
<area shape="rect" id="node8" href="s2n__dhe_8c.html#ab505c6e7917e92a2b3c2cb33246b919b" title="s2n_dh_params_check" alt="" coords="478,203,637,228"/>
<area shape="rect" id="node10" href="s2n__dhe_8c.html#a3de1805a7078d382e8f9c8fd776b75b0" title="s2n_dh_params_copy" alt="" coords="481,301,634,327"/>
<area shape="rect" id="node12" href="s2n__dhe_8c.html#a52481b6c08da550c51db7be50445c54a" title="s2n_dh_generate_ephemeral_key" alt="" coords="446,351,669,376"/>
<area shape="rect" id="node14" href="s2n__mem_8c.html#a6fb5d30c5bbbc73694b21821ff2da82f" title="s2n_alloc" alt="" coords="519,449,596,475"/>
<area shape="rect" id="node17" href="crypto_2dh_2dh_8h.html#a9e1fdd62e3bfe4b671dbfc363f0e6297" title="DH_size" alt="" coords="522,252,593,277"/>
<area shape="rect" id="node27" href="crypto_2bn_2bn_8h.html#a72e393df20fc0ec8e761204fe5f28c17" title="BN_bn2bin" alt="" coords="514,104,601,129"/>
<area shape="rect" id="node28" href="crypto_2dh_2dh_8h.html#ac47f31f61d60571c0987c97a268e4865" title="DH_compute_key" alt="" coords="494,153,621,179"/>
<area shape="rect" id="node9" href="crypto_2dh_2dh_8h.html#ae37f7b9808959007f12b420a836a650e" title="DH_check" alt="" coords="759,203,842,228"/>
<area shape="rect" id="node11" href="crypto_2dh_2dh_8h.html#ab71b4cb56c0ad4c6bbf3606aab6dd175" title="DHparams_dup" alt="" coords="743,301,858,327"/>
<area shape="rect" id="node13" href="crypto_2dh_2dh_8h.html#ab90ec6b9e64f62c05754731c0c13ea01" title="DH_generate_key" alt="" coords="736,351,865,376"/>
<area shape="rect" id="node15" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1545,449,1635,475"/>
<area shape="rect" id="node16" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1706,449,1779,475"/>
<area shape="rect" id="node19" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="932,920,1094,945"/>
<area shape="rect" id="node20" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="1142,400,1295,425"/>
<area shape="rect" id="node21" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1343,400,1473,425"/>
<area shape="rect" id="node22" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1521,400,1658,425"/>
<area shape="rect" id="node26" href="crypto_2dh_2dh_8h.html#a1f15312ca21e290ee714e86578820c35" title="DH_free" alt="" coords="765,400,836,425"/>
<area shape="rect" id="node30" href="s2n__hash_8c.html#a0f3c4efbf552f607071e552dc0548ee6" title="s2n_hash_update" alt="" coords="737,1761,864,1787"/>
<area shape="rect" id="node37" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="739,1343,862,1368"/>
<area shape="rect" id="node44" href="s2n__hash_8c.html#a3ad42d683b1126e7d8eb329b68382bc8" title="s2n_hash_reset" alt="" coords="499,1547,616,1572"/>
<area shape="rect" id="node52" href="s2n__hash_8c.html#a8b39db9e0a5456a10a5d790474f09818" title="s2n_hash_copy" alt="" coords="500,1648,615,1673"/>
<area shape="rect" id="node31" href="crypto_2md5_2md5_8h.html#abedf8217cb8c106b729d7b78dd7f4f46" title="MD5_Update" alt="" coords="963,1984,1063,2009"/>
<area shape="rect" id="node32" href="crypto_2sha_2sha_8h.html#aadef8538263b2cb59f73cfc4e9e26ea0" title="SHA1_Update" alt="" coords="959,1737,1066,1763"/>
<area shape="rect" id="node33" href="crypto_2sha_2sha_8h.html#ada9a5985070b4397bc01b6ea6ddba702" title="SHA224_Update" alt="" coords="952,1787,1073,1812"/>
<area shape="rect" id="node34" href="crypto_2sha_2sha_8h.html#a9d2c95d9cac6ceb095f3e7c48efec95a" title="SHA256_Update" alt="" coords="952,1836,1073,1861"/>
<area shape="rect" id="node35" href="crypto_2sha_2sha_8h.html#aa790a16716c1e350def2dfb1c7411ea2" title="SHA384_Update" alt="" coords="952,1885,1073,1911"/>
<area shape="rect" id="node36" href="crypto_2sha_2sha_8h.html#a0728f9400cea5d81dad5e5a290c6f263" title="SHA512_Update" alt="" coords="952,1935,1073,1960"/>
<area shape="rect" id="node38" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="970,1392,1056,1417"/>
<area shape="rect" id="node39" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="966,1145,1059,1171"/>
<area shape="rect" id="node40" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="959,1195,1066,1220"/>
<area shape="rect" id="node41" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="959,1244,1066,1269"/>
<area shape="rect" id="node42" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="959,1293,1066,1319"/>
<area shape="rect" id="node43" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="959,1343,1066,1368"/>
<area shape="rect" id="node45" href="s2n__hash_8c.html#a684a3779eebad8329d41443454dd6fa2" title="s2n_hash_init" alt="" coords="749,1540,852,1565"/>
<area shape="rect" id="node46" href="crypto_2md5_2md5_8h.html#ae06ac750835b8cb838b6be5986ddcad9" title="MD5_Init" alt="" coords="975,1688,1050,1713"/>
<area shape="rect" id="node47" href="crypto_2sha_2sha_8h.html#ad954eeef9b6210b817502847aea169fa" title="SHA1_Init" alt="" coords="972,1441,1053,1467"/>
<area shape="rect" id="node48" href="crypto_2sha_2sha_8h.html#ab3befdb5a3202fa6d2eda5f3a06eadfa" title="SHA224_Init" alt="" coords="965,1491,1061,1516"/>
<area shape="rect" id="node49" href="crypto_2sha_2sha_8h.html#ac96292b35fd2d8387259000aa378ae0d" title="SHA256_Init" alt="" coords="965,1540,1061,1565"/>
<area shape="rect" id="node50" href="crypto_2sha_2sha_8h.html#ab7ca087b2f4896acc5a9e55a018fb99c" title="SHA384_Init" alt="" coords="965,1589,1061,1615"/>
<area shape="rect" id="node51" href="crypto_2sha_2sha_8h.html#a4a803e92438efee8717c1dd0679de99c" title="SHA512_Init" alt="" coords="965,1639,1061,1664"/>
<area shape="rect" id="node55" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="502,1244,613,1269"/>
<area shape="rect" id="node56" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="739,896,862,921"/>
<area shape="rect" id="node57" href="s2n__hmac_8c.html#ad9e0cc00ac39458cba7a9b1792429dbd" title="s2n_hmac_digest_size" alt="" coords="479,1396,636,1421"/>
<area shape="rect" id="node60" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="726,1811,876,1836"/>
<area shape="rect" id="node62" href="s2n__hmac_8c.html#ad5056a3fc151619a2935471a5861fc3d" title="s2n_hmac_init" alt="" coords="504,1445,611,1471"/>
<area shape="rect" id="node63" href="s2n__stuffer_8c.html#a49bb9749c055c6fb6f713cebeaa14cb5" title="s2n_stuffer_read" alt="" coords="740,1269,861,1295"/>
<area shape="rect" id="node58" href="s2n__hash_8c.html#aced4a438c67e79b78d41edfbb8b3e07a" title="s2n_hash_digest_size" alt="" coords="724,1396,877,1421"/>
<area shape="rect" id="node59" href="s2n__hmac_8c.html#ac4f30ec554d9a717c6269a5de8ae4acf" title="s2n_hmac_reset" alt="" coords="741,1445,861,1471"/>
<area shape="rect" id="node61" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="1142,1565,1295,1591"/>
<area shape="rect" id="node64" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="932,1096,1093,1121"/>
<area shape="rect" id="node66" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="721,945,880,971"/>
<area shape="rect" id="node67" href="s2n__stuffer_8c.html#af5be81568462bd6626c1d00a939ff30d" title="s2n_stuffer_write_uint64" alt="" coords="717,1047,884,1072"/>
<area shape="rect" id="node68" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="722,1096,879,1121"/>
<area shape="rect" id="node69" href="s2n__stuffer_8c.html#ae1122959189bd03c92af5fd134016977" title="s2n_stuffer_read_uint64" alt="" coords="718,1145,883,1171"/>
<area shape="rect" id="node72" href="crypto_2ec_2ec_8h.html#a182a5987df69a31238f78634f6d57e8d" title="EC_KEY_new_by_curve_name" alt="" coords="453,1093,662,1119"/>
<area shape="rect" id="node73" href="crypto_2ec_2ec_8h.html#a690c3227c776f6b53a004e22d03055da" title="EC_KEY_generate_key" alt="" coords="476,748,639,773"/>
<area shape="rect" id="node74" href="crypto_2ec_2ec_8h.html#a81baecc872e63a5fd0b35853b3c744ef" title="EC_POINT_new" alt="" coords="498,847,617,872"/>
<area shape="rect" id="node75" href="crypto_2ec_2ec_8h.html#a3e3f20867863cf24f2009e2e81f3a47c" title="EC_POINT_oct2point" alt="" coords="483,896,632,921"/>
<area shape="rect" id="node76" href="crypto_2ec_2ec_8h.html#a7defc41c1babb9e601de2d50c9fc81b5" title="EC_POINT_free" alt="" coords="498,945,617,971"/>
<area shape="rect" id="node77" href="crypto_2ec_2ec_8h.html#aa71bd1bfa2f9321ed09eb05a8ff4a88d" title="EC_POINT_point2oct" alt="" coords="483,995,632,1020"/>
<area shape="rect" id="node78" href="crypto_2ec_2ec_8h.html#adbecc2842cfc5c491c037b3b9a6bbbf1" title="EC_GROUP_get_degree" alt="" coords="472,1044,643,1069"/>
<area shape="rect" id="node79" href="crypto_2ecdh_2ecdh_8h.html#a3a06b8ba2eaae0f82192d2fbe5327406" title="ECDH_compute_key" alt="" coords="485,797,630,823"/>
<area shape="rect" id="node81" href="s2n__drbg_8c.html#a9fad975e364d5a398330eb937745f0e6" title="s2n_drbg_generate" alt="" coords="489,1697,626,1723"/>
<area shape="rect" id="node83" href="crypto_2rsa_2rsa_8h.html#af8cdf91fccaa56fa80cae55eece27d9d" title="RSA_size" alt="" coords="761,1860,841,1885"/>
<area shape="rect" id="node85" href="crypto_2rsa_2rsa_8h.html#a227edb1157b70bbd92ba213ae0f00171" title="RSA_public_encrypt" alt="" coords="486,1796,629,1821"/>
<area shape="rect" id="node87" href="crypto_2rsa_2rsa_8h.html#a024a38ff42a2e0b5456d733bc934e7dd" title="RSA_free" alt="" coords="518,1845,597,1871"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9be1791dfd4b0af9525be21fb52ec4eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_client_ccs_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__client__ccs_8c_source.html#l00054">54</a> of file <a class="el" href="s2n__client__ccs_8c_source.html">s2n_client_ccs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, <a class="code" href="s2n__client__ccs_8c.html#ae679d5e1291a1f62c6e66ae2f2404703">CHANGE_CIPHER_SPEC_TYPE</a>));</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aaca63d5bb519a92734bd0287199a7f5a"><div class="ttname"><a href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a></div><div class="ttdeci">int s2n_stuffer_write_uint8(struct s2n_stuffer *stuffer, const uint8_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00249">s2n_stuffer.c:249</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__client__ccs_8c_html_ae679d5e1291a1f62c6e66ae2f2404703"><div class="ttname"><a href="s2n__client__ccs_8c.html#ae679d5e1291a1f62c6e66ae2f2404703">CHANGE_CIPHER_SPEC_TYPE</a></div><div class="ttdeci">#define CHANGE_CIPHER_SPEC_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="s2n__client__ccs_8c_source.html#l00029">s2n_client_ccs.c:29</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a9be1791dfd4b0af9525be21fb52ec4eb_cgraph.png" border="0" usemap="#s2n__tls_8h_a9be1791dfd4b0af9525be21fb52ec4eb_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a9be1791dfd4b0af9525be21fb52ec4eb_cgraph" id="s2n__tls_8h_a9be1791dfd4b0af9525be21fb52ec4eb_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="198,31,357,56"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="405,31,567,56"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="615,31,769,56"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="817,31,947,56"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="995,5,1132,31"/>
<area shape="rect" id="node7" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1019,55,1108,80"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1180,55,1253,80"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aab9d53a394720e55e7648730f94bb176"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_client_ccs_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__client__ccs_8c_source.html#l00031">31</a> of file <a class="el" href="s2n__client__ccs_8c_source.html">s2n_client_ccs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    uint8_t <a class="code" href="crypto_2x509_2x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__prf_8c.html#a809931120983e64ed6602dbac2b9b1fc">s2n_prf_client_finished</a>(conn));</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> seq = {.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#ab7767b5b58441b15ac1028ac18b06ef1">client_sequence_number</a>,.size = <span class="keyword">sizeof</span>(conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#ab7767b5b58441b15ac1028ac18b06ef1">client_sequence_number</a>) };</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877">s2n_blob_zero</a>(&amp;seq));</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">/* Update the client to use the cipher-suite */</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#a052f81d7dc7e2612341fe0da1e749ebd">client</a> = &amp;conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, &amp;type));</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">if</span> (type != <a class="code" href="s2n__client__ccs_8c.html#ae679d5e1291a1f62c6e66ae2f2404703">CHANGE_CIPHER_SPEC_TYPE</a>) {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">/* Flush any partial alert messages that were pending */</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a2b6b54f7856d92f06f823bc26d10f4ba">s2n_stuffer_wipe</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a628dd7fe79c7cfd5f7bc02da8a270752">alert_in</a>));</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_a628dd7fe79c7cfd5f7bc02da8a270752"><div class="ttname"><a href="structs2n__connection.html#a628dd7fe79c7cfd5f7bc02da8a270752">s2n_connection::alert_in</a></div><div class="ttdeci">struct s2n_stuffer alert_in</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00102">s2n_connection.h:102</a></div></div>
<div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__blob_8c_html_a241c17ca2593704ff88734d13659a877"><div class="ttname"><a href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877">s2n_blob_zero</a></div><div class="ttdeci">int s2n_blob_zero(struct s2n_blob *b)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8c_source.html#l00032">s2n_blob.c:32</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00051">s2n_errno.h:51</a></div></div>
<div class="ttc" id="s2n__client__ccs_8c_html_ae679d5e1291a1f62c6e66ae2f2404703"><div class="ttname"><a href="s2n__client__ccs_8c.html#ae679d5e1291a1f62c6e66ae2f2404703">CHANGE_CIPHER_SPEC_TYPE</a></div><div class="ttdeci">#define CHANGE_CIPHER_SPEC_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="s2n__client__ccs_8c_source.html#l00029">s2n_client_ccs.c:29</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="crypto_2x509_2x509_8h_html_ab512b8f495325c7ea0f5a5a5d3f938eb"><div class="ttname"><a href="crypto_2x509_2x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a></div><div class="ttdeci">const ASN1_OBJECT int type</div><div class="ttdef"><b>Definition:</b> <a href="crypto_2x509_2x509_8h_source.html#l01121">x509.h:1121</a></div></div>
<div class="ttc" id="structs2n__connection_html_a052f81d7dc7e2612341fe0da1e749ebd"><div class="ttname"><a href="structs2n__connection.html#a052f81d7dc7e2612341fe0da1e749ebd">s2n_connection::client</a></div><div class="ttdeci">struct s2n_crypto_parameters * client</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00080">s2n_connection.h:80</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a1178687b6091eb483d135c149e87fb0b"><div class="ttname"><a href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a></div><div class="ttdeci">int s2n_stuffer_read_uint8(struct s2n_stuffer *stuffer, uint8_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00242">s2n_stuffer.c:242</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a2b6b54f7856d92f06f823bc26d10f4ba"><div class="ttname"><a href="s2n__stuffer_8c.html#a2b6b54f7856d92f06f823bc26d10f4ba">s2n_stuffer_wipe</a></div><div class="ttdeci">int s2n_stuffer_wipe(struct s2n_stuffer *stuffer)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00133">s2n_stuffer.c:133</a></div></div>
<div class="ttc" id="s2n__prf_8c_html_a809931120983e64ed6602dbac2b9b1fc"><div class="ttname"><a href="s2n__prf_8c.html#a809931120983e64ed6602dbac2b9b1fc">s2n_prf_client_finished</a></div><div class="ttdeci">int s2n_prf_client_finished(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__prf_8c_source.html#l00237">s2n_prf.c:237</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_ab7767b5b58441b15ac1028ac18b06ef1"><div class="ttname"><a href="structs2n__crypto__parameters.html#ab7767b5b58441b15ac1028ac18b06ef1">s2n_crypto_parameters::client_sequence_number</a></div><div class="ttdeci">uint8_t client_sequence_number[S2N_TLS_SEQUENCE_NUM_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00065">s2n_crypto.h:65</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_aab9d53a394720e55e7648730f94bb176_cgraph.png" border="0" usemap="#s2n__tls_8h_aab9d53a394720e55e7648730f94bb176_cgraph" alt=""/></div>
<map name="s2n__tls_8h_aab9d53a394720e55e7648730f94bb176_cgraph" id="s2n__tls_8h_aab9d53a394720e55e7648730f94bb176_cgraph">
<area shape="rect" id="node2" href="s2n__prf_8c.html#a809931120983e64ed6602dbac2b9b1fc" title="s2n_prf_client_finished" alt="" coords="195,153,352,179"/>
<area shape="rect" id="node11" href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877" title="s2n_blob_zero" alt="" coords="219,228,328,253"/>
<area shape="rect" id="node12" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="195,277,352,303"/>
<area shape="rect" id="node15" href="s2n__stuffer_8c.html#a2b6b54f7856d92f06f823bc26d10f4ba" title="s2n_stuffer_wipe" alt="" coords="213,327,335,352"/>
<area shape="rect" id="node3" href="s2n__hash_8c.html#a8b39db9e0a5456a10a5d790474f09818" title="s2n_hash_copy" alt="" coords="423,104,538,129"/>
<area shape="rect" id="node4" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="420,153,542,179"/>
<area shape="rect" id="node5" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="642,5,728,31"/>
<area shape="rect" id="node6" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="639,55,731,80"/>
<area shape="rect" id="node7" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="631,104,739,129"/>
<area shape="rect" id="node8" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="631,153,739,179"/>
<area shape="rect" id="node9" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="631,203,739,228"/>
<area shape="rect" id="node10" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="631,252,739,277"/>
<area shape="rect" id="node13" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="400,277,561,303"/>
<area shape="rect" id="node14" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="609,301,761,327"/>
<area shape="rect" id="node16" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="412,327,549,352"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad4c716e8d39e6bb93acba86ccda02554"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_ccs_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__ccs_8c_source.html#l00059">59</a> of file <a class="el" href="s2n__server__ccs_8c_source.html">s2n_server_ccs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, <a class="code" href="s2n__server__ccs_8c.html#ae679d5e1291a1f62c6e66ae2f2404703">CHANGE_CIPHER_SPEC_TYPE</a>));</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#a8b8974068a8f2c38a061ffb495a5ca1c">handshake_type</a> == RESUME) {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f">s2n_prf_key_expansion</a>(conn));</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div><div class="ttc" id="s2n__server__ccs_8c_html_ae679d5e1291a1f62c6e66ae2f2404703"><div class="ttname"><a href="s2n__server__ccs_8c.html#ae679d5e1291a1f62c6e66ae2f2404703">CHANGE_CIPHER_SPEC_TYPE</a></div><div class="ttdeci">#define CHANGE_CIPHER_SPEC_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="s2n__server__ccs_8c_source.html#l00028">s2n_server_ccs.c:28</a></div></div>
<div class="ttc" id="s2n__prf_8c_html_a1425bb608ed69a0cc582af0a57955e1f"><div class="ttname"><a href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f">s2n_prf_key_expansion</a></div><div class="ttdeci">int s2n_prf_key_expansion(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__prf_8c_source.html#l00349">s2n_prf.c:349</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aaca63d5bb519a92734bd0287199a7f5a"><div class="ttname"><a href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a></div><div class="ttdeci">int s2n_stuffer_write_uint8(struct s2n_stuffer *stuffer, const uint8_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00249">s2n_stuffer.c:249</a></div></div>
<div class="ttc" id="structs2n__handshake_html_a8b8974068a8f2c38a061ffb495a5ca1c"><div class="ttname"><a href="structs2n__handshake.html#a8b8974068a8f2c38a061ffb495a5ca1c">s2n_handshake::handshake_type</a></div><div class="ttdeci">enum s2n_handshake::@78 handshake_type</div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_ad4c716e8d39e6bb93acba86ccda02554_cgraph.png" border="0" usemap="#s2n__tls_8h_ad4c716e8d39e6bb93acba86ccda02554_cgraph" alt=""/></div>
<map name="s2n__tls_8h_ad4c716e8d39e6bb93acba86ccda02554_cgraph" id="s2n__tls_8h_ad4c716e8d39e6bb93acba86ccda02554_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="206,259,365,284"/>
<area shape="rect" id="node9" href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f" title="s2n_prf_key_expansion" alt="" coords="204,376,367,401"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="620,179,781,204"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="829,31,983,56"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1031,31,1161,56"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1209,5,1346,31"/>
<area shape="rect" id="node7" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1233,55,1322,80"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1394,55,1467,80"/>
<area shape="rect" id="node10" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="437,475,549,500"/>
<area shape="rect" id="node11" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="432,253,554,279"/>
<area shape="rect" id="node12" href="s2n__hmac_8c.html#ad9e0cc00ac39458cba7a9b1792429dbd" title="s2n_hmac_digest_size" alt="" coords="415,327,572,352"/>
<area shape="rect" id="node36" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="418,425,568,451"/>
<area shape="rect" id="node38" href="s2n__hmac_8c.html#ad5056a3fc151619a2935471a5861fc3d" title="s2n_hmac_init" alt="" coords="439,376,547,401"/>
<area shape="rect" id="node39" href="s2n__stuffer_8c.html#a49bb9749c055c6fb6f713cebeaa14cb5" title="s2n_stuffer_read" alt="" coords="432,673,554,699"/>
<area shape="rect" id="node13" href="s2n__hash_8c.html#aced4a438c67e79b78d41edfbb8b3e07a" title="s2n_hash_digest_size" alt="" coords="624,228,777,253"/>
<area shape="rect" id="node14" href="s2n__hash_8c.html#a684a3779eebad8329d41443454dd6fa2" title="s2n_hash_init" alt="" coords="649,451,752,476"/>
<area shape="rect" id="node21" href="s2n__hash_8c.html#a0f3c4efbf552f607071e552dc0548ee6" title="s2n_hash_update" alt="" coords="637,740,764,765"/>
<area shape="rect" id="node28" href="s2n__hmac_8c.html#ac4f30ec554d9a717c6269a5de8ae4acf" title="s2n_hmac_reset" alt="" coords="641,277,760,303"/>
<area shape="rect" id="node29" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="639,327,762,352"/>
<area shape="rect" id="node15" href="crypto_2md5_2md5_8h.html#ae06ac750835b8cb838b6be5986ddcad9" title="MD5_Init" alt="" coords="869,623,944,648"/>
<area shape="rect" id="node16" href="crypto_2sha_2sha_8h.html#ad954eeef9b6210b817502847aea169fa" title="SHA1_Init" alt="" coords="866,376,947,401"/>
<area shape="rect" id="node17" href="crypto_2sha_2sha_8h.html#ab3befdb5a3202fa6d2eda5f3a06eadfa" title="SHA224_Init" alt="" coords="858,425,954,451"/>
<area shape="rect" id="node18" href="crypto_2sha_2sha_8h.html#ac96292b35fd2d8387259000aa378ae0d" title="SHA256_Init" alt="" coords="858,475,954,500"/>
<area shape="rect" id="node19" href="crypto_2sha_2sha_8h.html#ab7ca087b2f4896acc5a9e55a018fb99c" title="SHA384_Init" alt="" coords="858,524,954,549"/>
<area shape="rect" id="node20" href="crypto_2sha_2sha_8h.html#a4a803e92438efee8717c1dd0679de99c" title="SHA512_Init" alt="" coords="858,573,954,599"/>
<area shape="rect" id="node22" href="crypto_2md5_2md5_8h.html#abedf8217cb8c106b729d7b78dd7f4f46" title="MD5_Update" alt="" coords="856,672,956,697"/>
<area shape="rect" id="node23" href="crypto_2sha_2sha_8h.html#aadef8538263b2cb59f73cfc4e9e26ea0" title="SHA1_Update" alt="" coords="853,721,960,747"/>
<area shape="rect" id="node24" href="crypto_2sha_2sha_8h.html#ada9a5985070b4397bc01b6ea6ddba702" title="SHA224_Update" alt="" coords="846,771,967,796"/>
<area shape="rect" id="node25" href="crypto_2sha_2sha_8h.html#a9d2c95d9cac6ceb095f3e7c48efec95a" title="SHA256_Update" alt="" coords="846,820,967,845"/>
<area shape="rect" id="node26" href="crypto_2sha_2sha_8h.html#aa790a16716c1e350def2dfb1c7411ea2" title="SHA384_Update" alt="" coords="846,869,967,895"/>
<area shape="rect" id="node27" href="crypto_2sha_2sha_8h.html#a0728f9400cea5d81dad5e5a290c6f263" title="SHA512_Update" alt="" coords="846,919,967,944"/>
<area shape="rect" id="node30" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="863,327,949,352"/>
<area shape="rect" id="node31" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="860,80,953,105"/>
<area shape="rect" id="node32" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="853,129,960,155"/>
<area shape="rect" id="node33" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="853,179,960,204"/>
<area shape="rect" id="node34" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="853,228,960,253"/>
<area shape="rect" id="node35" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="853,277,960,303"/>
<area shape="rect" id="node37" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="830,968,982,993"/>
<area shape="rect" id="node40" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="620,949,781,975"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae06266c2514a2576c570f3f01d9f9ecf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_ccs_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__ccs_8c_source.html#l00030">30</a> of file <a class="el" href="s2n__server__ccs_8c_source.html">s2n_server_ccs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    uint8_t <a class="code" href="crypto_2x509_2x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, &amp;type));</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (type != <a class="code" href="s2n__server__ccs_8c.html#ae679d5e1291a1f62c6e66ae2f2404703">CHANGE_CIPHER_SPEC_TYPE</a>) {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">/* Zero the sequence number */</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> seq = {.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a286710aff413808336b2f294554c7e55">server_sequence_number</a>,.size = <a class="code" href="tls_2s2n__crypto_8h.html#ab6af529d3a237c0d8d2f67edcf831c25">S2N_TLS_SEQUENCE_NUM_LEN</a> };</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877">s2n_blob_zero</a>(&amp;seq));</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">/* Compute the finished message */</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__prf_8c.html#a4d977ca107f8b2ac76823eb6281ca69b">s2n_prf_server_finished</a>(conn));</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">/* Update the secure state to active, and point the client at the active state */</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#abfab1f3796089e3576e73286c0b6889c">server</a> = &amp;conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">/* Flush any partial alert messages that were pending */</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a2b6b54f7856d92f06f823bc26d10f4ba">s2n_stuffer_wipe</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a628dd7fe79c7cfd5f7bc02da8a270752">alert_in</a>));</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#a8b8974068a8f2c38a061ffb495a5ca1c">handshake_type</a> == RESUME) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f">s2n_prf_key_expansion</a>(conn));</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div><div class="ttc" id="s2n__server__ccs_8c_html_ae679d5e1291a1f62c6e66ae2f2404703"><div class="ttname"><a href="s2n__server__ccs_8c.html#ae679d5e1291a1f62c6e66ae2f2404703">CHANGE_CIPHER_SPEC_TYPE</a></div><div class="ttdeci">#define CHANGE_CIPHER_SPEC_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="s2n__server__ccs_8c_source.html#l00028">s2n_server_ccs.c:28</a></div></div>
<div class="ttc" id="s2n__prf_8c_html_a1425bb608ed69a0cc582af0a57955e1f"><div class="ttname"><a href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f">s2n_prf_key_expansion</a></div><div class="ttdeci">int s2n_prf_key_expansion(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__prf_8c_source.html#l00349">s2n_prf.c:349</a></div></div>
<div class="ttc" id="structs2n__connection_html_a628dd7fe79c7cfd5f7bc02da8a270752"><div class="ttname"><a href="structs2n__connection.html#a628dd7fe79c7cfd5f7bc02da8a270752">s2n_connection::alert_in</a></div><div class="ttdeci">struct s2n_stuffer alert_in</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00102">s2n_connection.h:102</a></div></div>
<div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="structs2n__connection_html_abfab1f3796089e3576e73286c0b6889c"><div class="ttname"><a href="structs2n__connection.html#abfab1f3796089e3576e73286c0b6889c">s2n_connection::server</a></div><div class="ttdeci">struct s2n_crypto_parameters * server</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00081">s2n_connection.h:81</a></div></div>
<div class="ttc" id="s2n__prf_8c_html_a4d977ca107f8b2ac76823eb6281ca69b"><div class="ttname"><a href="s2n__prf_8c.html#a4d977ca107f8b2ac76823eb6281ca69b">s2n_prf_server_finished</a></div><div class="ttdeci">int s2n_prf_server_finished(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__prf_8c_source.html#l00293">s2n_prf.c:293</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__blob_8c_html_a241c17ca2593704ff88734d13659a877"><div class="ttname"><a href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877">s2n_blob_zero</a></div><div class="ttdeci">int s2n_blob_zero(struct s2n_blob *b)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8c_source.html#l00032">s2n_blob.c:32</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="structs2n__handshake_html_a8b8974068a8f2c38a061ffb495a5ca1c"><div class="ttname"><a href="structs2n__handshake.html#a8b8974068a8f2c38a061ffb495a5ca1c">s2n_handshake::handshake_type</a></div><div class="ttdeci">enum s2n_handshake::@78 handshake_type</div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00051">s2n_errno.h:51</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="crypto_2x509_2x509_8h_html_ab512b8f495325c7ea0f5a5a5d3f938eb"><div class="ttname"><a href="crypto_2x509_2x509_8h.html#ab512b8f495325c7ea0f5a5a5d3f938eb">type</a></div><div class="ttdeci">const ASN1_OBJECT int type</div><div class="ttdef"><b>Definition:</b> <a href="crypto_2x509_2x509_8h_source.html#l01121">x509.h:1121</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_ab6af529d3a237c0d8d2f67edcf831c25"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#ab6af529d3a237c0d8d2f67edcf831c25">S2N_TLS_SEQUENCE_NUM_LEN</a></div><div class="ttdeci">#define S2N_TLS_SEQUENCE_NUM_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00029">s2n_crypto.h:29</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a1178687b6091eb483d135c149e87fb0b"><div class="ttname"><a href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a></div><div class="ttdeci">int s2n_stuffer_read_uint8(struct s2n_stuffer *stuffer, uint8_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00242">s2n_stuffer.c:242</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a2b6b54f7856d92f06f823bc26d10f4ba"><div class="ttname"><a href="s2n__stuffer_8c.html#a2b6b54f7856d92f06f823bc26d10f4ba">s2n_stuffer_wipe</a></div><div class="ttdeci">int s2n_stuffer_wipe(struct s2n_stuffer *stuffer)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00133">s2n_stuffer.c:133</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a286710aff413808336b2f294554c7e55"><div class="ttname"><a href="structs2n__crypto__parameters.html#a286710aff413808336b2f294554c7e55">s2n_crypto_parameters::server_sequence_number</a></div><div class="ttdeci">uint8_t server_sequence_number[S2N_TLS_SEQUENCE_NUM_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00066">s2n_crypto.h:66</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_ae06266c2514a2576c570f3f01d9f9ecf_cgraph.png" border="0" usemap="#s2n__tls_8h_ae06266c2514a2576c570f3f01d9f9ecf_cgraph" alt=""/></div>
<map name="s2n__tls_8h_ae06266c2514a2576c570f3f01d9f9ecf_cgraph" id="s2n__tls_8h_ae06266c2514a2576c570f3f01d9f9ecf_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="204,23,361,48"/>
<area shape="rect" id="node5" href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877" title="s2n_blob_zero" alt="" coords="228,298,337,323"/>
<area shape="rect" id="node6" href="s2n__prf_8c.html#a4d977ca107f8b2ac76823eb6281ca69b" title="s2n_prf_server_finished" alt="" coords="201,248,364,274"/>
<area shape="rect" id="node15" href="s2n__stuffer_8c.html#a2b6b54f7856d92f06f823bc26d10f4ba" title="s2n_stuffer_wipe" alt="" coords="1033,174,1155,199"/>
<area shape="rect" id="node17" href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f" title="s2n_prf_key_expansion" alt="" coords="201,122,364,147"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="618,22,778,47"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="828,47,980,72"/>
<area shape="rect" id="node7" href="s2n__hash_8c.html#a8b39db9e0a5456a10a5d790474f09818" title="s2n_hash_copy" alt="" coords="433,764,548,790"/>
<area shape="rect" id="node8" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="637,420,759,446"/>
<area shape="rect" id="node9" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="861,272,947,298"/>
<area shape="rect" id="node10" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="858,322,950,347"/>
<area shape="rect" id="node11" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="850,371,958,396"/>
<area shape="rect" id="node12" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="850,420,958,446"/>
<area shape="rect" id="node13" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="850,470,958,495"/>
<area shape="rect" id="node14" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="850,519,958,544"/>
<area shape="rect" id="node16" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1207,174,1344,199"/>
<area shape="rect" id="node18" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="435,122,547,147"/>
<area shape="rect" id="node19" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="429,223,552,248"/>
<area shape="rect" id="node25" href="s2n__hmac_8c.html#ad9e0cc00ac39458cba7a9b1792429dbd" title="s2n_hmac_digest_size" alt="" coords="412,715,569,740"/>
<area shape="rect" id="node42" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="416,72,566,98"/>
<area shape="rect" id="node43" href="s2n__hmac_8c.html#ad5056a3fc151619a2935471a5861fc3d" title="s2n_hmac_init" alt="" coords="437,666,544,691"/>
<area shape="rect" id="node44" href="s2n__stuffer_8c.html#a49bb9749c055c6fb6f713cebeaa14cb5" title="s2n_stuffer_read" alt="" coords="430,23,551,48"/>
<area shape="rect" id="node20" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="617,223,779,248"/>
<area shape="rect" id="node21" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="827,223,981,248"/>
<area shape="rect" id="node22" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1029,223,1159,248"/>
<area shape="rect" id="node23" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1231,223,1320,248"/>
<area shape="rect" id="node24" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1392,223,1465,248"/>
<area shape="rect" id="node26" href="s2n__hash_8c.html#aced4a438c67e79b78d41edfbb8b3e07a" title="s2n_hash_digest_size" alt="" coords="622,963,775,988"/>
<area shape="rect" id="node27" href="s2n__hash_8c.html#a684a3779eebad8329d41443454dd6fa2" title="s2n_hash_init" alt="" coords="646,691,750,716"/>
<area shape="rect" id="node34" href="s2n__hash_8c.html#a0f3c4efbf552f607071e552dc0548ee6" title="s2n_hash_update" alt="" coords="635,864,762,890"/>
<area shape="rect" id="node41" href="s2n__hmac_8c.html#ac4f30ec554d9a717c6269a5de8ae4acf" title="s2n_hmac_reset" alt="" coords="638,914,758,939"/>
<area shape="rect" id="node28" href="crypto_2md5_2md5_8h.html#ae06ac750835b8cb838b6be5986ddcad9" title="MD5_Init" alt="" coords="867,568,941,594"/>
<area shape="rect" id="node29" href="crypto_2sha_2sha_8h.html#ad954eeef9b6210b817502847aea169fa" title="SHA1_Init" alt="" coords="863,618,945,643"/>
<area shape="rect" id="node30" href="crypto_2sha_2sha_8h.html#ab3befdb5a3202fa6d2eda5f3a06eadfa" title="SHA224_Init" alt="" coords="856,667,952,692"/>
<area shape="rect" id="node31" href="crypto_2sha_2sha_8h.html#ac96292b35fd2d8387259000aa378ae0d" title="SHA256_Init" alt="" coords="856,716,952,742"/>
<area shape="rect" id="node32" href="crypto_2sha_2sha_8h.html#ab7ca087b2f4896acc5a9e55a018fb99c" title="SHA384_Init" alt="" coords="856,766,952,791"/>
<area shape="rect" id="node33" href="crypto_2sha_2sha_8h.html#a4a803e92438efee8717c1dd0679de99c" title="SHA512_Init" alt="" coords="856,815,952,840"/>
<area shape="rect" id="node35" href="crypto_2md5_2md5_8h.html#abedf8217cb8c106b729d7b78dd7f4f46" title="MD5_Update" alt="" coords="854,864,954,890"/>
<area shape="rect" id="node36" href="crypto_2sha_2sha_8h.html#aadef8538263b2cb59f73cfc4e9e26ea0" title="SHA1_Update" alt="" coords="851,914,957,939"/>
<area shape="rect" id="node37" href="crypto_2sha_2sha_8h.html#ada9a5985070b4397bc01b6ea6ddba702" title="SHA224_Update" alt="" coords="843,963,965,988"/>
<area shape="rect" id="node38" href="crypto_2sha_2sha_8h.html#a9d2c95d9cac6ceb095f3e7c48efec95a" title="SHA256_Update" alt="" coords="843,1012,965,1038"/>
<area shape="rect" id="node39" href="crypto_2sha_2sha_8h.html#aa790a16716c1e350def2dfb1c7411ea2" title="SHA384_Update" alt="" coords="843,1062,965,1087"/>
<area shape="rect" id="node40" href="crypto_2sha_2sha_8h.html#a0728f9400cea5d81dad5e5a290c6f263" title="SHA512_Update" alt="" coords="843,1111,965,1136"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac384b39fb82314ba9d3d4aebbae8f0e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_client_finished_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__client__finished_8c_source.html#l00042">42</a> of file <a class="el" href="s2n__client__finished_8c_source.html">s2n_client_finished.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    uint8_t *our_version;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__prf_8c.html#a809931120983e64ed6602dbac2b9b1fc">s2n_prf_client_finished</a>(conn));</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> seq = {.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#ab7767b5b58441b15ac1028ac18b06ef1">client_sequence_number</a>,.size = <span class="keyword">sizeof</span>(conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#ab7767b5b58441b15ac1028ac18b06ef1">client_sequence_number</a>) };</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877">s2n_blob_zero</a>(&amp;seq));</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    our_version = conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#a2855df54edee8fcbca0272bfa74784ca">client_finished</a>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">/* Update the server to use the cipher suite */</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#a052f81d7dc7e2612341fe0da1e749ebd">client</a> = &amp;conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> == <a class="code" href="s2n_8h.html#a457805749bd152786e9e344a5b22ab67">S2N_SSLv3</a>) {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, our_version, <a class="code" href="tls_2s2n__crypto_8h.html#a687b2e6f366133714257fc7e9d6537bd">S2N_SSL_FINISHED_LEN</a>));</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, our_version, <a class="code" href="tls_2s2n__crypto_8h.html#a325fdff46d03553d7962ab1a878bcec1">S2N_TLS_FINISHED_LEN</a>));</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__blob_8c_html_a241c17ca2593704ff88734d13659a877"><div class="ttname"><a href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877">s2n_blob_zero</a></div><div class="ttdeci">int s2n_blob_zero(struct s2n_blob *b)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8c_source.html#l00032">s2n_blob.c:32</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="structs2n__connection_html_af9b47a1de13de52e7beddb948a40fec1"><div class="ttname"><a href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">s2n_connection::actual_protocol_version</a></div><div class="ttdeci">uint8_t actual_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00072">s2n_connection.h:72</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_a325fdff46d03553d7962ab1a878bcec1"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#a325fdff46d03553d7962ab1a878bcec1">S2N_TLS_FINISHED_LEN</a></div><div class="ttdeci">#define S2N_TLS_FINISHED_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00032">s2n_crypto.h:32</a></div></div>
<div class="ttc" id="s2n_8h_html_a457805749bd152786e9e344a5b22ab67"><div class="ttname"><a href="s2n_8h.html#a457805749bd152786e9e344a5b22ab67">S2N_SSLv3</a></div><div class="ttdeci">#define S2N_SSLv3</div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00026">s2n.h:26</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_a687b2e6f366133714257fc7e9d6537bd"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#a687b2e6f366133714257fc7e9d6537bd">S2N_SSL_FINISHED_LEN</a></div><div class="ttdeci">#define S2N_SSL_FINISHED_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00033">s2n_crypto.h:33</a></div></div>
<div class="ttc" id="structs2n__connection_html_a052f81d7dc7e2612341fe0da1e749ebd"><div class="ttname"><a href="structs2n__connection.html#a052f81d7dc7e2612341fe0da1e749ebd">s2n_connection::client</a></div><div class="ttdeci">struct s2n_crypto_parameters * client</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00080">s2n_connection.h:80</a></div></div>
<div class="ttc" id="s2n__prf_8c_html_a809931120983e64ed6602dbac2b9b1fc"><div class="ttname"><a href="s2n__prf_8c.html#a809931120983e64ed6602dbac2b9b1fc">s2n_prf_client_finished</a></div><div class="ttdeci">int s2n_prf_client_finished(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__prf_8c_source.html#l00237">s2n_prf.c:237</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="structs2n__handshake_html_a2855df54edee8fcbca0272bfa74784ca"><div class="ttname"><a href="structs2n__handshake.html#a2855df54edee8fcbca0272bfa74784ca">s2n_handshake::client_finished</a></div><div class="ttdeci">uint8_t client_finished[S2N_SSL_FINISHED_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00055">s2n_handshake.h:55</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_ab7767b5b58441b15ac1028ac18b06ef1"><div class="ttname"><a href="structs2n__crypto__parameters.html#ab7767b5b58441b15ac1028ac18b06ef1">s2n_crypto_parameters::client_sequence_number</a></div><div class="ttdeci">uint8_t client_sequence_number[S2N_TLS_SEQUENCE_NUM_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00065">s2n_crypto.h:65</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_afe5e2db5400000f371d2245e1e0669eb"><div class="ttname"><a href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a></div><div class="ttdeci">int s2n_stuffer_write_bytes(struct s2n_stuffer *stuffer, const uint8_t *data, const uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00224">s2n_stuffer.c:224</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_ac384b39fb82314ba9d3d4aebbae8f0e3_cgraph.png" border="0" usemap="#s2n__tls_8h_ac384b39fb82314ba9d3d4aebbae8f0e3_cgraph" alt=""/></div>
<map name="s2n__tls_8h_ac384b39fb82314ba9d3d4aebbae8f0e3_cgraph" id="s2n__tls_8h_ac384b39fb82314ba9d3d4aebbae8f0e3_cgraph">
<area shape="rect" id="node2" href="s2n__prf_8c.html#a809931120983e64ed6602dbac2b9b1fc" title="s2n_prf_client_finished" alt="" coords="227,153,384,179"/>
<area shape="rect" id="node11" href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877" title="s2n_blob_zero" alt="" coords="251,209,360,235"/>
<area shape="rect" id="node12" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="224,283,386,308"/>
<area shape="rect" id="node3" href="s2n__hash_8c.html#a8b39db9e0a5456a10a5d790474f09818" title="s2n_hash_copy" alt="" coords="454,104,569,129"/>
<area shape="rect" id="node4" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="450,153,572,179"/>
<area shape="rect" id="node5" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="658,5,744,31"/>
<area shape="rect" id="node6" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="655,55,747,80"/>
<area shape="rect" id="node7" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="647,104,755,129"/>
<area shape="rect" id="node8" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="647,153,755,179"/>
<area shape="rect" id="node9" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="647,203,755,228"/>
<area shape="rect" id="node10" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="647,252,755,277"/>
<area shape="rect" id="node13" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="434,295,588,320"/>
<area shape="rect" id="node14" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="636,301,766,327"/>
<area shape="rect" id="node15" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="814,276,951,301"/>
<area shape="rect" id="node16" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="838,325,927,351"/>
<area shape="rect" id="node17" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="999,325,1072,351"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1e5af2e3c7ad308eb7a32333210875f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_client_finished_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__client__finished_8c_source.html#l00027">27</a> of file <a class="el" href="s2n__client__finished_8c_source.html">s2n_client_finished.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    uint8_t *our_version;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    our_version = conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#a2855df54edee8fcbca0272bfa74784ca">client_finished</a>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    uint8_t *their_version = <a class="code" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, <a class="code" href="tls_2s2n__crypto_8h.html#a325fdff46d03553d7962ab1a878bcec1">S2N_TLS_FINISHED_LEN</a>);</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(their_version);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="s2n__server__fuzz__test__overrides_8c.html#a407f3056ab784369c0ccb3359532669a">s2n_constant_time_equals</a>(our_version, their_version, <a class="code" href="tls_2s2n__crypto_8h.html#a325fdff46d03553d7962ab1a878bcec1">S2N_TLS_FINISHED_LEN</a>) || conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#a65e2d8c6247963b90c9c2e3d574b0319">rsa_failed</a>) {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__server__fuzz__test__overrides_8c_html_a407f3056ab784369c0ccb3359532669a"><div class="ttname"><a href="s2n__server__fuzz__test__overrides_8c.html#a407f3056ab784369c0ccb3359532669a">s2n_constant_time_equals</a></div><div class="ttdeci">int s2n_constant_time_equals(const uint8_t *a, const uint8_t *b, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__server__fuzz__test__overrides_8c_source.html#l00042">s2n_server_fuzz_test_overrides.c:42</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a5148294f6ed0bf894afc83a31ee4f8a5"><div class="ttname"><a href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a></div><div class="ttdeci">void * s2n_stuffer_raw_read(struct s2n_stuffer *stuffer, uint32_t data_len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00149">s2n_stuffer.c:149</a></div></div>
<div class="ttc" id="structs2n__handshake_html_a65e2d8c6247963b90c9c2e3d574b0319"><div class="ttname"><a href="structs2n__handshake.html#a65e2d8c6247963b90c9c2e3d574b0319">s2n_handshake::rsa_failed</a></div><div class="ttdeci">uint8_t rsa_failed</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00081">s2n_handshake.h:81</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00051">s2n_errno.h:51</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_a325fdff46d03553d7962ab1a878bcec1"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#a325fdff46d03553d7962ab1a878bcec1">S2N_TLS_FINISHED_LEN</a></div><div class="ttdeci">#define S2N_TLS_FINISHED_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00032">s2n_crypto.h:32</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a372ad5deb70573456ecde442c0c466be"><div class="ttname"><a href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a></div><div class="ttdeci">#define notnull_check(ptr)                  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00025">s2n_safety.h:25</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="structs2n__handshake_html_a2855df54edee8fcbca0272bfa74784ca"><div class="ttname"><a href="structs2n__handshake.html#a2855df54edee8fcbca0272bfa74784ca">s2n_handshake::client_finished</a></div><div class="ttdeci">uint8_t client_finished[S2N_SSL_FINISHED_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00055">s2n_handshake.h:55</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a1e5af2e3c7ad308eb7a32333210875f5_cgraph.png" border="0" usemap="#s2n__tls_8h_a1e5af2e3c7ad308eb7a32333210875f5_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a1e5af2e3c7ad308eb7a32333210875f5_cgraph" id="s2n__tls_8h_a1e5af2e3c7ad308eb7a32333210875f5_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="236,5,386,31"/>
<area shape="rect" id="node4" href="s2n__server__fuzz__test__overrides_8c.html#a407f3056ab784369c0ccb3359532669a" title="s2n_constant_time_equals" alt="" coords="221,55,401,80"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="449,5,601,31"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1faebdea4c42a7b27ce347885b9bd9ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_finished_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__finished_8c_source.html#l00048">48</a> of file <a class="el" href="s2n__server__finished_8c_source.html">s2n_server_finished.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    uint8_t *our_version;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="crypto_2asn1_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a> = <a class="code" href="tls_2s2n__crypto_8h.html#a325fdff46d03553d7962ab1a878bcec1">S2N_TLS_FINISHED_LEN</a>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">/* Compute the finished message */</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__prf_8c.html#a4d977ca107f8b2ac76823eb6281ca69b">s2n_prf_server_finished</a>(conn));</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    our_version = conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#a93637661124329bd2a8b9110e00c6766">server_finished</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> == <a class="code" href="s2n_8h.html#a457805749bd152786e9e344a5b22ab67">S2N_SSLv3</a>) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        length = <a class="code" href="tls_2s2n__crypto_8h.html#a687b2e6f366133714257fc7e9d6537bd">S2N_SSL_FINISHED_LEN</a>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, our_version, length));</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">/* Zero the sequence number */</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> seq = {.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>.<a class="code" href="structs2n__crypto__parameters.html#a286710aff413808336b2f294554c7e55">server_sequence_number</a>,.size = <a class="code" href="tls_2s2n__crypto_8h.html#ab6af529d3a237c0d8d2f67edcf831c25">S2N_TLS_SEQUENCE_NUM_LEN</a> };</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877">s2n_blob_zero</a>(&amp;seq));</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">/* Update the secure state to active, and point the client at the active state */</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    conn-&gt;<a class="code" href="structs2n__connection.html#abfab1f3796089e3576e73286c0b6889c">server</a> = &amp;conn-&gt;<a class="code" href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">secure</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#a8b8974068a8f2c38a061ffb495a5ca1c">handshake_type</a> == RESUME) {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f">s2n_prf_key_expansion</a>(conn));</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    }</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div><div class="ttc" id="s2n__prf_8c_html_a1425bb608ed69a0cc582af0a57955e1f"><div class="ttname"><a href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f">s2n_prf_key_expansion</a></div><div class="ttdeci">int s2n_prf_key_expansion(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__prf_8c_source.html#l00349">s2n_prf.c:349</a></div></div>
<div class="ttc" id="structs2n__connection_html_aaa284f060d5075d1526931181d9e4fa7"><div class="ttname"><a href="structs2n__connection.html#aaa284f060d5075d1526931181d9e4fa7">s2n_connection::secure</a></div><div class="ttdeci">struct s2n_crypto_parameters secure</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00077">s2n_connection.h:77</a></div></div>
<div class="ttc" id="structs2n__connection_html_abfab1f3796089e3576e73286c0b6889c"><div class="ttname"><a href="structs2n__connection.html#abfab1f3796089e3576e73286c0b6889c">s2n_connection::server</a></div><div class="ttdeci">struct s2n_crypto_parameters * server</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00081">s2n_connection.h:81</a></div></div>
<div class="ttc" id="s2n__prf_8c_html_a4d977ca107f8b2ac76823eb6281ca69b"><div class="ttname"><a href="s2n__prf_8c.html#a4d977ca107f8b2ac76823eb6281ca69b">s2n_prf_server_finished</a></div><div class="ttdeci">int s2n_prf_server_finished(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__prf_8c_source.html#l00293">s2n_prf.c:293</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__blob_8c_html_a241c17ca2593704ff88734d13659a877"><div class="ttname"><a href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877">s2n_blob_zero</a></div><div class="ttdeci">int s2n_blob_zero(struct s2n_blob *b)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8c_source.html#l00032">s2n_blob.c:32</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="crypto_2asn1_2asn1_8h_html_a5a2d57a92488e64c730cabc247c9d5b5"><div class="ttname"><a href="crypto_2asn1_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a></div><div class="ttdeci">const unsigned char long length</div><div class="ttdef"><b>Definition:</b> <a href="crypto_2asn1_2asn1_8h_source.html#l00907">asn1.h:907</a></div></div>
<div class="ttc" id="structs2n__handshake_html_a8b8974068a8f2c38a061ffb495a5ca1c"><div class="ttname"><a href="structs2n__handshake.html#a8b8974068a8f2c38a061ffb495a5ca1c">s2n_handshake::handshake_type</a></div><div class="ttdeci">enum s2n_handshake::@78 handshake_type</div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="structs2n__connection_html_af9b47a1de13de52e7beddb948a40fec1"><div class="ttname"><a href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">s2n_connection::actual_protocol_version</a></div><div class="ttdeci">uint8_t actual_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00072">s2n_connection.h:72</a></div></div>
<div class="ttc" id="structs2n__handshake_html_a93637661124329bd2a8b9110e00c6766"><div class="ttname"><a href="structs2n__handshake.html#a93637661124329bd2a8b9110e00c6766">s2n_handshake::server_finished</a></div><div class="ttdeci">uint8_t server_finished[S2N_SSL_FINISHED_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00054">s2n_handshake.h:54</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_a325fdff46d03553d7962ab1a878bcec1"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#a325fdff46d03553d7962ab1a878bcec1">S2N_TLS_FINISHED_LEN</a></div><div class="ttdeci">#define S2N_TLS_FINISHED_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00032">s2n_crypto.h:32</a></div></div>
<div class="ttc" id="s2n_8h_html_a457805749bd152786e9e344a5b22ab67"><div class="ttname"><a href="s2n_8h.html#a457805749bd152786e9e344a5b22ab67">S2N_SSLv3</a></div><div class="ttdeci">#define S2N_SSLv3</div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00026">s2n.h:26</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_a687b2e6f366133714257fc7e9d6537bd"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#a687b2e6f366133714257fc7e9d6537bd">S2N_SSL_FINISHED_LEN</a></div><div class="ttdeci">#define S2N_SSL_FINISHED_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00033">s2n_crypto.h:33</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_ab6af529d3a237c0d8d2f67edcf831c25"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#ab6af529d3a237c0d8d2f67edcf831c25">S2N_TLS_SEQUENCE_NUM_LEN</a></div><div class="ttdeci">#define S2N_TLS_SEQUENCE_NUM_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00029">s2n_crypto.h:29</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
<div class="ttc" id="structs2n__crypto__parameters_html_a286710aff413808336b2f294554c7e55"><div class="ttname"><a href="structs2n__crypto__parameters.html#a286710aff413808336b2f294554c7e55">s2n_crypto_parameters::server_sequence_number</a></div><div class="ttdeci">uint8_t server_sequence_number[S2N_TLS_SEQUENCE_NUM_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00066">s2n_crypto.h:66</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_afe5e2db5400000f371d2245e1e0669eb"><div class="ttname"><a href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a></div><div class="ttdeci">int s2n_stuffer_write_bytes(struct s2n_stuffer *stuffer, const uint8_t *data, const uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00224">s2n_stuffer.c:224</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a1faebdea4c42a7b27ce347885b9bd9ee_cgraph.png" border="0" usemap="#s2n__tls_8h_a1faebdea4c42a7b27ce347885b9bd9ee_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a1faebdea4c42a7b27ce347885b9bd9ee_cgraph" id="s2n__tls_8h_a1faebdea4c42a7b27ce347885b9bd9ee_cgraph">
<area shape="rect" id="node2" href="s2n__prf_8c.html#a4d977ca107f8b2ac76823eb6281ca69b" title="s2n_prf_server_finished" alt="" coords="230,380,394,405"/>
<area shape="rect" id="node11" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="647,253,809,279"/>
<area shape="rect" id="node17" href="s2n__blob_8c.html#a241c17ca2593704ff88734d13659a877" title="s2n_blob_zero" alt="" coords="258,607,367,632"/>
<area shape="rect" id="node18" href="s2n__prf_8c.html#a1425bb608ed69a0cc582af0a57955e1f" title="s2n_prf_key_expansion" alt="" coords="231,557,393,583"/>
<area shape="rect" id="node3" href="s2n__hash_8c.html#a8b39db9e0a5456a10a5d790474f09818" title="s2n_hash_copy" alt="" coords="463,329,578,355"/>
<area shape="rect" id="node4" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="667,303,789,328"/>
<area shape="rect" id="node5" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="891,129,977,155"/>
<area shape="rect" id="node6" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="887,179,980,204"/>
<area shape="rect" id="node7" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="880,228,987,253"/>
<area shape="rect" id="node8" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="880,277,987,303"/>
<area shape="rect" id="node9" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="880,327,987,352"/>
<area shape="rect" id="node10" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="880,80,987,105"/>
<area shape="rect" id="node12" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="857,31,1011,56"/>
<area shape="rect" id="node13" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1059,31,1189,56"/>
<area shape="rect" id="node14" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1237,5,1373,31"/>
<area shape="rect" id="node15" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1260,55,1350,80"/>
<area shape="rect" id="node16" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1421,55,1495,80"/>
<area shape="rect" id="node19" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="465,532,576,557"/>
<area shape="rect" id="node20" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="459,465,582,491"/>
<area shape="rect" id="node21" href="s2n__hmac_8c.html#ad9e0cc00ac39458cba7a9b1792429dbd" title="s2n_hmac_digest_size" alt="" coords="442,660,599,685"/>
<area shape="rect" id="node38" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="445,759,595,784"/>
<area shape="rect" id="node40" href="s2n__hmac_8c.html#ad5056a3fc151619a2935471a5861fc3d" title="s2n_hmac_init" alt="" coords="467,581,574,607"/>
<area shape="rect" id="node41" href="s2n__stuffer_8c.html#a49bb9749c055c6fb6f713cebeaa14cb5" title="s2n_stuffer_read" alt="" coords="460,907,581,932"/>
<area shape="rect" id="node22" href="s2n__hash_8c.html#aced4a438c67e79b78d41edfbb8b3e07a" title="s2n_hash_digest_size" alt="" coords="651,771,805,796"/>
<area shape="rect" id="node23" href="s2n__hash_8c.html#a684a3779eebad8329d41443454dd6fa2" title="s2n_hash_init" alt="" coords="676,557,780,583"/>
<area shape="rect" id="node30" href="s2n__hash_8c.html#a0f3c4efbf552f607071e552dc0548ee6" title="s2n_hash_update" alt="" coords="664,672,792,697"/>
<area shape="rect" id="node37" href="s2n__hmac_8c.html#ac4f30ec554d9a717c6269a5de8ae4acf" title="s2n_hmac_reset" alt="" coords="668,721,788,747"/>
<area shape="rect" id="node24" href="crypto_2md5_2md5_8h.html#ae06ac750835b8cb838b6be5986ddcad9" title="MD5_Init" alt="" coords="896,623,971,648"/>
<area shape="rect" id="node25" href="crypto_2sha_2sha_8h.html#ad954eeef9b6210b817502847aea169fa" title="SHA1_Init" alt="" coords="893,376,974,401"/>
<area shape="rect" id="node26" href="crypto_2sha_2sha_8h.html#ab3befdb5a3202fa6d2eda5f3a06eadfa" title="SHA224_Init" alt="" coords="886,425,982,451"/>
<area shape="rect" id="node27" href="crypto_2sha_2sha_8h.html#ac96292b35fd2d8387259000aa378ae0d" title="SHA256_Init" alt="" coords="886,475,982,500"/>
<area shape="rect" id="node28" href="crypto_2sha_2sha_8h.html#ab7ca087b2f4896acc5a9e55a018fb99c" title="SHA384_Init" alt="" coords="886,524,982,549"/>
<area shape="rect" id="node29" href="crypto_2sha_2sha_8h.html#a4a803e92438efee8717c1dd0679de99c" title="SHA512_Init" alt="" coords="886,573,982,599"/>
<area shape="rect" id="node31" href="crypto_2md5_2md5_8h.html#abedf8217cb8c106b729d7b78dd7f4f46" title="MD5_Update" alt="" coords="884,919,984,944"/>
<area shape="rect" id="node32" href="crypto_2sha_2sha_8h.html#aadef8538263b2cb59f73cfc4e9e26ea0" title="SHA1_Update" alt="" coords="880,672,987,697"/>
<area shape="rect" id="node33" href="crypto_2sha_2sha_8h.html#ada9a5985070b4397bc01b6ea6ddba702" title="SHA224_Update" alt="" coords="873,721,994,747"/>
<area shape="rect" id="node34" href="crypto_2sha_2sha_8h.html#a9d2c95d9cac6ceb095f3e7c48efec95a" title="SHA256_Update" alt="" coords="873,771,994,796"/>
<area shape="rect" id="node35" href="crypto_2sha_2sha_8h.html#aa790a16716c1e350def2dfb1c7411ea2" title="SHA384_Update" alt="" coords="873,820,994,845"/>
<area shape="rect" id="node36" href="crypto_2sha_2sha_8h.html#a0728f9400cea5d81dad5e5a290c6f263" title="SHA512_Update" alt="" coords="873,869,994,895"/>
<area shape="rect" id="node39" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="858,968,1010,993"/>
<area shape="rect" id="node42" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="648,944,808,969"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adae4d52456ffeb3a606ed1fb545539e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_finished_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__finished_8c_source.html#l00028">28</a> of file <a class="el" href="s2n__server__finished_8c_source.html">s2n_server_finished.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    uint8_t *our_version;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="crypto_2asn1_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a> = <a class="code" href="tls_2s2n__crypto_8h.html#a325fdff46d03553d7962ab1a878bcec1">S2N_TLS_FINISHED_LEN</a>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    our_version = conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#a93637661124329bd2a8b9110e00c6766">server_finished</a>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> == <a class="code" href="s2n_8h.html#a457805749bd152786e9e344a5b22ab67">S2N_SSLv3</a>) {</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        length = <a class="code" href="tls_2s2n__crypto_8h.html#a687b2e6f366133714257fc7e9d6537bd">S2N_SSL_FINISHED_LEN</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    }</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    uint8_t *their_version = <a class="code" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, length);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(their_version);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="s2n__server__fuzz__test__overrides_8c.html#a407f3056ab784369c0ccb3359532669a">s2n_constant_time_equals</a>(our_version, their_version, length)) {</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__server__fuzz__test__overrides_8c_html_a407f3056ab784369c0ccb3359532669a"><div class="ttname"><a href="s2n__server__fuzz__test__overrides_8c.html#a407f3056ab784369c0ccb3359532669a">s2n_constant_time_equals</a></div><div class="ttdeci">int s2n_constant_time_equals(const uint8_t *a, const uint8_t *b, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__server__fuzz__test__overrides_8c_source.html#l00042">s2n_server_fuzz_test_overrides.c:42</a></div></div>
<div class="ttc" id="crypto_2asn1_2asn1_8h_html_a5a2d57a92488e64c730cabc247c9d5b5"><div class="ttname"><a href="crypto_2asn1_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a></div><div class="ttdeci">const unsigned char long length</div><div class="ttdef"><b>Definition:</b> <a href="crypto_2asn1_2asn1_8h_source.html#l00907">asn1.h:907</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a5148294f6ed0bf894afc83a31ee4f8a5"><div class="ttname"><a href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a></div><div class="ttdeci">void * s2n_stuffer_raw_read(struct s2n_stuffer *stuffer, uint32_t data_len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00149">s2n_stuffer.c:149</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00051">s2n_errno.h:51</a></div></div>
<div class="ttc" id="structs2n__connection_html_af9b47a1de13de52e7beddb948a40fec1"><div class="ttname"><a href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">s2n_connection::actual_protocol_version</a></div><div class="ttdeci">uint8_t actual_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00072">s2n_connection.h:72</a></div></div>
<div class="ttc" id="structs2n__handshake_html_a93637661124329bd2a8b9110e00c6766"><div class="ttname"><a href="structs2n__handshake.html#a93637661124329bd2a8b9110e00c6766">s2n_handshake::server_finished</a></div><div class="ttdeci">uint8_t server_finished[S2N_SSL_FINISHED_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00054">s2n_handshake.h:54</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_a325fdff46d03553d7962ab1a878bcec1"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#a325fdff46d03553d7962ab1a878bcec1">S2N_TLS_FINISHED_LEN</a></div><div class="ttdeci">#define S2N_TLS_FINISHED_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00032">s2n_crypto.h:32</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a372ad5deb70573456ecde442c0c466be"><div class="ttname"><a href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a></div><div class="ttdeci">#define notnull_check(ptr)                  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00025">s2n_safety.h:25</a></div></div>
<div class="ttc" id="s2n_8h_html_a457805749bd152786e9e344a5b22ab67"><div class="ttname"><a href="s2n_8h.html#a457805749bd152786e9e344a5b22ab67">S2N_SSLv3</a></div><div class="ttdeci">#define S2N_SSLv3</div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00026">s2n.h:26</a></div></div>
<div class="ttc" id="tls_2s2n__crypto_8h_html_a687b2e6f366133714257fc7e9d6537bd"><div class="ttname"><a href="tls_2s2n__crypto_8h.html#a687b2e6f366133714257fc7e9d6537bd">S2N_SSL_FINISHED_LEN</a></div><div class="ttdeci">#define S2N_SSL_FINISHED_LEN</div><div class="ttdef"><b>Definition:</b> <a href="tls_2s2n__crypto_8h_source.html#l00033">s2n_crypto.h:33</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_adae4d52456ffeb3a606ed1fb545539e4_cgraph.png" border="0" usemap="#s2n__tls_8h_adae4d52456ffeb3a606ed1fb545539e4_cgraph" alt=""/></div>
<map name="s2n__tls_8h_adae4d52456ffeb3a606ed1fb545539e4_cgraph" id="s2n__tls_8h_adae4d52456ffeb3a606ed1fb545539e4_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="242,5,392,31"/>
<area shape="rect" id="node4" href="s2n__server__fuzz__test__overrides_8c.html#a407f3056ab784369c0ccb3359532669a" title="s2n_constant_time_equals" alt="" coords="227,55,407,80"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="455,5,607,31"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae327aa8441c888a0bfca0058761abd97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_handshake_write_header </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>message_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__handshake_8c_source.html#l00027">27</a> of file <a class="el" href="s2n__handshake_8c_source.html">s2n_handshake.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>)) {</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ae948d942ad6d03abc85d9f90cfae3d45">S2N_ERR_HANDSHAKE_STATE</a>);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    }</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">/* Write the message header */</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, message_type));</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">/* Leave the length blank for now */</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    uint16_t <a class="code" href="crypto_2asn1_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a> = 0;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9">s2n_stuffer_write_uint24</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, length));</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__stuffer_8h_html_a56d3da0e05e4c05eb87a343306c4f170"><div class="ttname"><a href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a></div><div class="ttdeci">#define s2n_stuffer_data_available(s)  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00045">s2n_stuffer.h:45</a></div></div>
<div class="ttc" id="crypto_2asn1_2asn1_8h_html_a5a2d57a92488e64c730cabc247c9d5b5"><div class="ttname"><a href="crypto_2asn1_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a></div><div class="ttdeci">const unsigned char long length</div><div class="ttdef"><b>Definition:</b> <a href="crypto_2asn1_2asn1_8h_source.html#l00907">asn1.h:907</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aa78701a9bb01def1efcbfa30ba0bdfc9"><div class="ttname"><a href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9">s2n_stuffer_write_uint24</a></div><div class="ttdeci">int s2n_stuffer_write_uint24(struct s2n_stuffer *stuffer, const uint32_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00290">s2n_stuffer.c:290</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aaca63d5bb519a92734bd0287199a7f5a"><div class="ttname"><a href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a></div><div class="ttdeci">int s2n_stuffer_write_uint8(struct s2n_stuffer *stuffer, const uint8_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00249">s2n_stuffer.c:249</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ae948d942ad6d03abc85d9f90cfae3d45"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ae948d942ad6d03abc85d9f90cfae3d45">S2N_ERR_HANDSHAKE_STATE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00102">s2n_errno.h:102</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97_cgraph.png" border="0" usemap="#s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97_cgraph" alt=""/></div>
<map name="s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97_cgraph" id="s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="208,5,367,31"/>
<area shape="rect" id="node9" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9" title="s2n_stuffer_write_uint24" alt="" coords="204,55,371,80"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="419,31,581,56"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="629,31,782,56"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="830,31,960,56"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1008,5,1145,31"/>
<area shape="rect" id="node7" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1032,55,1122,80"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1193,55,1266,80"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97_icgraph.png" border="0" usemap="#s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97_icgraph" alt=""/></div>
<map name="s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97_icgraph" id="s2n__tls_8h_ae327aa8441c888a0bfca0058761abd97_icgraph">
<area shape="rect" id="node2" href="s2n__handshake__io_8c.html#a4406f29de6d52b587003368d656dab20" title="s2n_conn_set_handshake_type" alt="" coords="204,55,414,80"/>
<area shape="rect" id="node3" href="s2n__tls_8h.html#abfb7d01ea645110aea3c808de4d86f1d" title="s2n_client_hello_recv" alt="" coords="481,5,630,31"/>
<area shape="rect" id="node4" href="s2n__tls_8h.html#ac1466c1ce812576f187dacd032e682e1" title="s2n_sslv2_client_hello_recv" alt="" coords="462,55,649,80"/>
<area shape="rect" id="node5" href="s2n__tls_8h.html#a2139f810755eb8cf27ebea179e81ac81" title="s2n_server_hello_recv" alt="" coords="478,104,633,129"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0a9a88c8621eab4358a80bb384dd3a3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_handshake_finish_header </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__handshake_8c_source.html#l00043">43</a> of file <a class="el" href="s2n__handshake_8c_source.html">s2n_handshake.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    uint16_t <a class="code" href="crypto_2asn1_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a> = <a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (length &lt; <a class="code" href="s2n__tls__parameters_8h.html#a13c46676240c1573c5304f8038d30279">TLS_HANDSHAKE_HEADER_LENGTH</a>) {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374a602cb5165e354dd39c49af50bbbc1cb9">S2N_ERR_SIZE_MISMATCH</a>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    uint16_t payload = length - <a class="code" href="s2n__tls__parameters_8h.html#a13c46676240c1573c5304f8038d30279">TLS_HANDSHAKE_HEADER_LENGTH</a>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">/* Write the message header */</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ae1b97eb16ae517a82ec90a0e2b8c48e7">s2n_stuffer_rewrite</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>));</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876">s2n_stuffer_skip_write</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, 1));</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9">s2n_stuffer_write_uint24</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, payload));</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876">s2n_stuffer_skip_write</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, payload));</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div><div class="ttc" id="s2n__stuffer_8c_html_ae1b97eb16ae517a82ec90a0e2b8c48e7"><div class="ttname"><a href="s2n__stuffer_8c.html#ae1b97eb16ae517a82ec90a0e2b8c48e7">s2n_stuffer_rewrite</a></div><div class="ttdeci">int s2n_stuffer_rewrite(struct s2n_stuffer *stuffer)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00102">s2n_stuffer.c:102</a></div></div>
<div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__stuffer_8h_html_a56d3da0e05e4c05eb87a343306c4f170"><div class="ttname"><a href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a></div><div class="ttdeci">#define s2n_stuffer_data_available(s)  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00045">s2n_stuffer.h:45</a></div></div>
<div class="ttc" id="crypto_2asn1_2asn1_8h_html_a5a2d57a92488e64c730cabc247c9d5b5"><div class="ttname"><a href="crypto_2asn1_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a></div><div class="ttdeci">const unsigned char long length</div><div class="ttdef"><b>Definition:</b> <a href="crypto_2asn1_2asn1_8h_source.html#l00907">asn1.h:907</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aa78701a9bb01def1efcbfa30ba0bdfc9"><div class="ttname"><a href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9">s2n_stuffer_write_uint24</a></div><div class="ttdeci">int s2n_stuffer_write_uint24(struct s2n_stuffer *stuffer, const uint32_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00290">s2n_stuffer.c:290</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a7ef8f252a4b5b3d0bb793e1906d1b876"><div class="ttname"><a href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876">s2n_stuffer_skip_write</a></div><div class="ttdeci">int s2n_stuffer_skip_write(struct s2n_stuffer *stuffer, const uint32_t n)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00192">s2n_stuffer.c:192</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a13c46676240c1573c5304f8038d30279"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a13c46676240c1573c5304f8038d30279">TLS_HANDSHAKE_HEADER_LENGTH</a></div><div class="ttdeci">#define TLS_HANDSHAKE_HEADER_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00114">s2n_tls_parameters.h:114</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374a602cb5165e354dd39c49af50bbbc1cb9"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374a602cb5165e354dd39c49af50bbbc1cb9">S2N_ERR_SIZE_MISMATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00104">s2n_errno.h:104</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a_cgraph.png" border="0" usemap="#s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a_cgraph" id="s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#ae1b97eb16ae517a82ec90a0e2b8c48e7" title="s2n_stuffer_rewrite" alt="" coords="223,5,358,31"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="632,81,785,107"/>
<area shape="rect" id="node8" href="s2n__stuffer_8c.html#aa78701a9bb01def1efcbfa30ba0bdfc9" title="s2n_stuffer_write_uint24" alt="" coords="207,107,374,132"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="833,81,963,107"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1011,56,1148,81"/>
<area shape="rect" id="node6" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1035,105,1125,131"/>
<area shape="rect" id="node7" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1196,105,1269,131"/>
<area shape="rect" id="node9" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="422,107,584,132"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a_icgraph.png" border="0" usemap="#s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a_icgraph" alt=""/></div>
<map name="s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a_icgraph" id="s2n__tls_8h_a0a9a88c8621eab4358a80bb384dd3a3a_icgraph">
<area shape="rect" id="node2" href="s2n__handshake__io_8c.html#a4406f29de6d52b587003368d656dab20" title="s2n_conn_set_handshake_type" alt="" coords="207,55,417,80"/>
<area shape="rect" id="node3" href="s2n__tls_8h.html#abfb7d01ea645110aea3c808de4d86f1d" title="s2n_client_hello_recv" alt="" coords="484,5,633,31"/>
<area shape="rect" id="node4" href="s2n__tls_8h.html#ac1466c1ce812576f187dacd032e682e1" title="s2n_sslv2_client_hello_recv" alt="" coords="465,55,652,80"/>
<area shape="rect" id="node5" href="s2n__tls_8h.html#a2139f810755eb8cf27ebea179e81ac81" title="s2n_server_hello_recv" alt="" coords="481,104,636,129"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8930886c2b7fb7a73ef11c9c7c3c3b42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_handshake_parse_header </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>message_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__handshake_8c_source.html#l00061">61</a> of file <a class="el" href="s2n__handshake_8c_source.html">s2n_handshake.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;{</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>) &lt; <a class="code" href="s2n__tls__parameters_8h.html#a13c46676240c1573c5304f8038d30279">TLS_HANDSHAKE_HEADER_LENGTH</a>) {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374a602cb5165e354dd39c49af50bbbc1cb9">S2N_ERR_SIZE_MISMATCH</a>);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">/* read the message header */</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, message_type));</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c">s2n_stuffer_read_uint24</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">handshake</a>.<a class="code" href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">io</a>, <a class="code" href="crypto_2asn1_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a>));</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div><div class="ttc" id="structs2n__connection_html_a902584c57c26269c7cbf42e4770ed356"><div class="ttname"><a href="structs2n__connection.html#a902584c57c26269c7cbf42e4770ed356">s2n_connection::handshake</a></div><div class="ttdeci">struct s2n_handshake handshake</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00121">s2n_connection.h:121</a></div></div>
<div class="ttc" id="s2n__stuffer_8h_html_a56d3da0e05e4c05eb87a343306c4f170"><div class="ttname"><a href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a></div><div class="ttdeci">#define s2n_stuffer_data_available(s)  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00045">s2n_stuffer.h:45</a></div></div>
<div class="ttc" id="crypto_2asn1_2asn1_8h_html_a5a2d57a92488e64c730cabc247c9d5b5"><div class="ttname"><a href="crypto_2asn1_2asn1_8h.html#a5a2d57a92488e64c730cabc247c9d5b5">length</a></div><div class="ttdeci">const unsigned char long length</div><div class="ttdef"><b>Definition:</b> <a href="crypto_2asn1_2asn1_8h_source.html#l00907">asn1.h:907</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a13c46676240c1573c5304f8038d30279"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a13c46676240c1573c5304f8038d30279">TLS_HANDSHAKE_HEADER_LENGTH</a></div><div class="ttdeci">#define TLS_HANDSHAKE_HEADER_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00114">s2n_tls_parameters.h:114</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a1178687b6091eb483d135c149e87fb0b"><div class="ttname"><a href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b">s2n_stuffer_read_uint8</a></div><div class="ttdeci">int s2n_stuffer_read_uint8(struct s2n_stuffer *stuffer, uint8_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00242">s2n_stuffer.c:242</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a71787bb6eeba3413137cde42d32a0f6c"><div class="ttname"><a href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c">s2n_stuffer_read_uint24</a></div><div class="ttdeci">int s2n_stuffer_read_uint24(struct s2n_stuffer *stuffer, uint32_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00277">s2n_stuffer.c:277</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374a602cb5165e354dd39c49af50bbbc1cb9"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374a602cb5165e354dd39c49af50bbbc1cb9">S2N_ERR_SIZE_MISMATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00104">s2n_errno.h:104</a></div></div>
<div class="ttc" id="structs2n__handshake_html_aede0d4a81b6e474b17ea185025c45bfd"><div class="ttname"><a href="structs2n__handshake.html#aede0d4a81b6e474b17ea185025c45bfd">s2n_handshake::io</a></div><div class="ttdeci">struct s2n_stuffer io</div><div class="ttdef"><b>Definition:</b> <a href="s2n__handshake_8h_source.html#l00047">s2n_handshake.h:47</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42_cgraph.png" border="0" usemap="#s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42_cgraph" id="s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="213,5,371,31"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#a71787bb6eeba3413137cde42d32a0f6c" title="s2n_stuffer_read_uint24" alt="" coords="210,55,374,80"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="422,31,583,56"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="631,31,783,56"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42_icgraph.png" border="0" usemap="#s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42_icgraph" alt=""/></div>
<map name="s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42_icgraph" id="s2n__tls_8h_a8930886c2b7fb7a73ef11c9c7c3c3b42_icgraph">
<area shape="rect" id="node2" href="s2n__handshake__io_8c.html#a4406f29de6d52b587003368d656dab20" title="s2n_conn_set_handshake_type" alt="" coords="210,55,419,80"/>
<area shape="rect" id="node3" href="s2n__tls_8h.html#abfb7d01ea645110aea3c808de4d86f1d" title="s2n_client_hello_recv" alt="" coords="486,5,636,31"/>
<area shape="rect" id="node4" href="s2n__tls_8h.html#ac1466c1ce812576f187dacd032e682e1" title="s2n_sslv2_client_hello_recv" alt="" coords="467,55,655,80"/>
<area shape="rect" id="node5" href="s2n__tls_8h.html#a2139f810755eb8cf27ebea179e81ac81" title="s2n_server_hello_recv" alt="" coords="483,104,639,129"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a807adeb1baad4849f782cfd4de10d113"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_read_full_record </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>record_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>isSSLv2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__recv_8c_source.html#l00039">39</a> of file <a class="el" href="s2n__recv_8c_source.html">s2n_recv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">int</span> r;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    *isSSLv2 = 0;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">/* If the record has already been decrypted, then leave it alone */</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#ad63a0cc0cc12429207575e5d093f59d2">in_status</a> == PLAINTEXT) {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="comment">/* Only application data packets count as plaintext */</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        *record_type = <a class="code" href="s2n__tls__parameters_8h.html#a5104f80ba38ebfd2266b1ec313f0aeb2">TLS_APPLICATION_DATA</a>;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">/* Read the record until we at least have a header */</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a005c1df7387f2c53061e9c9432f70aca">header_in</a>) &lt; <a class="code" href="s2n__tls__parameters_8h.html#a7cc7782f30cb9ee302929d979826c557">S2N_TLS_RECORD_HEADER_LENGTH</a>) {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        r = <a class="code" href="s2n__stuffer_8h.html#a19fe623439e89aeadbac10e98b7a8896">s2n_stuffer_recv_from_fd</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a005c1df7387f2c53061e9c9432f70aca">header_in</a>, conn-&gt;<a class="code" href="structs2n__connection.html#ab8b1e66f9a7b17fa4541b1733b87e011">readfd</a>, <a class="code" href="s2n__tls__parameters_8h.html#a7cc7782f30cb9ee302929d979826c557">S2N_TLS_RECORD_HEADER_LENGTH</a> - <a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a005c1df7387f2c53061e9c9432f70aca">header_in</a>));</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">if</span> (r == 0) {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            conn-&gt;<a class="code" href="structs2n__connection.html#a9e746c5b2dde4a77b710780924853c2f">closed</a> = 1;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ab2b3c63db9e35ed79c3191161b6c9ccc">S2N_ERR_CLOSED</a>);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r &lt; 0) {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_mac_socket_8cpp.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> == EWOULDBLOCK) {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374a440a0e3a40ff1c680a455803a9dd9dfc">S2N_ERR_BLOCKED</a>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ae8ab0b843d6f8172ea5f923aaf083374">S2N_ERR_IO</a>);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        }</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        conn-&gt;<a class="code" href="structs2n__connection.html#ae40976768561ff646c1b9badadcd4f4e">wire_bytes_in</a> += r;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    }</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    uint16_t fragment_length;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">/* If the first bit is set then this is an SSLv2 record */</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#a005c1df7387f2c53061e9c9432f70aca">header_in</a>.<a class="code" href="structs2n__stuffer.html#ab95f00f583f1cb41ae00918e9ea180c9">blob</a>.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a>[0] &amp; 0x80) {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        conn-&gt;<a class="code" href="structs2n__connection.html#a005c1df7387f2c53061e9c9432f70aca">header_in</a>.<a class="code" href="structs2n__stuffer.html#ab95f00f583f1cb41ae00918e9ea180c9">blob</a>.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a>[0] &amp;= 0x7f;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        *isSSLv2 = 1;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="s2n__record_8h.html#ada746040b578344a72196d5dd1d356fd">s2n_sslv2_record_header_parse</a>(conn, record_type, &amp;conn-&gt;<a class="code" href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">client_protocol_version</a>, &amp;fragment_length) &lt; 0) {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__connection_8c.html#a746324b4543d50af7ebedc3ed91fbc57">s2n_connection_kill</a>(conn));</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="s2n__record_8h.html#af0794788139e3e2975022dd47f983eda">s2n_record_header_parse</a>(conn, record_type, &amp;fragment_length) &lt; 0) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__connection_8c.html#a746324b4543d50af7ebedc3ed91fbc57">s2n_connection_kill</a>(conn));</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">/* Read enough to have the whole record */</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a556c2665a42d6fd91dd28fc73d50d21e">in</a>) &lt; fragment_length) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        r = <a class="code" href="s2n__stuffer_8h.html#a19fe623439e89aeadbac10e98b7a8896">s2n_stuffer_recv_from_fd</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a556c2665a42d6fd91dd28fc73d50d21e">in</a>, conn-&gt;<a class="code" href="structs2n__connection.html#ab8b1e66f9a7b17fa4541b1733b87e011">readfd</a>, fragment_length - <a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;conn-&gt;<a class="code" href="structs2n__connection.html#a556c2665a42d6fd91dd28fc73d50d21e">in</a>));</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">if</span> (r == 0) {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            conn-&gt;<a class="code" href="structs2n__connection.html#a9e746c5b2dde4a77b710780924853c2f">closed</a> = 1;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ab2b3c63db9e35ed79c3191161b6c9ccc">S2N_ERR_CLOSED</a>);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r &lt; 0) {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="_mac_socket_8cpp.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a> == EWOULDBLOCK) {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374a440a0e3a40ff1c680a455803a9dd9dfc">S2N_ERR_BLOCKED</a>);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ae8ab0b843d6f8172ea5f923aaf083374">S2N_ERR_IO</a>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        conn-&gt;<a class="code" href="structs2n__connection.html#ae40976768561ff646c1b9badadcd4f4e">wire_bytes_in</a> += r;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    }</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">if</span> (*isSSLv2) {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">/* Decrypt and parse the record */</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="s2n__record_8h.html#a26b47800a66fc8e167d92b302e0b7079">s2n_record_parse</a>(conn) &lt; 0) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__connection_8c.html#a746324b4543d50af7ebedc3ed91fbc57">s2n_connection_kill</a>(conn));</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;}</div><div class="ttc" id="s2n__stuffer_8h_html_a56d3da0e05e4c05eb87a343306c4f170"><div class="ttname"><a href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a></div><div class="ttdeci">#define s2n_stuffer_data_available(s)  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00045">s2n_stuffer.h:45</a></div></div>
<div class="ttc" id="_mac_socket_8cpp_html_ad65a8842cc674e3ddf69355898c0ecbf"><div class="ttname"><a href="_mac_socket_8cpp.html#ad65a8842cc674e3ddf69355898c0ecbf">errno</a></div><div class="ttdeci">int errno</div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374a440a0e3a40ff1c680a455803a9dd9dfc"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374a440a0e3a40ff1c680a455803a9dd9dfc">S2N_ERR_BLOCKED</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00045">s2n_errno.h:45</a></div></div>
<div class="ttc" id="structs2n__connection_html_ab8b1e66f9a7b17fa4541b1733b87e011"><div class="ttname"><a href="structs2n__connection.html#ab8b1e66f9a7b17fa4541b1733b87e011">s2n_connection::readfd</a></div><div class="ttdeci">int readfd</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00044">s2n_connection.h:44</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a5104f80ba38ebfd2266b1ec313f0aeb2"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a5104f80ba38ebfd2266b1ec313f0aeb2">TLS_APPLICATION_DATA</a></div><div class="ttdeci">#define TLS_APPLICATION_DATA</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00073">s2n_tls_parameters.h:73</a></div></div>
<div class="ttc" id="structs2n__connection_html_a556c2665a42d6fd91dd28fc73d50d21e"><div class="ttname"><a href="structs2n__connection.html#a556c2665a42d6fd91dd28fc73d50d21e">s2n_connection::in</a></div><div class="ttdeci">struct s2n_stuffer in</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00091">s2n_connection.h:91</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a7cc7782f30cb9ee302929d979826c557"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a7cc7782f30cb9ee302929d979826c557">S2N_TLS_RECORD_HEADER_LENGTH</a></div><div class="ttdeci">#define S2N_TLS_RECORD_HEADER_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00083">s2n_tls_parameters.h:83</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="structs2n__stuffer_html_ab95f00f583f1cb41ae00918e9ea180c9"><div class="ttname"><a href="structs2n__stuffer.html#ab95f00f583f1cb41ae00918e9ea180c9">s2n_stuffer::blob</a></div><div class="ttdeci">struct s2n_blob blob</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00025">s2n_stuffer.h:25</a></div></div>
<div class="ttc" id="s2n__connection_8c_html_a746324b4543d50af7ebedc3ed91fbc57"><div class="ttname"><a href="s2n__connection_8c.html#a746324b4543d50af7ebedc3ed91fbc57">s2n_connection_kill</a></div><div class="ttdeci">int s2n_connection_kill(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8c_source.html#l00365">s2n_connection.c:365</a></div></div>
<div class="ttc" id="structs2n__connection_html_a005c1df7387f2c53061e9c9432f70aca"><div class="ttname"><a href="structs2n__connection.html#a005c1df7387f2c53061e9c9432f70aca">s2n_connection::header_in</a></div><div class="ttdeci">struct s2n_stuffer header_in</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00090">s2n_connection.h:90</a></div></div>
<div class="ttc" id="structs2n__connection_html_ae40976768561ff646c1b9badadcd4f4e"><div class="ttname"><a href="structs2n__connection.html#ae40976768561ff646c1b9badadcd4f4e">s2n_connection::wire_bytes_in</a></div><div class="ttdeci">uint64_t wire_bytes_in</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00126">s2n_connection.h:126</a></div></div>
<div class="ttc" id="s2n__record_8h_html_ada746040b578344a72196d5dd1d356fd"><div class="ttname"><a href="s2n__record_8h.html#ada746040b578344a72196d5dd1d356fd">s2n_sslv2_record_header_parse</a></div><div class="ttdeci">int s2n_sslv2_record_header_parse(struct s2n_connection *conn, uint8_t *record_type, uint8_t *client_protocol_version, uint16_t *fragment_length)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__record__read_8c_source.html#l00037">s2n_record_read.c:37</a></div></div>
<div class="ttc" id="structs2n__connection_html_ad63a0cc0cc12429207575e5d093f59d2"><div class="ttname"><a href="structs2n__connection.html#ad63a0cc0cc12429207575e5d093f59d2">s2n_connection::in_status</a></div><div class="ttdeci">enum s2n_connection::@77 in_status</div></div>
<div class="ttc" id="structs2n__connection_html_a9e746c5b2dde4a77b710780924853c2f"><div class="ttname"><a href="structs2n__connection.html#a9e746c5b2dde4a77b710780924853c2f">s2n_connection::closed</a></div><div class="ttdeci">sig_atomic_t closed</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00143">s2n_connection.h:143</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ab2b3c63db9e35ed79c3191161b6c9ccc"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ab2b3c63db9e35ed79c3191161b6c9ccc">S2N_ERR_CLOSED</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00043">s2n_errno.h:43</a></div></div>
<div class="ttc" id="s2n__record_8h_html_af0794788139e3e2975022dd47f983eda"><div class="ttname"><a href="s2n__record_8h.html#af0794788139e3e2975022dd47f983eda">s2n_record_header_parse</a></div><div class="ttdeci">int s2n_record_header_parse(struct s2n_connection *conn, uint8_t *content_type, uint16_t *fragment_length)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__record__read_8c_source.html#l00060">s2n_record_read.c:60</a></div></div>
<div class="ttc" id="structs2n__connection_html_a29289057caf9ad21e99bd972da14acc3"><div class="ttname"><a href="structs2n__connection.html#a29289057caf9ad21e99bd972da14acc3">s2n_connection::client_protocol_version</a></div><div class="ttdeci">uint8_t client_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00070">s2n_connection.h:70</a></div></div>
<div class="ttc" id="s2n__stuffer_8h_html_a19fe623439e89aeadbac10e98b7a8896"><div class="ttname"><a href="s2n__stuffer_8h.html#a19fe623439e89aeadbac10e98b7a8896">s2n_stuffer_recv_from_fd</a></div><div class="ttdeci">int s2n_stuffer_recv_from_fd(struct s2n_stuffer *stuffer, int rfd, uint32_t len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer__file_8c_source.html#l00029">s2n_stuffer_file.c:29</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ae8ab0b843d6f8172ea5f923aaf083374"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ae8ab0b843d6f8172ea5f923aaf083374">S2N_ERR_IO</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00041">s2n_errno.h:41</a></div></div>
<div class="ttc" id="s2n__record_8h_html_a26b47800a66fc8e167d92b302e0b7079"><div class="ttname"><a href="s2n__record_8h.html#a26b47800a66fc8e167d92b302e0b7079">s2n_record_parse</a></div><div class="ttdeci">int s2n_record_parse(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__record__read_8c_source.html#l00091">s2n_record_read.c:91</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113_cgraph.png" border="0" usemap="#s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113_cgraph" id="s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8h.html#a19fe623439e89aeadbac10e98b7a8896" title="s2n_stuffer_recv_from_fd" alt="" coords="200,343,372,368"/>
<area shape="rect" id="node8" href="s2n__record_8h.html#ada746040b578344a72196d5dd1d356fd" title="s2n_sslv2_record_header\l_parse" alt="" coords="422,1140,596,1179"/>
<area shape="rect" id="node13" href="s2n__connection_8c.html#a746324b4543d50af7ebedc3ed91fbc57" title="s2n_connection_kill" alt="" coords="217,55,355,80"/>
<area shape="rect" id="node18" href="s2n__record_8h.html#af0794788139e3e2975022dd47f983eda" title="s2n_record_header_parse" alt="" coords="420,1091,598,1116"/>
<area shape="rect" id="node20" href="s2n__record_8h.html#a26b47800a66fc8e167d92b302e0b7079" title="s2n_record_parse" alt="" coords="222,629,350,655"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="1101,105,1255,131"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1303,68,1433,93"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1481,760,1617,785"/>
<area shape="rect" id="node6" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1504,68,1594,93"/>
<area shape="rect" id="node7" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1665,68,1739,93"/>
<area shape="rect" id="node9" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5" title="s2n_stuffer_read_uint16" alt="" coords="662,1091,827,1116"/>
<area shape="rect" id="node10" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="892,1091,1052,1116"/>
<area shape="rect" id="node12" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="666,1140,823,1165"/>
<area shape="rect" id="node11" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="1102,889,1254,915"/>
<area shape="rect" id="node14" href="s2n__random_8c.html#a8aabcb071120a9849d4615358000a8a6" title="s2n_public_random" alt="" coords="440,5,578,31"/>
<area shape="rect" id="node17" href="s2n__timer_8c.html#a78c722b16f52af289f500f2f6e471904" title="s2n_timer_start" alt="" coords="452,55,566,80"/>
<area shape="rect" id="node15" href="s2n__random_8c.html#a5cfef84444cc08086a4098569c9f1fc8" title="s2n_get_public_random_data" alt="" coords="646,5,843,31"/>
<area shape="rect" id="node16" href="s2n__drbg_8c.html#a9fad975e364d5a398330eb937745f0e6" title="s2n_drbg_generate" alt="" coords="903,5,1040,31"/>
<area shape="rect" id="node19" href="s2n__stuffer_8c.html#a5d6db4ed8311ba66aec1227fceca24a9" title="s2n_stuffer_reread" alt="" coords="678,1041,811,1067"/>
<area shape="rect" id="node21" href="s2n__record__read_8c.html#af0794788139e3e2975022dd47f983eda" title="s2n_record_header_parse" alt="" coords="420,1041,598,1067"/>
<area shape="rect" id="node22" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="897,889,1047,915"/>
<area shape="rect" id="node23" href="s2n__stuffer_8c.html#a49bb9749c055c6fb6f713cebeaa14cb5" title="s2n_stuffer_read" alt="" coords="684,940,805,965"/>
<area shape="rect" id="node24" href="s2n__hmac_8c.html#ad9e0cc00ac39458cba7a9b1792429dbd" title="s2n_hmac_digest_size" alt="" coords="666,571,823,596"/>
<area shape="rect" id="node40" href="s2n__hmac_8c.html#ac4f30ec554d9a717c6269a5de8ae4acf" title="s2n_hmac_reset" alt="" coords="912,673,1032,699"/>
<area shape="rect" id="node48" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="453,307,565,332"/>
<area shape="rect" id="node49" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="891,207,1053,232"/>
<area shape="rect" id="node50" href="s2n__aead_8c.html#aafbbe3f24a9f607cc8cb47a6af5a3505" title="s2n_aead_aad_init" alt="" coords="442,256,576,281"/>
<area shape="rect" id="node53" href="s2n__hmac_8c.html#a9dbba560a1ef91d4c2114c792f221333" title="s2n_hmac_update" alt="" coords="679,357,810,383"/>
<area shape="rect" id="node54" href="s2n__sequence_8c.html#a650e459c699416b64accc69561e5fc16" title="s2n_increment_sequence\l_number" alt="" coords="422,623,596,661"/>
<area shape="rect" id="node55" href="s2n__cbc_8c.html#a49a0a2c5708c690625b2474555727b80" title="s2n_verify_cbc" alt="" coords="454,472,564,497"/>
<area shape="rect" id="node58" href="s2n__hmac_8c.html#a4501c4b9ea25f86e9c6c0e9d1bd9276b" title="s2n_hmac_digest" alt="" coords="909,413,1035,439"/>
<area shape="rect" id="node61" href="s2n__stuffer_8c.html#a2b6b54f7856d92f06f823bc26d10f4ba" title="s2n_stuffer_wipe" alt="" coords="1117,803,1239,828"/>
<area shape="rect" id="node62" href="s2n__hmac_8c.html#a7787cefe78aedac6b20db11cc451a433" title="s2n_hmac_digest_verify" alt="" coords="427,573,592,599"/>
<area shape="rect" id="node25" href="s2n__hash_8c.html#aced4a438c67e79b78d41edfbb8b3e07a" title="s2n_hash_digest_size" alt="" coords="895,565,1049,591"/>
<area shape="rect" id="node26" href="s2n__hash_8c.html#a684a3779eebad8329d41443454dd6fa2" title="s2n_hash_init" alt="" coords="1316,413,1419,439"/>
<area shape="rect" id="node33" href="s2n__hash_8c.html#a0f3c4efbf552f607071e552dc0548ee6" title="s2n_hash_update" alt="" coords="1114,313,1241,339"/>
<area shape="rect" id="node41" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="1117,588,1239,613"/>
<area shape="rect" id="node27" href="crypto_2md5_2md5_8h.html#ae06ac750835b8cb838b6be5986ddcad9" title="MD5_Init" alt="" coords="1512,488,1586,513"/>
<area shape="rect" id="node28" href="crypto_2sha_2sha_8h.html#ad954eeef9b6210b817502847aea169fa" title="SHA1_Init" alt="" coords="1508,537,1590,563"/>
<area shape="rect" id="node29" href="crypto_2sha_2sha_8h.html#ab3befdb5a3202fa6d2eda5f3a06eadfa" title="SHA224_Init" alt="" coords="1501,291,1597,316"/>
<area shape="rect" id="node30" href="crypto_2sha_2sha_8h.html#ac96292b35fd2d8387259000aa378ae0d" title="SHA256_Init" alt="" coords="1501,340,1597,365"/>
<area shape="rect" id="node31" href="crypto_2sha_2sha_8h.html#ab7ca087b2f4896acc5a9e55a018fb99c" title="SHA384_Init" alt="" coords="1501,389,1597,415"/>
<area shape="rect" id="node32" href="crypto_2sha_2sha_8h.html#a4a803e92438efee8717c1dd0679de99c" title="SHA512_Init" alt="" coords="1501,439,1597,464"/>
<area shape="rect" id="node34" href="crypto_2md5_2md5_8h.html#abedf8217cb8c106b729d7b78dd7f4f46" title="MD5_Update" alt="" coords="1318,167,1418,192"/>
<area shape="rect" id="node35" href="crypto_2sha_2sha_8h.html#aadef8538263b2cb59f73cfc4e9e26ea0" title="SHA1_Update" alt="" coords="1314,216,1421,241"/>
<area shape="rect" id="node36" href="crypto_2sha_2sha_8h.html#ada9a5985070b4397bc01b6ea6ddba702" title="SHA224_Update" alt="" coords="1307,265,1428,291"/>
<area shape="rect" id="node37" href="crypto_2sha_2sha_8h.html#a9d2c95d9cac6ceb095f3e7c48efec95a" title="SHA256_Update" alt="" coords="1307,315,1428,340"/>
<area shape="rect" id="node38" href="crypto_2sha_2sha_8h.html#aa790a16716c1e350def2dfb1c7411ea2" title="SHA384_Update" alt="" coords="1307,364,1428,389"/>
<area shape="rect" id="node39" href="crypto_2sha_2sha_8h.html#a0728f9400cea5d81dad5e5a290c6f263" title="SHA512_Update" alt="" coords="1307,117,1428,143"/>
<area shape="rect" id="node42" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="1325,561,1411,587"/>
<area shape="rect" id="node43" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="1321,611,1414,636"/>
<area shape="rect" id="node44" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="1314,660,1421,685"/>
<area shape="rect" id="node45" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="1314,709,1421,735"/>
<area shape="rect" id="node46" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="1314,463,1421,488"/>
<area shape="rect" id="node47" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="1314,512,1421,537"/>
<area shape="rect" id="node51" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="665,207,824,232"/>
<area shape="rect" id="node52" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f" title="s2n_stuffer_write_uint16" alt="" coords="661,256,828,281"/>
<area shape="rect" id="node56" href="s2n__hmac_8c.html#a6007599a9ecbe64464dc464093931f6a" title="s2n_hmac_copy" alt="" coords="685,521,804,547"/>
<area shape="rect" id="node57" href="s2n__hmac_8c.html#a2afcf63a3b7f8fc08957f53b820ad39f" title="s2n_hmac_digest_two\l_compression_rounds" alt="" coords="667,459,821,497"/>
<area shape="rect" id="node60" href="s2n__server__fuzz__test__overrides_8c.html#a407f3056ab784369c0ccb3359532669a" title="s2n_constant_time_equals" alt="" coords="654,620,834,645"/>
<area shape="rect" id="node59" href="s2n__hash_8c.html#a3ad42d683b1126e7d8eb329b68382bc8" title="s2n_hash_reset" alt="" coords="1120,413,1236,439"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113_icgraph.png" border="0" usemap="#s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113_icgraph" alt=""/></div>
<map name="s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113_icgraph" id="s2n__tls_8h_a807adeb1baad4849f782cfd4de10d113_icgraph">
<area shape="rect" id="node2" href="s2n__handshake__io_8c.html#a4406f29de6d52b587003368d656dab20" title="s2n_conn_set_handshake_type" alt="" coords="200,55,410,80"/>
<area shape="rect" id="node6" href="s2n__recv_8c.html#afede11e597a4db3024ec2b68733a643d" title="s2n_recv" alt="" coords="514,153,589,179"/>
<area shape="rect" id="node13" href="s2n__tls_8h.html#ae859ce8ed78bbade19bf53c23cf6dec8" title="s2n_recv_close_notify" alt="" coords="228,211,381,236"/>
<area shape="rect" id="node3" href="s2n__tls_8h.html#abfb7d01ea645110aea3c808de4d86f1d" title="s2n_client_hello_recv" alt="" coords="476,5,626,31"/>
<area shape="rect" id="node4" href="s2n__tls_8h.html#ac1466c1ce812576f187dacd032e682e1" title="s2n_sslv2_client_hello_recv" alt="" coords="458,55,645,80"/>
<area shape="rect" id="node5" href="s2n__tls_8h.html#a2139f810755eb8cf27ebea179e81ac81" title="s2n_server_hello_recv" alt="" coords="474,104,629,129"/>
<area shape="rect" id="node7" href="api__test_8c.html#a767caeff0f20559426ecc269ca133182" title="harness" alt="" coords="704,197,773,223"/>
<area shape="rect" id="node8" href="s2nd_8c.html#adc37832656c6aa5548ab17e981176dab" title="echo" alt="" coords="714,96,764,121"/>
<area shape="rect" id="node12" href="s2n__self__talk__alpn__test_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="858,236,908,261"/>
<area shape="rect" id="node9" href="s2nd_8c.html#a82dfd7cd8c27b3f6e78bc51538e81dce" title="cache_delete" alt="" coords="833,68,933,93"/>
<area shape="rect" id="node10" href="s2nd_8c.html#ad1835a0a190dc5fe4f925bb69443c770" title="main" alt="" coords="1183,68,1234,93"/>
<area shape="rect" id="node11" href="s2n__config_8c.html#a5a13d9dc1fefcdd6c08c329e47f84e9e" title="s2n_config_set_cache\l_delete_callback" alt="" coords="981,61,1135,100"/>
<area shape="rect" id="node14" href="s2n__shutdown_8c.html#aa69f439da6aa9a9b0ba76945bac17210" title="s2n_shutdown" alt="" coords="498,223,605,248"/>
<area shape="rect" id="node15" href="s2nc_8c.html#ad1835a0a190dc5fe4f925bb69443c770" title="main" alt="" coords="714,247,764,272"/>
<area shape="rect" id="node16" href="s2n__self__talk__alpn__test_8c.html#af4ff368c1e25033d38a42be5a63e3ff9" title="mock_client" alt="" coords="693,296,785,321"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae859ce8ed78bbade19bf53c23cf6dec8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_recv_close_notify </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15d">s2n_blocked_status</a> *&#160;</td>
          <td class="paramname"><em>blocked</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__recv_8c_source.html#l00198">198</a> of file <a class="el" href="s2n__recv_8c_source.html">s2n_recv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    uint8_t record_type;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">int</span> isSSLv2;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    *blocked = <a class="code" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15daf76a7c83e9548139b7b8d50bdd5ff323">S2N_BLOCKED_ON_READ</a>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__recv_8c.html#a807adeb1baad4849f782cfd4de10d113">s2n_read_full_record</a>(conn, &amp;record_type, &amp;isSSLv2));</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">if</span> (isSSLv2) {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a>);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span> (record_type != <a class="code" href="s2n__fragmentation__coalescing__test_8c.html#afe02a145f0d3a71b14d61e2774987f9d">TLS_ALERT</a>) {</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a>(<a class="code" href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374aecb2193808a40bc03ee82cbb232caa68">S2N_ERR_SHUTDOWN_RECORD_TYPE</a>);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">/* Only succeds for an incoming close_notify alert */</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__alerts_8c.html#a45bdea2fd7faa208c0272f56bfb8c656">s2n_process_alert_fragment</a>(conn));</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    *blocked = <a class="code" href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd">S2N_NOT_BLOCKED</a>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div><div class="ttc" id="s2n__recv_8c_html_a807adeb1baad4849f782cfd4de10d113"><div class="ttname"><a href="s2n__recv_8c.html#a807adeb1baad4849f782cfd4de10d113">s2n_read_full_record</a></div><div class="ttdeci">int s2n_read_full_record(struct s2n_connection *conn, uint8_t *record_type, int *isSSLv2)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__recv_8c_source.html#l00039">s2n_recv.c:39</a></div></div>
<div class="ttc" id="s2n__fragmentation__coalescing__test_8c_html_afe02a145f0d3a71b14d61e2774987f9d"><div class="ttname"><a href="s2n__fragmentation__coalescing__test_8c.html#afe02a145f0d3a71b14d61e2774987f9d">TLS_ALERT</a></div><div class="ttdeci">#define TLS_ALERT</div><div class="ttdef"><b>Definition:</b> <a href="s2n__fragmentation__coalescing__test_8c_source.html#l00037">s2n_fragmentation_coalescing_test.c:37</a></div></div>
<div class="ttc" id="s2n_8h_html_af70ca0b089daa98cd79a424d3f6af15daf76a7c83e9548139b7b8d50bdd5ff323"><div class="ttname"><a href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15daf76a7c83e9548139b7b8d50bdd5ff323">S2N_BLOCKED_ON_READ</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00091">s2n.h:91</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a4728100d8e1cd9097e9318a7e9fed9a9"><div class="ttname"><a href="s2n__errno_8h.html#a4728100d8e1cd9097e9318a7e9fed9a9">S2N_ERROR</a></div><div class="ttdeci">#define S2N_ERROR(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00132">s2n_errno.h:132</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374ad61ca0bcc8f9f8bf3e065de30ad547fb">S2N_ERR_BAD_MESSAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00051">s2n_errno.h:51</a></div></div>
<div class="ttc" id="s2n_8h_html_af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd"><div class="ttname"><a href="s2n_8h.html#af70ca0b089daa98cd79a424d3f6af15da7afdc9e789b567fe89c7142f34ec3ebd">S2N_NOT_BLOCKED</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00091">s2n.h:91</a></div></div>
<div class="ttc" id="s2n__alerts_8c_html_a45bdea2fd7faa208c0272f56bfb8c656"><div class="ttname"><a href="s2n__alerts_8c.html#a45bdea2fd7faa208c0272f56bfb8c656">s2n_process_alert_fragment</a></div><div class="ttdeci">int s2n_process_alert_fragment(struct s2n_connection *conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__alerts_8c_source.html#l00059">s2n_alerts.c:59</a></div></div>
<div class="ttc" id="s2n__errno_8h_html_a64ed9ec59a957387654c5e5865325374aecb2193808a40bc03ee82cbb232caa68"><div class="ttname"><a href="s2n__errno_8h.html#a64ed9ec59a957387654c5e5865325374aecb2193808a40bc03ee82cbb232caa68">S2N_ERR_SHUTDOWN_RECORD_TYPE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__errno_8h_source.html#l00076">s2n_errno.h:76</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8_cgraph.png" border="0" usemap="#s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8_cgraph" alt=""/></div>
<map name="s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8_cgraph" id="s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8_cgraph">
<area shape="rect" id="node2" href="s2n__recv_8c.html#a807adeb1baad4849f782cfd4de10d113" title="s2n_read_full_record" alt="" coords="207,1109,353,1135"/>
<area shape="rect" id="node64" href="s2n__alerts_8c.html#a45bdea2fd7faa208c0272f56bfb8c656" title="s2n_process_alert_fragment" alt="" coords="401,1168,592,1193"/>
<area shape="rect" id="node3" href="s2n__stuffer_8h.html#a19fe623439e89aeadbac10e98b7a8896" title="s2n_stuffer_recv_from_fd" alt="" coords="410,1557,582,1583"/>
<area shape="rect" id="node9" href="s2n__record_8h.html#ada746040b578344a72196d5dd1d356fd" title="s2n_sslv2_record_header\l_parse" alt="" coords="641,1015,816,1053"/>
<area shape="rect" id="node14" href="s2n__connection_8c.html#a746324b4543d50af7ebedc3ed91fbc57" title="s2n_connection_kill" alt="" coords="427,1371,565,1396"/>
<area shape="rect" id="node19" href="s2n__record_8h.html#af0794788139e3e2975022dd47f983eda" title="s2n_record_header_parse" alt="" coords="640,1077,817,1103"/>
<area shape="rect" id="node21" href="s2n__record_8h.html#a26b47800a66fc8e167d92b302e0b7079" title="s2n_record_parse" alt="" coords="432,688,561,713"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="1320,1319,1474,1344"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1522,1109,1652,1135"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1700,699,1837,724"/>
<area shape="rect" id="node7" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1724,1109,1813,1135"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1885,1109,1958,1135"/>
<area shape="rect" id="node10" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5" title="s2n_stuffer_read_uint16" alt="" coords="881,965,1046,991"/>
<area shape="rect" id="node11" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="1111,1016,1271,1041"/>
<area shape="rect" id="node13" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="885,1067,1043,1092"/>
<area shape="rect" id="node12" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="1321,891,1473,916"/>
<area shape="rect" id="node15" href="s2n__random_8c.html#a8aabcb071120a9849d4615358000a8a6" title="s2n_public_random" alt="" coords="660,1371,797,1396"/>
<area shape="rect" id="node18" href="s2n__timer_8c.html#a78c722b16f52af289f500f2f6e471904" title="s2n_timer_start" alt="" coords="672,1645,785,1671"/>
<area shape="rect" id="node16" href="s2n__random_8c.html#a5cfef84444cc08086a4098569c9f1fc8" title="s2n_get_public_random_data" alt="" coords="865,1371,1062,1396"/>
<area shape="rect" id="node17" href="s2n__drbg_8c.html#a9fad975e364d5a398330eb937745f0e6" title="s2n_drbg_generate" alt="" coords="1123,1371,1260,1396"/>
<area shape="rect" id="node20" href="s2n__stuffer_8c.html#a5d6db4ed8311ba66aec1227fceca24a9" title="s2n_stuffer_reread" alt="" coords="897,916,1030,941"/>
<area shape="rect" id="node22" href="s2n__record__read_8c.html#af0794788139e3e2975022dd47f983eda" title="s2n_record_header_parse" alt="" coords="640,965,817,991"/>
<area shape="rect" id="node23" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="1116,713,1266,739"/>
<area shape="rect" id="node24" href="s2n__stuffer_8c.html#a49bb9749c055c6fb6f713cebeaa14cb5" title="s2n_stuffer_read" alt="" coords="903,815,1024,840"/>
<area shape="rect" id="node25" href="s2n__hmac_8c.html#ad9e0cc00ac39458cba7a9b1792429dbd" title="s2n_hmac_digest_size" alt="" coords="885,459,1042,484"/>
<area shape="rect" id="node41" href="s2n__hmac_8c.html#ac4f30ec554d9a717c6269a5de8ae4acf" title="s2n_hmac_reset" alt="" coords="1131,555,1251,580"/>
<area shape="rect" id="node49" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="673,916,784,941"/>
<area shape="rect" id="node50" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="1110,1469,1272,1495"/>
<area shape="rect" id="node51" href="s2n__aead_8c.html#aafbbe3f24a9f607cc8cb47a6af5a3505" title="s2n_aead_aad_init" alt="" coords="661,1493,795,1519"/>
<area shape="rect" id="node54" href="s2n__hmac_8c.html#a9dbba560a1ef91d4c2114c792f221333" title="s2n_hmac_update" alt="" coords="898,245,1029,271"/>
<area shape="rect" id="node55" href="s2n__sequence_8c.html#a650e459c699416b64accc69561e5fc16" title="s2n_increment_sequence\l_number" alt="" coords="641,347,815,385"/>
<area shape="rect" id="node56" href="s2n__cbc_8c.html#a49a0a2c5708c690625b2474555727b80" title="s2n_verify_cbc" alt="" coords="673,409,784,435"/>
<area shape="rect" id="node59" href="s2n__hmac_8c.html#a4501c4b9ea25f86e9c6c0e9d1bd9276b" title="s2n_hmac_digest" alt="" coords="1128,301,1254,327"/>
<area shape="rect" id="node62" href="s2n__stuffer_8c.html#a2b6b54f7856d92f06f823bc26d10f4ba" title="s2n_stuffer_wipe" alt="" coords="1336,629,1458,655"/>
<area shape="rect" id="node63" href="s2n__hmac_8c.html#a7787cefe78aedac6b20db11cc451a433" title="s2n_hmac_digest_verify" alt="" coords="646,511,811,536"/>
<area shape="rect" id="node26" href="s2n__hash_8c.html#aced4a438c67e79b78d41edfbb8b3e07a" title="s2n_hash_digest_size" alt="" coords="1115,453,1268,479"/>
<area shape="rect" id="node27" href="s2n__hash_8c.html#a684a3779eebad8329d41443454dd6fa2" title="s2n_hash_init" alt="" coords="1535,301,1639,327"/>
<area shape="rect" id="node34" href="s2n__hash_8c.html#a0f3c4efbf552f607071e552dc0548ee6" title="s2n_hash_update" alt="" coords="1333,201,1461,227"/>
<area shape="rect" id="node42" href="s2n__hash_8c.html#ac0a5e6f9f981a0e473bfb9dba9c3d7c9" title="s2n_hash_digest" alt="" coords="1336,476,1458,501"/>
<area shape="rect" id="node28" href="crypto_2md5_2md5_8h.html#ae06ac750835b8cb838b6be5986ddcad9" title="MD5_Init" alt="" coords="1731,277,1806,303"/>
<area shape="rect" id="node29" href="crypto_2sha_2sha_8h.html#ad954eeef9b6210b817502847aea169fa" title="SHA1_Init" alt="" coords="1728,327,1809,352"/>
<area shape="rect" id="node30" href="crypto_2sha_2sha_8h.html#ab3befdb5a3202fa6d2eda5f3a06eadfa" title="SHA224_Init" alt="" coords="1720,376,1816,401"/>
<area shape="rect" id="node31" href="crypto_2sha_2sha_8h.html#ac96292b35fd2d8387259000aa378ae0d" title="SHA256_Init" alt="" coords="1720,425,1816,451"/>
<area shape="rect" id="node32" href="crypto_2sha_2sha_8h.html#ab7ca087b2f4896acc5a9e55a018fb99c" title="SHA384_Init" alt="" coords="1720,179,1816,204"/>
<area shape="rect" id="node33" href="crypto_2sha_2sha_8h.html#a4a803e92438efee8717c1dd0679de99c" title="SHA512_Init" alt="" coords="1720,228,1816,253"/>
<area shape="rect" id="node35" href="crypto_2md5_2md5_8h.html#abedf8217cb8c106b729d7b78dd7f4f46" title="MD5_Update" alt="" coords="1537,203,1637,228"/>
<area shape="rect" id="node36" href="crypto_2sha_2sha_8h.html#aadef8538263b2cb59f73cfc4e9e26ea0" title="SHA1_Update" alt="" coords="1534,252,1640,277"/>
<area shape="rect" id="node37" href="crypto_2sha_2sha_8h.html#ada9a5985070b4397bc01b6ea6ddba702" title="SHA224_Update" alt="" coords="1526,5,1648,31"/>
<area shape="rect" id="node38" href="crypto_2sha_2sha_8h.html#a9d2c95d9cac6ceb095f3e7c48efec95a" title="SHA256_Update" alt="" coords="1526,55,1648,80"/>
<area shape="rect" id="node39" href="crypto_2sha_2sha_8h.html#aa790a16716c1e350def2dfb1c7411ea2" title="SHA384_Update" alt="" coords="1526,104,1648,129"/>
<area shape="rect" id="node40" href="crypto_2sha_2sha_8h.html#a0728f9400cea5d81dad5e5a290c6f263" title="SHA512_Update" alt="" coords="1526,153,1648,179"/>
<area shape="rect" id="node43" href="crypto_2md5_2md5_8h.html#a1169c93fbfcc8a2dc726e55ca023138e" title="MD5_Final" alt="" coords="1544,548,1630,573"/>
<area shape="rect" id="node44" href="crypto_2sha_2sha_8h.html#adaae0401397bd1fd91ee074543543f1e" title="SHA1_Final" alt="" coords="1541,597,1633,623"/>
<area shape="rect" id="node45" href="crypto_2sha_2sha_8h.html#a90750ed313a4ed0802550508508011f7" title="SHA224_Final" alt="" coords="1533,351,1641,376"/>
<area shape="rect" id="node46" href="crypto_2sha_2sha_8h.html#a04bb7f30fd7f616f1927a6aeacd72a2b" title="SHA256_Final" alt="" coords="1533,400,1641,425"/>
<area shape="rect" id="node47" href="crypto_2sha_2sha_8h.html#a3fb27292b8e2cf63863acccc6973b6f8" title="SHA384_Final" alt="" coords="1533,449,1641,475"/>
<area shape="rect" id="node48" href="crypto_2sha_2sha_8h.html#a5765aef1aca8834e00e10fbac4a3e859" title="SHA512_Final" alt="" coords="1533,499,1641,524"/>
<area shape="rect" id="node52" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="884,1469,1043,1495"/>
<area shape="rect" id="node53" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f" title="s2n_stuffer_write_uint16" alt="" coords="881,1519,1047,1544"/>
<area shape="rect" id="node57" href="s2n__hmac_8c.html#a6007599a9ecbe64464dc464093931f6a" title="s2n_hmac_copy" alt="" coords="905,409,1023,435"/>
<area shape="rect" id="node58" href="s2n__hmac_8c.html#a2afcf63a3b7f8fc08957f53b820ad39f" title="s2n_hmac_digest_two\l_compression_rounds" alt="" coords="887,347,1041,385"/>
<area shape="rect" id="node61" href="s2n__server__fuzz__test__overrides_8c.html#a407f3056ab784369c0ccb3359532669a" title="s2n_constant_time_equals" alt="" coords="874,509,1054,535"/>
<area shape="rect" id="node60" href="s2n__hash_8c.html#a3ad42d683b1126e7d8eb329b68382bc8" title="s2n_hash_reset" alt="" coords="1339,301,1455,327"/>
<area shape="rect" id="node65" href="s2n__stuffer_8c.html#aff9283fe7b7a90e13c6c90014719354d" title="s2n_stuffer_copy" alt="" coords="1130,1168,1253,1193"/>
<area shape="rect" id="node66" href="s2n__resume_8c.html#af0cd9536cbece4a1bcebb3d69f8d4fd1" title="s2n_is_caching_enabled" alt="" coords="644,1269,812,1295"/>
<area shape="rect" id="node67" href="s2n__stuffer_8c.html#af5be81568462bd6626c1d00a939ff30d" title="s2n_stuffer_write_uint64" alt="" coords="881,1420,1047,1445"/>
<area shape="rect" id="node68" href="s2n__stuffer_8c.html#ae1122959189bd03c92af5fd134016977" title="s2n_stuffer_read_uint64" alt="" coords="881,1269,1046,1295"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8_icgraph.png" border="0" usemap="#s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8_icgraph" alt=""/></div>
<map name="s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8_icgraph" id="s2n__tls_8h_ae859ce8ed78bbade19bf53c23cf6dec8_icgraph">
<area shape="rect" id="node2" href="s2n__shutdown_8c.html#aa69f439da6aa9a9b0ba76945bac17210" title="s2n_shutdown" alt="" coords="207,55,314,80"/>
<area shape="rect" id="node3" href="api__test_8c.html#a767caeff0f20559426ecc269ca133182" title="harness" alt="" coords="373,5,442,31"/>
<area shape="rect" id="node4" href="s2nc_8c.html#ad1835a0a190dc5fe4f925bb69443c770" title="main" alt="" coords="383,55,433,80"/>
<area shape="rect" id="node5" href="s2n__self__talk__alpn__test_8c.html#af4ff368c1e25033d38a42be5a63e3ff9" title="mock_client" alt="" coords="362,104,454,129"/>
<area shape="rect" id="node6" href="s2n__self__talk__alpn__test_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="502,104,552,129"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5693cff7b0838d6d62b5b9e70a1e17f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_client_extensions_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs2n__stuffer.html">s2n_stuffer</a> *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__client__extensions_8c_source.html#l00037">37</a> of file <a class="el" href="s2n__client__extensions_8c_source.html">s2n_client_extensions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    uint16_t total_size = 0;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">/* Signature algorithms */</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> == <a class="code" href="s2n_8h.html#ab17e84046986d49ffd31571b8d32d24e">S2N_TLS12</a>) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        total_size += 8;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    uint16_t application_protocols_len = conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#a45182f90f146494a0f2dc4c962bbba0e">application_protocols</a>.<a class="code" href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">size</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    uint16_t server_name_len = strlen(conn-&gt;<a class="code" href="structs2n__connection.html#aaeec7205ccf6834a5eaf18d9a5eb8936">server_name</a>);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (server_name_len) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        total_size += 9 + server_name_len;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">if</span> (application_protocols_len) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        total_size += 6 + application_protocols_len;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#aa6c7e4f4cf13d4d133b66760cf0d09fa">status_request_type</a> != <a class="code" href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635aea0f05b257857adc1282f77c5414e35a">S2N_STATUS_REQUEST_NONE</a>) {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        total_size += 9;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">/* Write ECC extensions: Supported Curves and Supported Point Formats */</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">int</span> ec_curves_count = <span class="keyword">sizeof</span>(<a class="code" href="s2n__ecc_8c.html#a27f438af5123167d9e831390707be2a0">s2n_ecc_supported_curves</a>) / <span class="keyword">sizeof</span>(<a class="code" href="s2n__ecc_8c.html#a27f438af5123167d9e831390707be2a0">s2n_ecc_supported_curves</a>[0]);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    total_size += 12 + ec_curves_count * 2;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, total_size));</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">actual_protocol_version</a> == <a class="code" href="s2n_8h.html#ab17e84046986d49ffd31571b8d32d24e">S2N_TLS12</a>) {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="comment">/* The extension header */</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, <a class="code" href="s2n__tls__parameters_8h.html#a2df8cf476badc3a52f44d65caad71734">TLS_EXTENSION_SIGNATURE_ALGORITHMS</a>));</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, 4));</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="comment">/* Just one signature/hash pair, so 2 bytes */</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, 2));</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, <a class="code" href="s2n__tls__parameters_8h.html#ab079d73832dc62bda962af8b28f13a1b">TLS_HASH_ALGORITHM_SHA1</a>));</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, <a class="code" href="s2n__tls__parameters_8h.html#a28638d3ef91538f8a4ba9ba4c3d7cdca">TLS_SIGNATURE_ALGORITHM_RSA</a>));</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span> (server_name_len) {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">/* Write the server name */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, <a class="code" href="s2n__tls__parameters_8h.html#ac5af336fe762b24789dde11d13a74035">TLS_EXTENSION_SERVER_NAME</a>));</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, server_name_len + 5));</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">/* Size of all of the server names */</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, server_name_len + 3));</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="comment">/* Name type - host name, RFC3546 */</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, 0));</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> server_name;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        server_name.<a class="code" href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = (uint8_t *) conn-&gt;<a class="code" href="structs2n__connection.html#aaeec7205ccf6834a5eaf18d9a5eb8936">server_name</a>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        server_name.size = server_name_len;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, server_name_len));</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde">s2n_stuffer_write</a>(out, &amp;server_name));</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">/* Write ALPN extension */</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span> (application_protocols_len) {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, <a class="code" href="s2n__tls__parameters_8h.html#a753973f1e9b19bde89de02430b355128">TLS_EXTENSION_ALPN</a>));</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, application_protocols_len + 2));</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, application_protocols_len));</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde">s2n_stuffer_write</a>(out, &amp;conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#a45182f90f146494a0f2dc4c962bbba0e">application_protocols</a>));</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#aa6c7e4f4cf13d4d133b66760cf0d09fa">status_request_type</a> != <a class="code" href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635aea0f05b257857adc1282f77c5414e35a">S2N_STATUS_REQUEST_NONE</a>) {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="comment">/* We only support OCSP */</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="s2n__safety_8h.html#a286ad9b0d46f4af176671cda1ed6f58a">eq_check</a>(conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#aa6c7e4f4cf13d4d133b66760cf0d09fa">status_request_type</a>, <a class="code" href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8">S2N_STATUS_REQUEST_OCSP</a>);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, <a class="code" href="s2n__tls__parameters_8h.html#acf3d575671ffd01a1400417f16520421">TLS_EXTENSION_STATUS_REQUEST</a>));</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, 5));</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, (uint8_t) conn-&gt;<a class="code" href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">config</a>-&gt;<a class="code" href="structs2n__config.html#aa6c7e4f4cf13d4d133b66760cf0d09fa">status_request_type</a>));</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, 0));</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, 0));</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">     * RFC 4492: Clients SHOULD send both the Supported Elliptic Curves Extension</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">     * and the Supported Point Formats Extension.</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, <a class="code" href="s2n__tls__parameters_8h.html#a0b8dde07daa13a017697a6218c34b11c">TLS_EXTENSION_ELLIPTIC_CURVES</a>));</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, 2 + ec_curves_count * 2));</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">/* Curve list len */</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, ec_curves_count * 2));</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">/* Curve list */</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ec_curves_count; i++) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, <a class="code" href="s2n__ecc_8c.html#a27f438af5123167d9e831390707be2a0">s2n_ecc_supported_curves</a>[i].iana_id));</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, <a class="code" href="s2n__tls__parameters_8h.html#a350023b90c4e7b5de523b149308440d7">TLS_EXTENSION_EC_POINT_FORMATS</a>));</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, 2));</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">/* Point format list len */</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, 1));</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">/* Only allow uncompressed format */</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, 0));</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div><div class="ttc" id="s2n__tls__parameters_8h_html_ab079d73832dc62bda962af8b28f13a1b"><div class="ttname"><a href="s2n__tls__parameters_8h.html#ab079d73832dc62bda962af8b28f13a1b">TLS_HASH_ALGORITHM_SHA1</a></div><div class="ttdeci">#define TLS_HASH_ALGORITHM_SHA1</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00063">s2n_tls_parameters.h:63</a></div></div>
<div class="ttc" id="structs2n__blob_html_ab2c6b258f02add8fdf4cfc7c371dd772"><div class="ttname"><a href="structs2n__blob.html#ab2c6b258f02add8fdf4cfc7c371dd772">s2n_blob::size</a></div><div class="ttdeci">uint32_t size</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00022">s2n_blob.h:22</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a753973f1e9b19bde89de02430b355128"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a753973f1e9b19bde89de02430b355128">TLS_EXTENSION_ALPN</a></div><div class="ttdeci">#define TLS_EXTENSION_ALPN</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00057">s2n_tls_parameters.h:57</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="structs2n__config_html_a45182f90f146494a0f2dc4c962bbba0e"><div class="ttname"><a href="structs2n__config.html#a45182f90f146494a0f2dc4c962bbba0e">s2n_config::application_protocols</a></div><div class="ttdeci">struct s2n_blob application_protocols</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00043">s2n_config.h:43</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_ac5af336fe762b24789dde11d13a74035"><div class="ttname"><a href="s2n__tls__parameters_8h.html#ac5af336fe762b24789dde11d13a74035">TLS_EXTENSION_SERVER_NAME</a></div><div class="ttdeci">#define TLS_EXTENSION_SERVER_NAME</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00052">s2n_tls_parameters.h:52</a></div></div>
<div class="ttc" id="structs2n__connection_html_a7d70bb7bed95daae1233293126bb9523"><div class="ttname"><a href="structs2n__connection.html#a7d70bb7bed95daae1233293126bb9523">s2n_connection::config</a></div><div class="ttdeci">struct s2n_config * config</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00041">s2n_connection.h:41</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aaca63d5bb519a92734bd0287199a7f5a"><div class="ttname"><a href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a></div><div class="ttdeci">int s2n_stuffer_write_uint8(struct s2n_stuffer *stuffer, const uint8_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00249">s2n_stuffer.c:249</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a2df8cf476badc3a52f44d65caad71734"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a2df8cf476badc3a52f44d65caad71734">TLS_EXTENSION_SIGNATURE_ALGORITHMS</a></div><div class="ttdeci">#define TLS_EXTENSION_SIGNATURE_ALGORITHMS</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00056">s2n_tls_parameters.h:56</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_ad77ea23089bbeb19b897a73bf6ca3fde"><div class="ttname"><a href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde">s2n_stuffer_write</a></div><div class="ttdeci">int s2n_stuffer_write(struct s2n_stuffer *stuffer, const struct s2n_blob *in)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00219">s2n_stuffer.c:219</a></div></div>
<div class="ttc" id="structs2n__connection_html_af9b47a1de13de52e7beddb948a40fec1"><div class="ttname"><a href="structs2n__connection.html#af9b47a1de13de52e7beddb948a40fec1">s2n_connection::actual_protocol_version</a></div><div class="ttdeci">uint8_t actual_protocol_version</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00072">s2n_connection.h:72</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a0b8dde07daa13a017697a6218c34b11c"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a0b8dde07daa13a017697a6218c34b11c">TLS_EXTENSION_ELLIPTIC_CURVES</a></div><div class="ttdeci">#define TLS_EXTENSION_ELLIPTIC_CURVES</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00054">s2n_tls_parameters.h:54</a></div></div>
<div class="ttc" id="structs2n__blob_html_abe222f6d3581e7920dcad5306cc906a8"><div class="ttname"><a href="structs2n__blob.html#abe222f6d3581e7920dcad5306cc906a8">s2n_blob::data</a></div><div class="ttdeci">uint8_t * data</div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00021">s2n_blob.h:21</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a9d9c55b0847a8ae81b6379971a13f27f"><div class="ttname"><a href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a></div><div class="ttdeci">int s2n_stuffer_write_uint16(struct s2n_stuffer *stuffer, const uint16_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00268">s2n_stuffer.c:268</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_acf3d575671ffd01a1400417f16520421"><div class="ttname"><a href="s2n__tls__parameters_8h.html#acf3d575671ffd01a1400417f16520421">TLS_EXTENSION_STATUS_REQUEST</a></div><div class="ttdeci">#define TLS_EXTENSION_STATUS_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00053">s2n_tls_parameters.h:53</a></div></div>
<div class="ttc" id="s2n_8h_html_ab17e84046986d49ffd31571b8d32d24e"><div class="ttname"><a href="s2n_8h.html#ab17e84046986d49ffd31571b8d32d24e">S2N_TLS12</a></div><div class="ttdeci">#define S2N_TLS12</div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00029">s2n.h:29</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a350023b90c4e7b5de523b149308440d7"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a350023b90c4e7b5de523b149308440d7">TLS_EXTENSION_EC_POINT_FORMATS</a></div><div class="ttdeci">#define TLS_EXTENSION_EC_POINT_FORMATS</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00055">s2n_tls_parameters.h:55</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a28638d3ef91538f8a4ba9ba4c3d7cdca"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a28638d3ef91538f8a4ba9ba4c3d7cdca">TLS_SIGNATURE_ALGORITHM_RSA</a></div><div class="ttdeci">#define TLS_SIGNATURE_ALGORITHM_RSA</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00061">s2n_tls_parameters.h:61</a></div></div>
<div class="ttc" id="structs2n__connection_html_aaeec7205ccf6834a5eaf18d9a5eb8936"><div class="ttname"><a href="structs2n__connection.html#aaeec7205ccf6834a5eaf18d9a5eb8936">s2n_connection::server_name</a></div><div class="ttdeci">char server_name[256]</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00146">s2n_connection.h:146</a></div></div>
<div class="ttc" id="s2n__ecc_8c_html_a27f438af5123167d9e831390707be2a0"><div class="ttname"><a href="s2n__ecc_8c.html#a27f438af5123167d9e831390707be2a0">s2n_ecc_supported_curves</a></div><div class="ttdeci">const struct s2n_ecc_named_curve s2n_ecc_supported_curves[2]</div><div class="ttdef"><b>Definition:</b> <a href="s2n__ecc_8c_source.html#l00030">s2n_ecc.c:30</a></div></div>
<div class="ttc" id="s2n_8h_html_a7d38e45340d223d0100a2d4bc0526635aea0f05b257857adc1282f77c5414e35a"><div class="ttname"><a href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635aea0f05b257857adc1282f77c5414e35a">S2N_STATUS_REQUEST_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00067">s2n.h:67</a></div></div>
<div class="ttc" id="structs2n__config_html_aa6c7e4f4cf13d4d133b66760cf0d09fa"><div class="ttname"><a href="structs2n__config.html#aa6c7e4f4cf13d4d133b66760cf0d09fa">s2n_config::status_request_type</a></div><div class="ttdeci">s2n_status_request_type status_request_type</div><div class="ttdef"><b>Definition:</b> <a href="s2n__config_8h_source.html#l00044">s2n_config.h:44</a></div></div>
<div class="ttc" id="s2n_8h_html_a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8"><div class="ttname"><a href="s2n_8h.html#a7d38e45340d223d0100a2d4bc0526635a3e83f0e90eef54adc21b3d97a9a0d9b8">S2N_STATUS_REQUEST_OCSP</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n_8h_source.html#l00067">s2n.h:67</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a286ad9b0d46f4af176671cda1ed6f58a"><div class="ttname"><a href="s2n__safety_8h.html#a286ad9b0d46f4af176671cda1ed6f58a">eq_check</a></div><div class="ttdeci">#define eq_check(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00037">s2n_safety.h:37</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8_cgraph.png" border="0" usemap="#s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8_cgraph" id="s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f" title="s2n_stuffer_write_uint16" alt="" coords="242,5,409,31"/>
<area shape="rect" id="node9" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="246,55,405,80"/>
<area shape="rect" id="node10" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="264,104,387,129"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="457,55,618,80"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="666,55,820,80"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="868,55,998,80"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1046,29,1183,55"/>
<area shape="rect" id="node7" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1070,79,1159,104"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1231,79,1304,104"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8_icgraph.png" border="0" usemap="#s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8_icgraph" alt=""/></div>
<map name="s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8_icgraph" id="s2n__tls_8h_a5693cff7b0838d6d62b5b9e70a1e17f8_icgraph">
<area shape="rect" id="node2" href="s2n__tls_8h.html#a4b86117a2a4f018991a01ff788272441" title="s2n_client_hello_send" alt="" coords="242,5,395,31"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a53cfe69398f5503ced5ba7745c562e63"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_client_extensions_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs2n__blob.html">s2n_blob</a> *&#160;</td>
          <td class="paramname"><em>extensions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__client__extensions_8c_source.html#l00137">137</a> of file <a class="el" href="s2n__client__extensions_8c_source.html">s2n_client_extensions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;{</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__stuffer.html">s2n_stuffer</a> in;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee">s2n_stuffer_init</a>(&amp;in, extensions));</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde">s2n_stuffer_write</a>(&amp;in, extensions));</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;in)) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> <a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        uint16_t extension_type, extension_size;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keyword">struct </span><a class="code" href="structs2n__stuffer.html">s2n_stuffer</a> extension;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a>(&amp;in, &amp;extension_type));</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a>(&amp;in, &amp;extension_size));</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>.size = extension_size;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad35087e5d980b38035ca99fc5090775e">lte_check</a>(extension_size, <a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;in));</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>.data = <a class="code" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a>(&amp;in, <a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>.size);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(<a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>.data);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee">s2n_stuffer_init</a>(&amp;extension, &amp;<a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>));</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde">s2n_stuffer_write</a>(&amp;extension, &amp;<a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>));</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">switch</span> (extension_type) {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="s2n__tls__parameters_8h.html#ac5af336fe762b24789dde11d13a74035">TLS_EXTENSION_SERVER_NAME</a>:</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_recv_client_server_name(conn, &amp;extension));</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="s2n__tls__parameters_8h.html#a2df8cf476badc3a52f44d65caad71734">TLS_EXTENSION_SIGNATURE_ALGORITHMS</a>:</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_recv_client_signature_algorithms(conn, &amp;extension));</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="s2n__tls__parameters_8h.html#a753973f1e9b19bde89de02430b355128">TLS_EXTENSION_ALPN</a>:</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_recv_client_alpn(conn, &amp;extension));</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="s2n__tls__parameters_8h.html#acf3d575671ffd01a1400417f16520421">TLS_EXTENSION_STATUS_REQUEST</a>:</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_recv_client_status_request(conn, &amp;extension));</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="s2n__tls__parameters_8h.html#a0b8dde07daa13a017697a6218c34b11c">TLS_EXTENSION_ELLIPTIC_CURVES</a>:</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_recv_client_elliptic_curves(conn, &amp;extension));</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="s2n__tls__parameters_8h.html#a350023b90c4e7b5de523b149308440d7">TLS_EXTENSION_EC_POINT_FORMATS</a>:</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_recv_client_ec_point_formats(conn, &amp;extension));</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="s2n__tls__parameters_8h.html#a588964defd85ac156ea0941a1cc74279">TLS_EXTENSION_RENEGOTIATION_INFO</a>:</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_recv_client_renegotiation_info(conn, &amp;extension));</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div><div class="ttc" id="s2n__stuffer_8h_html_a56d3da0e05e4c05eb87a343306c4f170"><div class="ttname"><a href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a></div><div class="ttdeci">#define s2n_stuffer_data_available(s)  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00045">s2n_stuffer.h:45</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a753973f1e9b19bde89de02430b355128"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a753973f1e9b19bde89de02430b355128">TLS_EXTENSION_ALPN</a></div><div class="ttdeci">#define TLS_EXTENSION_ALPN</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00057">s2n_tls_parameters.h:57</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a788c22abe22da96107393257193632c5"><div class="ttname"><a href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a></div><div class="ttdeci">int s2n_stuffer_read_uint16(struct s2n_stuffer *stuffer, uint16_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00256">s2n_stuffer.c:256</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a588964defd85ac156ea0941a1cc74279"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a588964defd85ac156ea0941a1cc74279">TLS_EXTENSION_RENEGOTIATION_INFO</a></div><div class="ttdeci">#define TLS_EXTENSION_RENEGOTIATION_INFO</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00058">s2n_tls_parameters.h:58</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_ac5af336fe762b24789dde11d13a74035"><div class="ttname"><a href="s2n__tls__parameters_8h.html#ac5af336fe762b24789dde11d13a74035">TLS_EXTENSION_SERVER_NAME</a></div><div class="ttdeci">#define TLS_EXTENSION_SERVER_NAME</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00052">s2n_tls_parameters.h:52</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a5148294f6ed0bf894afc83a31ee4f8a5"><div class="ttname"><a href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a></div><div class="ttdeci">void * s2n_stuffer_raw_read(struct s2n_stuffer *stuffer, uint32_t data_len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00149">s2n_stuffer.c:149</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a2df8cf476badc3a52f44d65caad71734"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a2df8cf476badc3a52f44d65caad71734">TLS_EXTENSION_SIGNATURE_ALGORITHMS</a></div><div class="ttdeci">#define TLS_EXTENSION_SIGNATURE_ALGORITHMS</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00056">s2n_tls_parameters.h:56</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad35087e5d980b38035ca99fc5090775e"><div class="ttname"><a href="s2n__safety_8h.html#ad35087e5d980b38035ca99fc5090775e">lte_check</a></div><div class="ttdeci">#define lte_check(n, max)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00034">s2n_safety.h:34</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_ad77ea23089bbeb19b897a73bf6ca3fde"><div class="ttname"><a href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde">s2n_stuffer_write</a></div><div class="ttdeci">int s2n_stuffer_write(struct s2n_stuffer *stuffer, const struct s2n_blob *in)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00219">s2n_stuffer.c:219</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a0b8dde07daa13a017697a6218c34b11c"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a0b8dde07daa13a017697a6218c34b11c">TLS_EXTENSION_ELLIPTIC_CURVES</a></div><div class="ttdeci">#define TLS_EXTENSION_ELLIPTIC_CURVES</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00054">s2n_tls_parameters.h:54</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a372ad5deb70573456ecde442c0c466be"><div class="ttname"><a href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a></div><div class="ttdeci">#define notnull_check(ptr)                  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00025">s2n_safety.h:25</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_acf3d575671ffd01a1400417f16520421"><div class="ttname"><a href="s2n__tls__parameters_8h.html#acf3d575671ffd01a1400417f16520421">TLS_EXTENSION_STATUS_REQUEST</a></div><div class="ttdeci">#define TLS_EXTENSION_STATUS_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00053">s2n_tls_parameters.h:53</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a350023b90c4e7b5de523b149308440d7"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a350023b90c4e7b5de523b149308440d7">TLS_EXTENSION_EC_POINT_FORMATS</a></div><div class="ttdeci">#define TLS_EXTENSION_EC_POINT_FORMATS</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00055">s2n_tls_parameters.h:55</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_af556836db8ed75fdb89af3d418fab2ee"><div class="ttname"><a href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee">s2n_stuffer_init</a></div><div class="ttdeci">int s2n_stuffer_init(struct s2n_stuffer *stuffer, struct s2n_blob *in)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00029">s2n_stuffer.c:29</a></div></div>
<div class="ttc" id="crypto_2x509v3_2x509v3_8h_html_aeaf958163deb17ab0df0d1ce32ad3713"><div class="ttname"><a href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a></div><div class="ttdeci">void * ext</div><div class="ttdef"><b>Definition:</b> <a href="crypto_2x509v3_2x509v3_8h_source.html#l00088">x509v3.h:88</a></div></div>
<div class="ttc" id="structs2n__stuffer_html"><div class="ttname"><a href="structs2n__stuffer.html">s2n_stuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00023">s2n_stuffer.h:23</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63_cgraph.png" border="0" usemap="#s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63_cgraph" id="s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="480,5,591,31"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="474,84,597,109"/>
<area shape="rect" id="node10" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5" title="s2n_stuffer_read_uint16" alt="" coords="453,207,618,232"/>
<area shape="rect" id="node11" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="667,283,827,308"/>
<area shape="rect" id="node12" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="877,359,1029,384"/>
<area shape="rect" id="node13" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="672,359,822,384"/>
<area shape="rect" id="node14" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="243,257,401,283"/>
<area shape="rect" id="node15" href="s2n__stuffer_8c.html#a5d6db4ed8311ba66aec1227fceca24a9" title="s2n_stuffer_reread" alt="" coords="469,137,602,163"/>
<area shape="rect" id="node16" href="s2n__ecc_8c.html#abb776b3598360bc599df037aec01faa0" title="s2n_ecc_find_supported\l_curve" alt="" coords="238,92,405,131"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="666,84,828,109"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="876,84,1030,109"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="1078,84,1208,109"/>
<area shape="rect" id="node7" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1256,59,1392,84"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1279,108,1369,133"/>
<area shape="rect" id="node9" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1440,108,1514,133"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63_icgraph.png" border="0" usemap="#s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63_icgraph" alt=""/></div>
<map name="s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63_icgraph" id="s2n__tls_8h_a53cfe69398f5503ced5ba7745c562e63_icgraph">
<area shape="rect" id="node2" href="s2n__tls_8h.html#abfb7d01ea645110aea3c808de4d86f1d" title="s2n_client_hello_recv" alt="" coords="238,5,388,31"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a72b3e9fb3b4cb76a22e8d236609029ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_extensions_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs2n__stuffer.html">s2n_stuffer</a> *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__extensions_8c_source.html#l00033">33</a> of file <a class="el" href="s2n__server__extensions_8c_source.html">s2n_server_extensions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    uint16_t total_size = 0;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    uint8_t application_protocol_len = strlen(conn-&gt;<a class="code" href="structs2n__connection.html#a826afa0c257cdb351d45ca87c734ec3c">application_protocol</a>);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">if</span> (application_protocol_len) {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        total_size += 7 + application_protocol_len;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    }</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="s2n__tls_8h.html#a20bacac680b48d51f2623a1d95e85ca8">s2n_server_can_send_ocsp</a>(conn)) {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        total_size += 4;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#a579beb899db6aa0c25366672938b2216">secure_renegotiation</a>) {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        total_size += 5;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span> (total_size == 0) {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, total_size));</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">/* Write the renegotiation_info extension */</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (conn-&gt;<a class="code" href="structs2n__connection.html#a579beb899db6aa0c25366672938b2216">secure_renegotiation</a>) {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, <a class="code" href="s2n__tls__parameters_8h.html#a588964defd85ac156ea0941a1cc74279">TLS_EXTENSION_RENEGOTIATION_INFO</a>));</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="comment">/* renegotiation_info length */</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, 1));</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="comment">/* renegotiated_connection length */</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, 0));</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">/* Write ALPN extension */</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span> (application_protocol_len) {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, <a class="code" href="s2n__tls__parameters_8h.html#a753973f1e9b19bde89de02430b355128">TLS_EXTENSION_ALPN</a>));</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, application_protocol_len + 3));</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, application_protocol_len + 1));</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a>(out, application_protocol_len));</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a>(out, (uint8_t *) conn-&gt;<a class="code" href="structs2n__connection.html#a826afa0c257cdb351d45ca87c734ec3c">application_protocol</a>, application_protocol_len));</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">/* Write OCSP extension */</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="s2n__tls_8h.html#a20bacac680b48d51f2623a1d95e85ca8">s2n_server_can_send_ocsp</a>(conn)) {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, <a class="code" href="s2n__tls__parameters_8h.html#acf3d575671ffd01a1400417f16520421">TLS_EXTENSION_STATUS_REQUEST</a>));</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a>(out, 0));</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    }</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div><div class="ttc" id="s2n__tls__parameters_8h_html_a753973f1e9b19bde89de02430b355128"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a753973f1e9b19bde89de02430b355128">TLS_EXTENSION_ALPN</a></div><div class="ttdeci">#define TLS_EXTENSION_ALPN</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00057">s2n_tls_parameters.h:57</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a588964defd85ac156ea0941a1cc74279"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a588964defd85ac156ea0941a1cc74279">TLS_EXTENSION_RENEGOTIATION_INFO</a></div><div class="ttdeci">#define TLS_EXTENSION_RENEGOTIATION_INFO</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00058">s2n_tls_parameters.h:58</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_aaca63d5bb519a92734bd0287199a7f5a"><div class="ttname"><a href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a">s2n_stuffer_write_uint8</a></div><div class="ttdeci">int s2n_stuffer_write_uint8(struct s2n_stuffer *stuffer, const uint8_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00249">s2n_stuffer.c:249</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a9d9c55b0847a8ae81b6379971a13f27f"><div class="ttname"><a href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f">s2n_stuffer_write_uint16</a></div><div class="ttdeci">int s2n_stuffer_write_uint16(struct s2n_stuffer *stuffer, const uint16_t u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00268">s2n_stuffer.c:268</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_acf3d575671ffd01a1400417f16520421"><div class="ttname"><a href="s2n__tls__parameters_8h.html#acf3d575671ffd01a1400417f16520421">TLS_EXTENSION_STATUS_REQUEST</a></div><div class="ttdeci">#define TLS_EXTENSION_STATUS_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00053">s2n_tls_parameters.h:53</a></div></div>
<div class="ttc" id="structs2n__connection_html_a579beb899db6aa0c25366672938b2216"><div class="ttname"><a href="structs2n__connection.html#a579beb899db6aa0c25366672938b2216">s2n_connection::secure_renegotiation</a></div><div class="ttdeci">unsigned int secure_renegotiation</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00154">s2n_connection.h:154</a></div></div>
<div class="ttc" id="structs2n__connection_html_a826afa0c257cdb351d45ca87c734ec3c"><div class="ttname"><a href="structs2n__connection.html#a826afa0c257cdb351d45ca87c734ec3c">s2n_connection::application_protocol</a></div><div class="ttdeci">char application_protocol[256]</div><div class="ttdef"><b>Definition:</b> <a href="s2n__connection_8h_source.html#l00147">s2n_connection.h:147</a></div></div>
<div class="ttc" id="s2n__tls_8h_html_a20bacac680b48d51f2623a1d95e85ca8"><div class="ttname"><a href="s2n__tls_8h.html#a20bacac680b48d51f2623a1d95e85ca8">s2n_server_can_send_ocsp</a></div><div class="ttdeci">#define s2n_server_can_send_ocsp(conn)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls_8h_source.html#l00058">s2n_tls.h:58</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_afe5e2db5400000f371d2245e1e0669eb"><div class="ttname"><a href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb">s2n_stuffer_write_bytes</a></div><div class="ttdeci">int s2n_stuffer_write_bytes(struct s2n_stuffer *stuffer, const uint8_t *data, const uint32_t size)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00224">s2n_stuffer.c:224</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab_cgraph.png" border="0" usemap="#s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab_cgraph" alt=""/></div>
<map name="s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab_cgraph" id="s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#a9d9c55b0847a8ae81b6379971a13f27f" title="s2n_stuffer_write_uint16" alt="" coords="248,5,414,31"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="462,56,624,81"/>
<area shape="rect" id="node9" href="s2n__stuffer_8c.html#aaca63d5bb519a92734bd0287199a7f5a" title="s2n_stuffer_write_uint8" alt="" coords="252,107,411,132"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="672,56,826,81"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="874,56,1004,81"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1052,31,1189,56"/>
<area shape="rect" id="node7" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1076,80,1165,105"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1237,80,1310,105"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab_icgraph.png" border="0" usemap="#s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab_icgraph" alt=""/></div>
<map name="s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab_icgraph" id="s2n__tls_8h_a72b3e9fb3b4cb76a22e8d236609029ab_icgraph">
<area shape="rect" id="node2" href="s2n__tls_8h.html#a8e32b708f98ecbfa1148c5393f8b9dba" title="s2n_server_hello_send" alt="" coords="248,5,407,31"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa5973260f0a72187b1331e5633795fe9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int s2n_server_extensions_recv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structs2n__connection.html">s2n_connection</a> *&#160;</td>
          <td class="paramname"><em>conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structs2n__blob.html">s2n_blob</a> *&#160;</td>
          <td class="paramname"><em>extensions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__server__extensions_8c_source.html#l00082">82</a> of file <a class="el" href="s2n__server__extensions_8c_source.html">s2n_server_extensions.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">struct </span><a class="code" href="structs2n__stuffer.html">s2n_stuffer</a> in;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee">s2n_stuffer_init</a>(&amp;in, extensions));</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde">s2n_stuffer_write</a>(&amp;in, extensions));</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a>(&amp;in)) {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keyword">struct </span><a class="code" href="structs2n__blob.html">s2n_blob</a> <a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        uint16_t extension_type, extension_size;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keyword">struct </span><a class="code" href="structs2n__stuffer.html">s2n_stuffer</a> extension;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a>(&amp;in, &amp;extension_type));</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a>(&amp;in, &amp;extension_size));</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>.size = extension_size;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>.data = <a class="code" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a>(&amp;in, <a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>.size);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a>(<a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>.data);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee">s2n_stuffer_init</a>(&amp;extension, &amp;<a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>));</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(<a class="code" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde">s2n_stuffer_write</a>(&amp;extension, &amp;<a class="code" href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a>));</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">switch</span> (extension_type) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="s2n__tls__parameters_8h.html#a753973f1e9b19bde89de02430b355128">TLS_EXTENSION_ALPN</a>:</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_recv_server_alpn(conn, &amp;extension));</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="s2n__tls__parameters_8h.html#acf3d575671ffd01a1400417f16520421">TLS_EXTENSION_STATUS_REQUEST</a>:</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <a class="code" href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a>(s2n_recv_server_status_request(conn, &amp;extension));</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    }</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="ttc" id="s2n__stuffer_8h_html_a56d3da0e05e4c05eb87a343306c4f170"><div class="ttname"><a href="s2n__stuffer_8h.html#a56d3da0e05e4c05eb87a343306c4f170">s2n_stuffer_data_available</a></div><div class="ttdeci">#define s2n_stuffer_data_available(s)  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00045">s2n_stuffer.h:45</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_a753973f1e9b19bde89de02430b355128"><div class="ttname"><a href="s2n__tls__parameters_8h.html#a753973f1e9b19bde89de02430b355128">TLS_EXTENSION_ALPN</a></div><div class="ttdeci">#define TLS_EXTENSION_ALPN</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00057">s2n_tls_parameters.h:57</a></div></div>
<div class="ttc" id="structs2n__blob_html"><div class="ttname"><a href="structs2n__blob.html">s2n_blob</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__blob_8h_source.html#l00020">s2n_blob.h:20</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a788c22abe22da96107393257193632c5"><div class="ttname"><a href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5">s2n_stuffer_read_uint16</a></div><div class="ttdeci">int s2n_stuffer_read_uint16(struct s2n_stuffer *stuffer, uint16_t *u)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00256">s2n_stuffer.c:256</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_ad400572229cc8e40f7996837deb680f3"><div class="ttname"><a href="s2n__safety_8h.html#ad400572229cc8e40f7996837deb680f3">GUARD</a></div><div class="ttdeci">#define GUARD(x)        </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00042">s2n_safety.h:42</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_a5148294f6ed0bf894afc83a31ee4f8a5"><div class="ttname"><a href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5">s2n_stuffer_raw_read</a></div><div class="ttdeci">void * s2n_stuffer_raw_read(struct s2n_stuffer *stuffer, uint32_t data_len)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00149">s2n_stuffer.c:149</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_ad77ea23089bbeb19b897a73bf6ca3fde"><div class="ttname"><a href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde">s2n_stuffer_write</a></div><div class="ttdeci">int s2n_stuffer_write(struct s2n_stuffer *stuffer, const struct s2n_blob *in)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00219">s2n_stuffer.c:219</a></div></div>
<div class="ttc" id="s2n__safety_8h_html_a372ad5deb70573456ecde442c0c466be"><div class="ttname"><a href="s2n__safety_8h.html#a372ad5deb70573456ecde442c0c466be">notnull_check</a></div><div class="ttdeci">#define notnull_check(ptr)                  </div><div class="ttdef"><b>Definition:</b> <a href="s2n__safety_8h_source.html#l00025">s2n_safety.h:25</a></div></div>
<div class="ttc" id="s2n__tls__parameters_8h_html_acf3d575671ffd01a1400417f16520421"><div class="ttname"><a href="s2n__tls__parameters_8h.html#acf3d575671ffd01a1400417f16520421">TLS_EXTENSION_STATUS_REQUEST</a></div><div class="ttdeci">#define TLS_EXTENSION_STATUS_REQUEST</div><div class="ttdef"><b>Definition:</b> <a href="s2n__tls__parameters_8h_source.html#l00053">s2n_tls_parameters.h:53</a></div></div>
<div class="ttc" id="s2n__stuffer_8c_html_af556836db8ed75fdb89af3d418fab2ee"><div class="ttname"><a href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee">s2n_stuffer_init</a></div><div class="ttdeci">int s2n_stuffer_init(struct s2n_stuffer *stuffer, struct s2n_blob *in)</div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8c_source.html#l00029">s2n_stuffer.c:29</a></div></div>
<div class="ttc" id="crypto_2x509v3_2x509v3_8h_html_aeaf958163deb17ab0df0d1ce32ad3713"><div class="ttname"><a href="crypto_2x509v3_2x509v3_8h.html#aeaf958163deb17ab0df0d1ce32ad3713">ext</a></div><div class="ttdeci">void * ext</div><div class="ttdef"><b>Definition:</b> <a href="crypto_2x509v3_2x509v3_8h_source.html#l00088">x509v3.h:88</a></div></div>
<div class="ttc" id="structs2n__stuffer_html"><div class="ttname"><a href="structs2n__stuffer.html">s2n_stuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="s2n__stuffer_8h_source.html#l00023">s2n_stuffer.h:23</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9_cgraph.png" border="0" usemap="#s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9_cgraph" alt=""/></div>
<map name="s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9_cgraph" id="s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9_cgraph">
<area shape="rect" id="node2" href="s2n__stuffer_8c.html#af556836db8ed75fdb89af3d418fab2ee" title="s2n_stuffer_init" alt="" coords="271,5,383,31"/>
<area shape="rect" id="node3" href="s2n__stuffer_8c.html#ad77ea23089bbeb19b897a73bf6ca3fde" title="s2n_stuffer_write" alt="" coords="266,55,388,80"/>
<area shape="rect" id="node10" href="s2n__stuffer_8c.html#a788c22abe22da96107393257193632c5" title="s2n_stuffer_read_uint16" alt="" coords="244,104,409,129"/>
<area shape="rect" id="node13" href="s2n__stuffer_8c.html#a5148294f6ed0bf894afc83a31ee4f8a5" title="s2n_stuffer_raw_read" alt="" coords="463,203,613,228"/>
<area shape="rect" id="node14" href="s2n__stuffer_8c.html#a1178687b6091eb483d135c149e87fb0b" title="s2n_stuffer_read_uint8" alt="" coords="248,153,406,179"/>
<area shape="rect" id="node4" href="s2n__stuffer_8c.html#afe5e2db5400000f371d2245e1e0669eb" title="s2n_stuffer_write_bytes" alt="" coords="457,55,619,80"/>
<area shape="rect" id="node5" href="s2n__stuffer_8c.html#a7ef8f252a4b5b3d0bb793e1906d1b876" title="s2n_stuffer_skip_write" alt="" coords="667,55,821,80"/>
<area shape="rect" id="node6" href="s2n__stuffer_8c.html#af41b58c58039466284fb917802c9452b" title="s2n_stuffer_resize" alt="" coords="869,55,999,80"/>
<area shape="rect" id="node7" href="s2n__stuffer_8c.html#a15cd08990395a34e8f22775c2db3455b" title="s2n_stuffer_wipe_n" alt="" coords="1047,29,1184,55"/>
<area shape="rect" id="node8" href="s2n__mem_8c.html#a68cfc787c141730f4f602d509dd58a39" title="s2n_realloc" alt="" coords="1071,79,1160,104"/>
<area shape="rect" id="node9" href="s2n__mem_8c.html#a1474cb5dc54584b8e108acf1070bc994" title="s2n_free" alt="" coords="1232,79,1305,104"/>
<area shape="rect" id="node11" href="s2n__stuffer_8c.html#ab84cff8edd5b5f264afe261f093f894b" title="s2n_stuffer_read_bytes" alt="" coords="458,153,618,179"/>
<area shape="rect" id="node12" href="s2n__stuffer_8c.html#a0d643b31c896c7f6f2c058977cf46c3b" title="s2n_stuffer_skip_read" alt="" coords="668,177,820,203"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9_icgraph.png" border="0" usemap="#s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9_icgraph" alt=""/></div>
<map name="s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9_icgraph" id="s2n__tls_8h_aa5973260f0a72187b1331e5633795fe9_icgraph">
<area shape="rect" id="node2" href="s2n__tls_8h.html#a2139f810755eb8cf27ebea179e81ac81" title="s2n_server_hello_recv" alt="" coords="244,5,400,31"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a0cb08e556504a133390d419bf05db470"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t s2n_highest_protocol_version</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="s2n__tls_8c_source.html#l00021">21</a> of file <a class="el" href="s2n__tls_8c_source.html">s2n_tls.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_793a76e172ee3b858dde09e04b4cbf90.html">s2n-master</a></li><li class="navelem"><a class="el" href="dir_2043b17d4c935d2e9ed3eaa50c90f2a4.html">tls</a></li><li class="navelem"><a class="el" href="s2n__tls_8h.html">s2n_tls.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
